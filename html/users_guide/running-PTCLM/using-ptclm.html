

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.7.3. Using PTCLMmkdata &mdash; ctsm CTSM master documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="ctsm CTSM master documentation" href="../../index.html"/>
        <link rel="up" title="1.7. Running PTCLM" href="index.html"/>
        <link rel="next" title="1.7.4. Examples of using PTCLMmkdata" href="ptclm-examples.html"/>
        <link rel="prev" title="1.7.1. What is PTCLMmkdata?" href="introduction-to-ptclm.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> ctsm
          

          
          </a>

          
            
            
              <div class="version">
                
                  <div class="version-dropdown">
                    <select class="version-list" id="version-list">
                      <option value=''>CTSM1</option>
                      
                        
                      
                        
                          <option value="">[placeholder]</option>
                        
                      
                    </select>
                  </div>
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">1. CTSM1 User’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview/index.html">1.1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setting-up-and-running-a-case/index.html">1.2. Setting Up and Running a Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using-clm-tools/index.html">1.3. Using CLM tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adding-new-resolutions/index.html">1.4. Adding New Resolutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../running-special-cases/index.html">1.5. Running Special Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../running-single-points/index.html">1.6. Running Single Point Regional Cases</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">1.7. Running PTCLM</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction-to-ptclm.html">1.7.1. What is PTCLMmkdata?</a></li>
<li class="toctree-l3"><a class="reference internal" href="introduction-to-ptclm.html#details-of-ptclmmkdata">1.7.2. Details of PTCLMmkdata</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">1.7.3. Using PTCLMmkdata</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#steps-in-running-ptclmmkdata">1.7.3.1. Steps in running PTCLMmkdata</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ptclmmkdata-options">1.7.3.2. PTCLMmkdata options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ptclm-examples.html">1.7.4. Examples of using PTCLMmkdata</a></li>
<li class="toctree-l3"><a class="reference internal" href="adding-ptclm-site-data.html">1.7.5. Adding PTCLMmkdata Site Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../trouble-shooting/index.html">1.8. Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/index.html">1.9. Testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tech_note/index.html">2. CLM Technical Note</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lilac/index.html">3. CTSM-LILAC User’s Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ctsm</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html"><span class="section-number">1. </span>CTSM1 User’s Guide</a> &raquo;</li>
        
          <li><a href="index.html"><span class="section-number">1.7. </span>Running PTCLM</a> &raquo;</li>
        
      <li><span class="section-number">1.7.3. </span>Using PTCLMmkdata</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/users_guide/running-PTCLM/using-ptclm.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-ptclmmkdata">
<span id="using-ptclm-rst"></span><h1><span class="section-number">1.7.3. </span>Using PTCLMmkdata<a class="headerlink" href="#using-ptclmmkdata" title="Permalink to this headline">¶</a></h1>
<p>There are two types of options to PTCLMmkdata: required and optional.
The three required options are the three settings that MUST be specified for PTCLMmkdata to work at all. The other settings have default values that will default to something useful. Most options use a double dash “–” “longname” such as “–list”, but the most common options also have a short-name with a single dash.</p>
<p>The required options to PTCLMmkdata are: inputdata directory (-d) and site-name (-s).
Inputdata directory is the directory where you have the CESM inputdata files. Finally site-name is the name of the site that you want to run for. Site-name is a Fluxnet site name from the list of sites you are running on (see the –sitegroupname for more information about the site lists).</p>
<p>After PTCLMmkdata is run you can run <strong>create_newcase</strong> to setup a case to use the datasets created.
It also creates a <code class="docutils literal notranslate"><span class="pre">README.PTCLM</span></code> in that directory that documents the commandline options to PTCLMmkdata that were used to create it.</p>
<p>After “help” the “list” option is one of the most useful options for getting help on using PTCLMmkdata.
This option gives you information about some of the other options to PTCLMmkdata. To get a list of the sites that can be used for PTCLMmkdata use the “–list” option as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; cd $CTSMROOT/tools/PTCLM
&gt; ./PTCLMmkdata --list
</pre></div>
</div>
<p>The output to the above command is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span><span class="p">:</span> <span class="n">line</span> <span class="mi">1</span><span class="p">:</span> <span class="n">PTCLMmkdata</span><span class="p">:</span> <span class="n">command</span> <span class="ow">not</span> <span class="n">found</span>
</pre></div>
</div>
<div class="section" id="steps-in-running-ptclmmkdata">
<h2><span class="section-number">1.7.3.1. </span>Steps in running PTCLMmkdata<a class="headerlink" href="#steps-in-running-ptclmmkdata" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Build the CLM tools
Next you need to make sure all the CLM FORTRAN tools are built.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; cd $CTSMROOT/tools/PTCLM
&gt; ./buildtools
&gt; gmake clean
</pre></div>
</div>
</li>
<li><p>Run PTCLMmkdata
Next you actually run PTCLMmkdata which does the different things listed below:</p>
<ol class="loweralpha">
<li><p>PTCLMmkdata names your output file directory based on your input</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Prefix_</span><span class="p">]</span><span class="n">SiteCode</span>
</pre></div>
</div>
<dl>
<dt>Where:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Prefix</span></code> is from the caseidprefix option (or blank if not used).</p>
<p><code class="docutils literal notranslate"><span class="pre">SiteCode</span></code> is the site name you entered with the -s option.</p>
</dd>
</dl>
<p>For example, the casename for the following will be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; cd scripts
&gt; ./PTCLMmkdata -s US-UMB -d $MYCSMDATA
</pre></div>
</div>
</li>
<li><p>PTCLMmkdata creates datasets for you
It will populate $MYCSMDATA with new datasets it creates using the CLM tools.</p></li>
<li><p>If a transient compset and PTCLMmkdata finds a _dynpftdata.txt file
If you are running a transient compset (such as the “I_1850-2000_CN” compset) AND you there is a file in the PTCLM_sitedata directory under the PTCLMmkdata directory called $SITE_dynpftdata.txt it will use this file for the land-use changes.
Otherwise it will leave land-use constant, unless you use the pftgrid option so it uses the global dataset for landuse changes.
See the Section called Dynamic Land-Use Change Files for use by PTCLMmkdata for more information on this.
There is a sample transient dataset called US-Ha1_dynpftdata.txt.
Transient compsets, are compsets that create transient land-use change and forcing conditions such as: ‘I_1850-2000’, ‘I_1850-2000_CN’, ‘I_RCP8.5_CN’, ‘I_RCP6.0_CN’, ‘I_RCP4.5_CN’, or ‘I_RCP2.6_CN’.</p></li>
<li><p>PTCLMmkdata creates a pft-physiology for you
PTCLMmkdata will create a local copy of the pft-physiology specific for your site that you could then customize with changes specific for that site.</p></li>
<li><p>PTCLMmkdata creates a README.PTCLM for you
PTCLMmkdata will create a simple text file with the command line for it in a file called README.PTCLM in the case directory it creates for you.</p></li>
</ol>
</li>
<li><p>Run create_newcase pointing to the directory created</p></li>
<li><p>Customize, setup, build and run case as normal
You then customize your case as you would normally. See the Chapter 1 chapter for more information on doing this.</p></li>
</ol>
</div>
<div class="section" id="ptclmmkdata-options">
<h2><span class="section-number">1.7.3.2. </span>PTCLMmkdata options<a class="headerlink" href="#ptclmmkdata-options" title="Permalink to this headline">¶</a></h2>
<p>Next we discuss the setup and run-time options, dividing them up into setup, initial condition (IC), and run-time options.</p>
<p>Configure options include:</p>
<ul class="simple">
<li><p>–cesm_root=BASE_CESM</p></li>
<li><p>–sitegroupname=SITEGROUP</p></li>
<li><p>–donot_use_tower_yrs</p></li>
</ul>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">--cesm_root</span></code></dt><dd><p>This option is for running PTCLMmkdata with a different root directory to CESM than the version PTCLMmkdata exists in. Normally you do NOT need to use this option.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--sitegroupname</span></code></dt><dd><p>In the PTCLMmkdata directory there is a subdirectory “PTCLM_sitedata” that contains files with the site, PFT and soil data information for groups of sites.
These site groups are all separate ASCII files with the same prefix followed by a “_*data.txt” name. See <a class="reference external" href="CLM-URL">the Section called PTCLMmkdata Group Site Lists</a> for more information on these files. By default we have provided three different valid group names:</p>
</dd>
</dl>
<div class="section" id="example">
<h3><span class="section-number">1.7.3.2.1. </span>EXAMPLE<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>AmeriFlux</p>
<p>Fluxnet-Canada</p>
<p>The EXAMPLE is the group used by default and ONLY includes the US-UMB site as that is the only site we have data provided for.
The other two site groups include the site information for all of both the AmeriFlux and Fluxnet-Canada sites.
You can use the “sitegroupname” option to use one of the other lists, or you can create your own lists using the EXAMPLE file as an example.
Your list of sites could be real world locations or could be theoretical “virtual” sites given to exercise CLM on differing biomes for example.
Note, see <a class="reference external" href="CLM-URL">the Section called Converting AmeriFlux Data for use by PTCLMmkdata</a> with permission information to use the US-UMB data.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">--donot_use_tower_yrs</span></code></dt><dd><p>This option is used with the “useQIAN” option to set the years to cycle over for the Qian data. In this case Qian atmospheric forcing will be used, but the simulation will run over the same years that tower site is available for this site.</p>
</dd>
</dl>
<p><strong>Run-time options include:</strong></p>
<ul class="simple">
<li><p>–debug</p></li>
</ul>
<p>This option tells PTCLMmkdata to echo what it would do if it were run, but NOT actually run anything. So it will show you the dataset creation commands it would use. It does however, run <strong>create_newcase</strong>, but then it only displays the <strong>xmlchange</strong> commands and changes that it would do. Also note that if you give the “–rmold” option it won’t delete the case directory beforehand. Primarily this is intended for debugging the operation of PTCLMmkdata.</p>
<p><strong>The dataset generation options are:</strong></p>
<ul class="simple">
<li><p>–pftgrid</p></li>
<li><p>–soilgrid</p></li>
</ul>
<p>The options that with a “grid” suffix all mean to create datasets using the global gridded information rather than using the site specific point data. By default the site specific point data is used. The “nopointdata” and “owritesrfaer” options have to do with file creation.</p>
<p>Because supported single-point datasets already have the data created for them, you MUST use the “nopointdata” and “ndepgrid” options when you are using a supported single-point site. You must use “ndepgrid” even for a compset without CN. You also can NOT use the options: “soilgrid”, “pftgrid”, “aerdepgrid”, or “owritesrfaer”.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">--pftgrid</span></code></dt><dd><p>This option says to use the PFT values provided on the global dataset rather than using the specific site based values from the PTCLM_sitedata/*_pftdata.txt file when creating the surface dataset.
This option must NOT be used when you you are using a site that is a supported single point dataset.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--soilgrid</span></code></dt><dd><p>This option says to use the soil values provided on the global dataset rather than using the specific site based values from the PTCLM_sitedata/*_soildata.txt file when creating the surface dataset.
This option must NOT be used when you you are using a site that is a supported single point dataset.</p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ptclm-examples.html" class="btn btn-neutral float-right" title="1.7.4. Examples of using PTCLMmkdata" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="introduction-to-ptclm.html" class="btn btn-neutral" title="1.7.1. What is PTCLMmkdata?" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, UCAR.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
     
<script>var version_json_loc = "../../../../versions.json";</script>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/pop_ver.js"></script>
    

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>