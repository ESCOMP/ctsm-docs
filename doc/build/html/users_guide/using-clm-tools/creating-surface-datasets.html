

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>1.3.5. Creating Surface Datasets &#8212; clmdoc release-clm5.0.01 documentation</title>
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.3.6. Datasets for Observational Sites" href="datasts-for-observational-sites.html" />
    <link rel="prev" title="1.3.4. Creating input for surface dataset generation" href="creating-input-for-surface-dataset-generation.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="datasts-for-observational-sites.html" title="1.3.6. Datasets for Observational Sites"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="creating-input-for-surface-dataset-generation.html" title="1.3.4. Creating input for surface dataset generation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">clmdoc release-clm5.0.01 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >1. clm5.0 User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">1.3. Using CLM tools</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1.3.5. Creating Surface Datasets</a><ul>
<li><a class="reference internal" href="#creating-a-complete-set-of-files-for-input-to-clm">1.3.5.1. Creating a Complete Set of Files for Input to CLM</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="creating-input-for-surface-dataset-generation.html"
                        title="previous chapter">1.3.4. Creating input for surface dataset generation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="datasts-for-observational-sites.html"
                        title="next chapter">1.3.6. Datasets for Observational Sites</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/users_guide/using-clm-tools/creating-surface-datasets.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="creating-surface-datasets">
<span id="id1"></span><h1>1.3.5. Creating Surface Datasets<a class="headerlink" href="#creating-surface-datasets" title="Permalink to this headline">¶</a></h1>
<p>When just creating a replacement file for an existing one, the relevant tool should be used directly to create the file. When you are creating a set of files for a new resolution there are some dependencies between the tools that you need to keep in mind when creating them. The main dependency is that you MUST create a SCRIP grid file first as the SCRIP grid dataset is then input into the other tools. Also look at <a class="reference external" href="CLM-URL">Table 3-1</a> which gives information on the files required and when. <a class="reference internal" href="#figure-data-flow"><span class="std std-numref">Figure 1.3.2</span></a> shows an overview of the general data-flow for creation of the fsurdat datasets.</p>
<div class="figure" id="id2">
<span id="figure-data-flow"></span><img alt="../../_images/mkmapdata_mksurfdata.jpeg" src="../../_images/mkmapdata_mksurfdata.jpeg" />
<p class="caption"><span class="caption-number">Figure 1.3.2 </span><span class="caption-text">Data Flow for Creation of Surface Datasets from Raw SCRIP Grid Files</span></p>
</div>
<p>Starting from a SCRIP grid file that describes the grid you will run the model on, you first run <strong>mkmapdata.sh</strong> to create a list of mapping files. See <a class="reference internal" href="creating-input-for-surface-dataset-generation.html#figure-mkmapdata-sh"><span class="std std-numref">Figure 1.3.1</span></a> for a more detailed view of how <strong>mkmapdata.sh</strong> works. The mapping files tell <strong>mksurfdata_map</strong> how to map between the output grid and the raw datasets that it uses as input. The output of <strong>mksurfdata_map</strong> is a surface dataset that you then use for running the model. See <cite>Figure :numref:`Figure mksurfdatamap</cite> for a more detailed view of how <strong>mksurfdata_map</strong> works.</p>
<p><a class="reference internal" href="#figure-data-flow-legend"><span class="std std-numref">Figure 1.3.3</span></a> is the legend for this figure (<a class="reference internal" href="#figure-data-flow"><span class="std std-numref">Figure 1.3.2</span></a>) and other figures in this chapter (<code class="xref std std-numref docutils literal notranslate"><span class="pre">Figure</span> <span class="pre">Global_Domain</span></code>, <a class="reference internal" href="creating-domain-files.html#figure-mknoocnmap-pl"><span class="std std-numref">Figure 1.3.5</span></a> and <code class="xref std std-numref docutils literal notranslate"><span class="pre">Figure</span> <span class="pre">mksurfdatamap</span></code>).</p>
<div class="figure" id="id3">
<span id="figure-data-flow-legend"></span><img alt="../../_images/LegendCLMToolDataFlow.jpeg" src="../../_images/LegendCLMToolDataFlow.jpeg" />
<p class="caption"><span class="caption-number">Figure 1.3.3 </span><span class="caption-text">Legend for Data Flow Figures</span></p>
</div>
<p>Green arrows define the input to a program, while red arrows define the output. Cylinders define files that are either created by a program or used as input for a program. Boxes are programs.</p>
<p>You start with a description of a SCRIP grid file for your output grid file and then create mapping files from the raw datasets to it. Once, the mapping files are created <strong>mksurfdata_map</strong> is run to create the surface dataset to run the model.</p>
<div class="section" id="creating-a-complete-set-of-files-for-input-to-clm">
<h2>1.3.5.1. Creating a Complete Set of Files for Input to CLM<a class="headerlink" href="#creating-a-complete-set-of-files-for-input-to-clm" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Create SCRIP grid datasets (if NOT already done)</p>
<p>First you need to create a descriptor file for your grid, that includes the locations of cell centers and cell corners. There is also a “mask” field, but in this case the mask is set to one everywhere (i.e. all of the masks for the output model grid are “nomask”). An example SCRIP grid file is: $CSMDATA/lnd/clm2/mappingdata/grids/SCRIPgrid_10x15_nomask_c110308.nc. The mkmapgrids and mkscripgrid.ncl NCL script in the $CTSMROOT/tools/mkmapgrids directory can help you with this. SCRIP grid files for all the standard CLM grids are already created for you. See the Section called Creating an output SCRIP grid file at a resolution to run the model on for more information on this.</p>
</li>
<li><p class="first">Create domain dataset (if NOT already done)</p>
<p>Next use gen_domain to create a domain file for use by DATM and CLM. This is required, unless a domain file was already created. See the Section called Creating a domain file for CLM and DATM for more information on this.</p>
</li>
<li><p class="first">Create mapping files for mksurfdata_map (if NOT already done)</p>
<p>Create mapping files for mksurfdata_map with mkmapdata.sh in $CTSMROOT/tools/mkmapdata. See the Section called Creating mapping files that mksurfdata_map will use for more information on this.</p>
</li>
<li><p class="first">Create surface datasets</p>
<p>Next use mksurfdata_map to create a surface dataset, using the mapping datasets created on the previous step as input. There is a version for either clm4_0 or clm5.0 for this program. See the Section called Using mksurfdata_map to create surface datasets from grid datasets for more information on this.</p>
</li>
<li><p class="first">Enter the new datasets into the build-namelist XML database
The last optional thing to do is to enter the new datasets into the build-namelist XML database. See Chapter 3 for more information on doing this. This is optional because the user may enter these files into their namelists manually. The advantage of entering them into the database is so that they automatically come up when you create new cases.</p>
</li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">$CTSMROOT/tools/README</span></code> goes through the complete process for creating input files needed to run CLM. We repeat that file here:</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="datasts-for-observational-sites.html" title="1.3.6. Datasets for Observational Sites"
             >next</a> |</li>
        <li class="right" >
          <a href="creating-input-for-surface-dataset-generation.html" title="1.3.4. Creating input for surface dataset generation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">clmdoc release-clm5.0.01 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >1. clm5.0 User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >1.3. Using CLM tools</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Erik Kluzek, Bill Sacks, Ben Andre.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.
    </div>
  </body>
</html>