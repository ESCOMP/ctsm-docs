

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>1.2.4. Customizing the DATM namelist &#8212; clmdoc  documentation</title>
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.3. Using CLM tools" href="../using-clm-tools/index.html" />
    <link rel="prev" title="1.2.3. Customizing CLM’s namelist" href="customizing-the-clm-namelist.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../using-clm-tools/index.html" title="1.3. Using CLM tools"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="customizing-the-clm-namelist.html" title="1.2.3. Customizing CLM’s namelist"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">clmdoc  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >1. CLM User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">1.2. Setting Up and Running a Case</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1.2.4. Customizing the DATM namelist</a><ul>
<li><a class="reference internal" href="#clmcruncep-mode-and-it-s-datm-settings">1.2.4.1. CLMCRUNCEP mode and it’s DATM settings</a></li>
<li><a class="reference internal" href="#clm-qian-mode-and-it-s-datm-settings">1.2.4.2. CLM_QIAN mode and it’s DATM settings</a></li>
<li><a class="reference internal" href="#clm1pt-mode-and-it-s-datm-settings">1.2.4.3. CLM1PT mode and it’s DATM settings</a></li>
<li><a class="reference internal" href="#cplhist3hrwx-mode-and-it-s-datm-settings">1.2.4.4. CPLHIST3HrWx mode and it’s DATM settings</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="customizing-the-clm-namelist.html"
                        title="previous chapter">1.2.3. Customizing CLM’s namelist</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../using-clm-tools/index.html"
                        title="next chapter">1.3. Using CLM tools</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/users_guide/setting-up-and-running-a-case/customizing-the-datm-namelist.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="customizing-the-datm-namelist">
<h1>1.2.4. Customizing the DATM namelist<a class="headerlink" href="#customizing-the-datm-namelist" title="Permalink to this headline">¶</a></h1>
<p>When running “I” compsets with CLM you use the DATM model to give atmospheric forcing data to CLM. There are two ways to customize DATM:</p>
<ol class="arabic simple">
<li><strong>DATM Main Namelist and Stream Namlist gorup</strong> (<code class="docutils literal"><span class="pre">datm_in</span></code>)</li>
<li><strong>DATM stream files</strong></li>
</ol>
<p>The <a class="reference external" href="CLM-URL">Data Model Documentation</a> gives the details of all the options for the data models and for DATM specifically.
It goes into detail on all namelist items both for DATM and for DATM streams.
So here we won’t list ALL of the DATM namelist options, nor go into great details about stream files.
But, we will talk about a few of the different options that are relevant for running with CLM.
All of the options for changing the namelists or stream files is done by editing the <code class="docutils literal"><span class="pre">user_nl_datm</span></code> file.</p>
<p>Because, they aren’t useful for work with CLM we will NOT discuss any of the options for the main DATM namelist. Use the DATM Users Guide at the link above to find details of that. For the streams namelist we will discuss three items:</p>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">mapalgo</span></code></li>
<li><code class="docutils literal"><span class="pre">taxmode</span></code></li>
<li><code class="docutils literal"><span class="pre">tintalgo</span></code></li>
</ol>
<p>And for the streams file itself we will discuss:</p>
<dl class="docutils">
<dt>offset</dt>
<dd>Again everything else (and including the above items) are discussed in the Data Model User’s Guide. Of the above the last three: offset, taxmode and tintalgo are all closely related and have to do with the time interpolation of the DATM data.</dd>
<dt>mapalgo</dt>
<dd><code class="docutils literal"><span class="pre">mapalgo</span></code> sets the spatial interpolation method to go from the DATM input data to the output DATM model grid. The default is <code class="docutils literal"><span class="pre">bilinear</span></code>. For <code class="docutils literal"><span class="pre">CLM1PT</span></code> we set it to <code class="docutils literal"><span class="pre">nn</span></code> to just select the nearest neighbor. This saves time and we also had problems running the interpolation for single-point mode.</dd>
<dt>taxmode</dt>
<dd><code class="docutils literal"><span class="pre">taxmode</span></code> is the time axis mode.
For CLM we usually have it set to <code class="docutils literal"><span class="pre">cycle</span></code> which means that once the end of the data is reached it will start over at the beginning.
The extend modes is used have it use the last time-step of the forcing data once it reaches the end of forcing data (or use the first time-step before it reaches where the forcing data starts). See the warning below about the extend mode.</dd>
</dl>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><em>THE extend OPTION NEEDS TO BE USED WITH CAUTION!</em> It is only invoked by default for the CLM1PT mode and is only intended for the supported urban datasets to extend the data for a single time-step. If you have the model <em>run extensively through periods in this mode you will effectively be repeating that last time-step over that entire period</em>. This means the output of your simulation will be worthless.</p>
</div>
<dl class="docutils">
<dt>offset (in the stream file)</dt>
<dd><code class="docutils literal"><span class="pre">offset</span></code> is the time offset in seconds to give to each stream of data. Normally it is NOT used because the time-stamps for data is set correctly for each stream of data. Note, the <code class="docutils literal"><span class="pre">offset</span></code> may NEED to be adjusted depending on the <code class="docutils literal"><span class="pre">taxmode</span></code> described above, or it may need to be adjusted to account for data that is time-stamped at the END of an interval rather than the middle or beginning of interval. The <code class="docutils literal"><span class="pre">offset</span></code> can is set in the stream file rather than on the stream namelist. For data with a <code class="docutils literal"><span class="pre">taxmode</span></code> method of <code class="docutils literal"><span class="pre">coszen</span></code> the time-stamp needs to be for the beginning of the interval, while for other data it should be the midpoint. The <code class="docutils literal"><span class="pre">offset</span></code> can be used to adjust the time-stamps to get the data to line up correctly.</dd>
<dt>tintalgo</dt>
<dd><code class="docutils literal"><span class="pre">tintalgo</span></code> is the time interpolation algorithm. For CLM we usually use one of three modes: <code class="docutils literal"><span class="pre">coszen</span></code>, <code class="docutils literal"><span class="pre">nearest</span></code>, or <code class="docutils literal"><span class="pre">linear</span></code>. We use <code class="docutils literal"><span class="pre">coszen</span></code> for solar data, nearest for precipitation data, and linear for everything else. If your data is half-hourly or hourly, nearest will work fine for everything. The <code class="docutils literal"><span class="pre">coszen</span></code> scaling is useful for longer periods (three hours or more) to try to get the solar to match the cosine of the solar zenith angle over that longer period of time. If you use linear for longer intervals, the solar will cut out at night-time anyway, and the straight line will be a poor approximation of the cosine of the solar zenith angle of actual solar data. nearest likewise would be bad for longer periods where it would be much higher than the actual values.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For <code class="docutils literal"><span class="pre">coszen</span></code> the time-stamps of the data should correspond to the beginning of the interval the data is measured for. Either make sure the time-stamps on the datafiles is set this way, or use the <code class="docutils literal"><span class="pre">offset</span></code> described above to set it.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For nearest and linear the time-stamps of the data should correspond to the middle of the interval the data is measured for. Either make sure the time-stamps on the datafiles is set this way, or use the <code class="docutils literal"><span class="pre">offset</span></code> described above to set it.</p>
</div>
<p>In the sections below we go over each of the relevant <code class="docutils literal"><span class="pre">DATM_MODE</span></code> options and what the above DATM settings are for each. This gives you examples of actual usage for the settings. We also describe in what ways you might want to customize them for your own case.</p>
<div class="section" id="clmcruncep-mode-and-it-s-datm-settings">
<h2>1.2.4.1. CLMCRUNCEP mode and it’s DATM settings<a class="headerlink" href="#clmcruncep-mode-and-it-s-datm-settings" title="Permalink to this headline">¶</a></h2>
<p>In <code class="docutils literal"><span class="pre">CLMCRUNCEP</span></code> mode the CRUNCEP dataset is used and all of it’s data is on a 6-hourly interval.
Like <code class="docutils literal"><span class="pre">CLM_QIAN</span></code> the dataset is divided into those three data streams: solar, precipitation, and everything else (temperature, pressure, humidity and wind).
The time-stamps of the data were also adjusted so that they are the beginning of the interval for solar, and the middle for the other two.
Because, of this the <code class="docutils literal"><span class="pre">offset</span></code> is set to zero, and the <code class="docutils literal"><span class="pre">tintalgo</span></code> is: <code class="docutils literal"><span class="pre">coszen</span></code>, <code class="docutils literal"><span class="pre">nearest</span></code>, and <code class="docutils literal"><span class="pre">linear</span></code> for the solar, precipitation and other data respectively.
<code class="docutils literal"><span class="pre">taxmode</span></code> is set to <code class="docutils literal"><span class="pre">cycle</span></code> and <code class="docutils literal"><span class="pre">mapalgo</span></code> is set to <code class="docutils literal"><span class="pre">bilinear</span></code> so that the data is spatially interpolated from the input exact half degree grid to the grid the atmosphere model is being run at (to run at this same model resolution use the 360x720cru_360x720cru resolution).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The “everything else” data stream (of temperature, pressure, humidity and wind) also includes the data for longwave downward forcing as well. Our simulations showed sensitivity to this field, so we backed off in using it, and let DATM calculate longwave down from the other fields.</p>
</div>
<p>For more information on CRUNCEP forcing see <a class="reference external" href="http://dods.extra.cea.fr/data/p529viov/cruncep/">http://dods.extra.cea.fr/data/p529viov/cruncep/</a>.</p>
</div>
<div class="section" id="clm-qian-mode-and-it-s-datm-settings">
<h2>1.2.4.2. CLM_QIAN mode and it’s DATM settings<a class="headerlink" href="#clm-qian-mode-and-it-s-datm-settings" title="Permalink to this headline">¶</a></h2>
<p>In <code class="docutils literal"><span class="pre">CLM_QIAN</span></code> mode the Qian dataset is used which has 6-hourly solar and precipitation data, and 3-hourly for everything else.
The dataset is divided into those three data streams: solar, precipitation, and everything else (temperature, pressure, humidity and wind).
The time-stamps of the data were also adjusted so that they are the beginning of the interval for solar, and the middle for the other two.
Because, of this the <code class="docutils literal"><span class="pre">offset</span></code> is set to zero, and the <code class="docutils literal"><span class="pre">tintalgo</span></code> is: <code class="docutils literal"><span class="pre">coszen</span></code>, <code class="docutils literal"><span class="pre">nearest</span></code>, and <code class="docutils literal"><span class="pre">linear</span></code> for the solar, precipitation and other data respectively.
<code class="docutils literal"><span class="pre">taxmode</span></code> is set to <code class="docutils literal"><span class="pre">cycle</span></code> and <code class="docutils literal"><span class="pre">mapalgo</span></code> is set to <code class="docutils literal"><span class="pre">bilinear</span></code> so that the data is spatially interpolated from the input T62 grid to the grid the atmosphere model is being run at.</p>
<p>Normally you wouldn’t customize the <code class="docutils literal"><span class="pre">CLM_QIAN</span></code> settings, but you might replicate it’s use for your own global data that had similar temporal characteristics.</p>
</div>
<div class="section" id="clm1pt-mode-and-it-s-datm-settings">
<h2>1.2.4.3. CLM1PT mode and it’s DATM settings<a class="headerlink" href="#clm1pt-mode-and-it-s-datm-settings" title="Permalink to this headline">¶</a></h2>
<p>In <code class="docutils literal"><span class="pre">CLM1PT</span></code> mode the model is assumed to have half-hourly or hourly data for a single-point.
For the supported datasets that is exactly what it has.
But, if you add your own data you may need to make adjustments accordingly.
Using the <code class="docutils literal"><span class="pre">CLM_USRDAT_NAME</span></code> resolution you can easily extend this mode for your own datasets that may be regional or even global and could be at different temporal frequencies.
If you do so you’ll need to make adjustments to your DATM settings.
The dataset has all data in a single stream file.
The time-stamps of the data were also adjusted so that they are at the middle of the interval.
Because, of this the <code class="docutils literal"><span class="pre">offset</span></code> is set to zero, and the <code class="docutils literal"><span class="pre">tintalgo</span></code> is set to <code class="docutils literal"><span class="pre">nearest</span></code>.
<code class="docutils literal"><span class="pre">taxmode</span></code> is set to <code class="docutils literal"><span class="pre">extend</span></code> and <code class="docutils literal"><span class="pre">mapalgo</span></code> is set to <code class="docutils literal"><span class="pre">nn</span></code> so that simply the nearest point is used.</p>
<p>If you are using your own data for this mode and it’s not at least hourly you’ll want to adjust the DATM settings for it. If the data is three or six hourly, you’ll need to divide it up into separate streams like in <code class="docutils literal"><span class="pre">CLM_QIAN</span></code> mode which will require fairly extensive changes to the DATM namelist and streams files. For an example of doing this see <a class="reference external" href="CLM-URL">Example 5-8</a>.</p>
</div>
<div class="section" id="cplhist3hrwx-mode-and-it-s-datm-settings">
<h2>1.2.4.4. CPLHIST3HrWx mode and it’s DATM settings<a class="headerlink" href="#cplhist3hrwx-mode-and-it-s-datm-settings" title="Permalink to this headline">¶</a></h2>
<p>In <code class="docutils literal"><span class="pre">CPLHIST3HrWx</span></code> mode the model is assumed to have 3-hourly for a global grid from a previous CESM simulation.
Like <code class="docutils literal"><span class="pre">CLM_QIAN</span></code> mode the data is divided into three streams: one for precipitation, one for solar, and one for everything else.
The time-stamps for Coupler history files for CESM is at the end of the interval, so the <code class="docutils literal"><span class="pre">offset</span></code> needs to be set in order to adjust the time-stamps to what it needs to be for the <code class="docutils literal"><span class="pre">tintalgo</span></code> settings.
For precipitation <code class="docutils literal"><span class="pre">taxmode</span></code> is set to <code class="docutils literal"><span class="pre">nearest</span></code> so the <code class="docutils literal"><span class="pre">offset</span></code> is set to <code class="docutils literal"><span class="pre">-5400</span></code> seconds so that the ending time-step is adjusted by an hour and half to the middle of the interval.
For solar <code class="docutils literal"><span class="pre">taxmode</span></code> is set to <code class="docutils literal"><span class="pre">coszen</span></code> so the offset is set to <code class="docutils literal"><span class="pre">-10800</span></code> seconds so that the ending time-step is adjust by three hours to the beginning of the interval.
For everything else <code class="docutils literal"><span class="pre">taxmode</span></code> is set to <code class="docutils literal"><span class="pre">linear</span></code> so the offset is set to <code class="docutils literal"><span class="pre">-5400</span></code> seconds so that the ending time-step is adjusted by an hour and half to the middle of the interval.
For an example of such a case see <a class="reference external" href="CLM-URL">the Section called Running with MOAR data as atmospheric forcing to spinup the model in Chapter 4</a>.</p>
<p>Normally you wouldn’t modify the DATM settings for this mode.
However, if you had data at a different frequency than 3-hours you would need to modify the <code class="docutils literal"><span class="pre">offset</span></code> and possibly the <code class="docutils literal"><span class="pre">taxmode</span></code>.
The other two things that you might modify would be the path to the data or the domain file for the resolution (which is currently hardwired to f09).
For data at a different input resolution you would need to change the domain file in the streams file to use a domain file to the resolution that the data comes in on.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../using-clm-tools/index.html" title="1.3. Using CLM tools"
             >next</a> |</li>
        <li class="right" >
          <a href="customizing-the-clm-namelist.html" title="1.2.3. Customizing CLM’s namelist"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">clmdoc  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >1. CLM User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >1.2. Setting Up and Running a Case</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Erik Kluzek, Bill Sacks, Ben Andre.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>