

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>12. Lake Model &#8212; clmdoc  documentation</title>
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="13. Glaciers" href="../Glacier/CLM50_Tech_Note_Glacier.html" />
    <link rel="prev" title="11. Plant Hydraulics" href="../Plant_Hydraulics/CLM50_Tech_Note_Plant_Hydraulics.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../Glacier/CLM50_Tech_Note_Glacier.html" title="13. Glaciers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../Plant_Hydraulics/CLM50_Tech_Note_Plant_Hydraulics.html" title="11. Plant Hydraulics"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">clmdoc  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">CLM Technical Note</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">12. Lake Model</a><ul>
<li><a class="reference internal" href="#vertical-discretization">12.1. Vertical Discretization</a></li>
<li><a class="reference internal" href="#external-data">12.2. External Data</a></li>
<li><a class="reference internal" href="#surface-albedo">12.3. Surface Albedo</a></li>
<li><a class="reference internal" href="#surface-fluxes-and-surface-temperature">12.4. Surface Fluxes and Surface Temperature</a><ul>
<li><a class="reference internal" href="#surface-properties">12.4.1. Surface Properties</a></li>
<li><a class="reference internal" href="#surface-flux-solution">12.4.2. Surface Flux Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lake-temperature">12.5. Lake Temperature</a><ul>
<li><a class="reference internal" href="#introduction">12.5.1. Introduction</a></li>
<li><a class="reference internal" href="#overview-of-changes-from-clm4">12.5.2. Overview of Changes from CLM4</a></li>
<li><a class="reference internal" href="#boundary-conditions">12.5.3. Boundary Conditions</a></li>
<li><a class="reference internal" href="#eddy-diffusivity-and-thermal-conductivities">12.5.4. Eddy Diffusivity and Thermal Conductivities</a></li>
<li><a class="reference internal" href="#radiation-penetration">12.5.5. Radiation Penetration</a></li>
<li><a class="reference internal" href="#heat-capacities">12.5.6. Heat Capacities</a></li>
<li><a class="reference internal" href="#crank-nicholson-solution">12.5.7. Crank-Nicholson Solution</a></li>
<li><a class="reference internal" href="#phase-change">12.5.8. Phase Change</a></li>
<li><a class="reference internal" href="#convection">12.5.9. Convection</a></li>
<li><a class="reference internal" href="#energy-conservation">12.5.10. Energy Conservation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lake-hydrology">12.6. Lake Hydrology</a><ul>
<li><a class="reference internal" href="#overview">12.6.1. Overview</a></li>
<li><a class="reference internal" href="#water-balance">12.6.2. Water Balance</a></li>
<li><a class="reference internal" href="#precipitation-evaporation-and-runoff">12.6.3. Precipitation, Evaporation, and Runoff</a></li>
<li><a class="reference internal" href="#soil-hydrology">12.6.4. Soil Hydrology</a></li>
<li><a class="reference internal" href="#modifications-to-snow-layer-logic">12.6.5. Modifications to Snow Layer Logic</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../Plant_Hydraulics/CLM50_Tech_Note_Plant_Hydraulics.html"
                        title="previous chapter">11. Plant Hydraulics</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../Glacier/CLM50_Tech_Note_Glacier.html"
                        title="next chapter">13. Glaciers</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/tech_note/Lake/CLM50_Tech_Note_Lake.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lake-model">
<span id="rst-lake-model"></span><h1>12. Lake Model<a class="headerlink" href="#lake-model" title="Permalink to this headline">¶</a></h1>
<p>The lake model, denoted the <em>Lake, Ice, Snow, and Sediment Simulator</em>
(LISSS), is from <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#subinetal2012a"><span class="std std-ref">Subin et al. (2012a)</span></a>.
It includes extensive modifications to the lake code of
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#zengetal2002"><span class="std std-ref">Zeng et al. (2002)</span></a> used in CLM
versions 2 through 4, which utilized concepts from the lake models of
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#bonan1996"><span class="std std-ref">Bonan (1996)</span></a>,
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#henderson-sellers1985"><span class="std std-ref">Henderson-Sellers  (1985)</span></a>,
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#henderson-sellers1986"><span class="std std-ref">Henderson-Sellers  (1986)</span></a>,
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#hostetlerbartlein1990"><span class="std std-ref">Hostetler and Bartlein (1990)</span></a>,
and the coupled lake-atmosphere model of <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#hostetleretal1993"><span class="std std-ref">Hostetler et al. (1993)</span></a>, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#hostetleretal1993"><span class="std std-ref">Hostetler et al. (1993)</span></a>.
Lakes have spatially variable depth prescribed in the surface data (section
<a class="reference internal" href="#external-data-lake"><span class="std std-ref">External Data</span></a>); the surface data optionally includes lake optical
extinction coeffient and horizontal fetch, currently only used for site
simulations. Lake physics includes freezing and thawing in the lake
body, resolved snow layers, and “soil” and bedrock layers below the lake
body. Temperatures and ice fractions are simulated for
<img class="math" src="../../_images/math/a24c0d844b5ebaadff540af3eac3edc4ad3c693a.png" alt="N_{levlak} =10"/> layers (for global simulations) or
<img class="math" src="../../_images/math/403d8950a0bfcb5deeea8dd451d42e7b910fc8e4.png" alt="N_{levlak} =25"/> (for site simulations) with discretization
described in section <a class="reference internal" href="#vertical-discretization-lake"><span class="std std-numref">12.1</span></a>. Lake albedo is
described in section <a class="reference internal" href="#surface-albedo-lake"><span class="std std-numref">12.3</span></a>. Lake surface fluxes
(section <a class="reference internal" href="#surface-fluxes-and-surface-temperature-lake"><span class="std std-numref">12.4</span></a>) generally
follow the formulations for non-vegetated surfaces, including the calculations
of aerodynamic resistances (section
<a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#sensible-and-latent-heat-fluxes-for-non-vegetated-surfaces"><span class="std std-numref">5.2</span></a>);
however, the lake surface temperature
<img class="math" src="../../_images/math/04eb83d8d8a3d4bded815024e685288439cff3b6.png" alt="T_{g}"/>  (representing an infinitesimal interface layer between
the top resolved lake layer and the atmosphere) is solved for
simultaneously with the surface fluxes. After surface fluxes are
evaluated, temperatures are solved simultaneously in the resolved snow
layers (if present), the lake body, and the soil and bedrock, using the
ground heat flux <em>G</em> as a top boundary condition. Snow, soil, and
bedrock models generally follow the formulations for non-vegetated
surfaces (Chapter <a class="reference internal" href="../Soil_Snow_Temperatures/CLM50_Tech_Note_Soil_Snow_Temperatures.html#rst-soil-and-snow-temperatures"><span class="std std-numref">6</span></a>), with
modifications described below.</p>
<div class="section" id="vertical-discretization">
<span id="vertical-discretization-lake"></span><h2>12.1. Vertical Discretization<a class="headerlink" href="#vertical-discretization" title="Permalink to this headline">¶</a></h2>
<p>Currently, there is one lake modeled in each grid cell (with prescribed
or assumed depth <em>d</em>, extinction coefficient <img class="math" src="../../_images/math/5635a7c34414599c2452d72430811e816b460335.png" alt="\eta"/>, and fetch
<em>f</em>), although this could be modified with changes to the CLM subgrid
decomposition algorithm in future model versions. As currently
implemented, the lake consists of 0-5 snow layers; water and ice layers
(10 for global simulations and 25 for site simulations) comprising the
“lake body;” 10 “soil” layers; and 5 bedrock layers. Each lake body
layer has a fixed water mass (set by the nominal layer thickness and the
liquid density), with frozen mass-fraction <em>I</em> a state variable.
Resolved snow layers are present if the snow thickness
<img class="math" src="../../_images/math/6af3496cf8f91cca90af881264d0a7b873bd76c7.png" alt="z_{sno} \ge s_{\min }"/>  , where <em>s</em><sub>min</sub> = 4 cm by
default, and is adjusted for model timesteps other than 1800 s in order
to maintain numerical stability (section <a class="reference internal" href="#modifications-to-snow-layer-logic-lake"><span class="std std-numref">12.6.5</span></a>). For global simulations
with 10 body layers, the default (50 m lake) body layer thicknesses are
given by: <img class="math" src="../../_images/math/18a8202648d865786985b1bdb0926ae863cf8908.png" alt="\Delta z_{i}"/>  of 0.1, 1, 2, 3, 4, 5, 7, 7, 10.45, and
10.45 m, with node depths <img class="math" src="../../_images/math/5c6a6f366d550318f46ac322944a966f3e695c78.png" alt="z_{i}"/>  located at the center of each
layer (i.e., 0.05, 0.6, 2.1, 4.6, 8.1, 12.6, 18.6, 25.6, 34.325, 44.775
m). For site simulations with 25 layers, the default thicknesses are
(m): 0.1 for layer 1; 0.25 for layers 2-5; 0.5 for layers 6-9; 0.75 for
layers 10-13; 2 for layers 14-15; 2.5 for layers 16-17; 3.5 for layers
18-21; and 5.225 for layers 22-25. For lakes with depth <em>d</em>
<img class="math" src="../../_images/math/447e857814f58fc9505c019ba4a929dffc35e1a9.png" alt="\neq"/> 50 m and <em>d</em> <img class="math" src="../../_images/math/744a7e944983312265f2ed7497ddf42da26942a6.png" alt="\ge"/> 1 m, the top
layer is kept at 10 cm and the other 9 layer thicknesses are adjusted to
maintain fixed proportions. For lakes with <em>d</em> <img class="math" src="../../_images/math/863f524a433d6d1e5715f76f12040c654f10d86d.png" alt="&lt;"/> 1 m, all layers
have equal thickness. Thicknesses of snow, soil, and bedrock layers
follow the scheme used over non-vegetated surfaces (Chapter <a class="reference internal" href="../Soil_Snow_Temperatures/CLM50_Tech_Note_Soil_Snow_Temperatures.html#rst-soil-and-snow-temperatures"><span class="std std-numref">6</span></a>), with
modifications to the snow layer thickness rules to keep snow layers at
least as thick as <em>s</em><sub>min</sub> (section <a class="reference internal" href="#modifications-to-snow-layer-logic-lake"><span class="std std-numref">12.6.5</span></a>).</p>
</div>
<div class="section" id="external-data">
<span id="external-data-lake"></span><h2>12.2. External Data<a class="headerlink" href="#external-data" title="Permalink to this headline">¶</a></h2>
<p>As discussed in <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#subinetal2012a"><span class="std std-ref">Subin et al. (2012a, b)</span></a>, the
Global Lake and Wetland Database (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#lehnerdoll2004"><span class="std std-ref">Lehner and Doll 2004</span></a>)
is currently used to prescribe lake fraction in each land model grid cell,
for a total of 2.3 million km<sup>-2</sup>. As in
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#subinetal2012a"><span class="std std-ref">Subin et al. (2012a, b)</span></a>, the
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#kourzenevaetal2012"><span class="std std-ref">Kourzeneva et al. (2012)</span></a> global gridded dataset is currently
used to estimate a mean lake depth in each grid cell, based on interpolated
compilations of geographic information.</p>
</div>
<div class="section" id="surface-albedo">
<span id="surface-albedo-lake"></span><h2>12.3. Surface Albedo<a class="headerlink" href="#surface-albedo" title="Permalink to this headline">¶</a></h2>
<p>For direct radiation, the albedo <em>a</em> for lakes with ground temperature
<img class="math" src="../../_images/math/3dc5da767342c6f5c337cad15fd295401e5f5324.png" alt="{T}_{g}"/> (K) above freezing is given by (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#pivovarov1972"><span class="std std-ref">Pivovarov, 1972</span></a>)</p>
<div class="math" id="equation-12.1">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-12.1" title="Permalink to this equation">¶</a></span><img src="../../_images/math/41a68573fdaf76af0354417863db551cc4c07da4.png" alt="a=\frac{0.5}{\cos z+0.15}"/></p>
</div><p>where <em>z</em> is the zenith angle. For diffuse radiation, the expression in
eq. is integrated over the full sky to yield <em>a</em> = 0.10.</p>
<p>For frozen lakes without resolved snow layers, the albedo at cold
temperatures <em>a</em><sub>0</sub> is 0.60 for visible and 0.40 for near
infrared radiation. As the temperature at the ice surface,
<img class="math" src="../../_images/math/3dc5da767342c6f5c337cad15fd295401e5f5324.png" alt="{T}_{g}"/>, approaches freezing [ <img class="math" src="../../_images/math/69efff94fbd30e8c72d4f766ae48aa2d2d44d89b.png" alt="{T}_{f}"/> (K) (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.6</span></a>)], the albedo is relaxed towards 0.10 based on
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#mironovetal2010"><span class="std std-ref">Mironov et al. (2010)</span></a>:</p>
<div class="math" id="equation-12.2">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-12.2" title="Permalink to this equation">¶</a></span><img src="../../_images/math/efefb7f5fffce97ea2550bfddaeeca53a0c4b65c.png" alt="a=a_{0} \left(1-x\right)+0.10x,x=\exp \left(-95\frac{T_{f} -T_{g} }{T_{f} } \right)"/></p>
</div><p>where <em>a</em> is restricted to be no less than that given in <a class="reference internal" href="#equation-12.1">(1)</a>.</p>
<p>For frozen lakes with resolved snow layers, the reflectance of the ice
surface is fixed at <em>a</em><sub>0</sub>, and the snow reflectance is
calculated as over non-vegetated surfaces (Chapter <a class="reference internal" href="../Surface_Albedos/CLM50_Tech_Note_Surface_Albedos.html#rst-surface-albedos"><span class="std std-numref">3</span></a>).
These two reflectances are combined to obtain the snow-fraction-weighted albedo as
in over non-vegetated surfaces (Chapter <a class="reference internal" href="../Surface_Albedos/CLM50_Tech_Note_Surface_Albedos.html#rst-surface-albedos"><span class="std std-numref">3</span></a>).</p>
</div>
<div class="section" id="surface-fluxes-and-surface-temperature">
<span id="surface-fluxes-and-surface-temperature-lake"></span><h2>12.4. Surface Fluxes and Surface Temperature<a class="headerlink" href="#surface-fluxes-and-surface-temperature" title="Permalink to this headline">¶</a></h2>
<div class="section" id="surface-properties">
<span id="surface-properties-lake"></span><h3>12.4.1. Surface Properties<a class="headerlink" href="#surface-properties" title="Permalink to this headline">¶</a></h3>
<p>The fraction of shortwave radiation absorbed at the surface,
<img class="math" src="../../_images/math/410a9d0df9c135dd73b269cba7ef04dcfd932b1f.png" alt="\beta"/>, depends on the lake state. If resolved snow layers are
present, then <img class="math" src="../../_images/math/410a9d0df9c135dd73b269cba7ef04dcfd932b1f.png" alt="\beta"/> is set equal to the absorption fraction
predicted by the snow-optics submodel (Chapter <a class="reference internal" href="../Surface_Albedos/CLM50_Tech_Note_Surface_Albedos.html#rst-surface-albedos"><span class="std std-numref">3</span></a>)
for the top snow
layer. Otherwise, <img class="math" src="../../_images/math/410a9d0df9c135dd73b269cba7ef04dcfd932b1f.png" alt="\beta"/> is set equal to the near infrared
fraction of the shortwave radiation reaching the surface simulated by
the atmospheric model or atmospheric data model used for offline
simulations (Chapter <a class="reference internal" href="../Land-Only_Mode/CLM50_Tech_Note_Land-Only_Mode.html#rst-land-only-mode"><span class="std std-numref">32</span></a>). The remainder of the shortwave radiation
fraction (1 <img class="math" src="../../_images/math/99dbb271bdcc84453cd0d86b654e8196432d8a5d.png" alt="{-}"/> <img class="math" src="../../_images/math/410a9d0df9c135dd73b269cba7ef04dcfd932b1f.png" alt="\beta"/>) is absorbed in the lake
body or soil as described in section <a class="reference internal" href="#radiation-penetration"><span class="std std-numref">12.5.5</span></a>.</p>
<p>The surface roughnesses are functions of the lake state and atmospheric
forcing. For frozen lakes ( <img class="math" src="../../_images/math/d21a433ad8384f9fe95fffb9321580b5043b0cbe.png" alt="T_{g} \le T_{f}"/> ) with resolved
snow layers, the momentum roughness length
<img class="math" src="../../_images/math/5830afdca84ed8132a0e4056176eeb02664cd482.png" alt="z_{0m} =2.4 \times 10^{-3} {\rm m}"/> (as over non-vegetated
surfaces; Chapter <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#rst-momentum-sensible-heat-and-latent-heat-fluxes"><span class="std std-numref">5</span></a>), and the scalar roughness lengths
(<em>z</em><sub>0q</sub> for latent heat; and <em>z</em><sub>0h</sub>, for sensible heat) are given by
(<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#zilitinkevich1970"><span class="std std-ref">Zilitinkevich 1970</span></a>)</p>
<div class="math" id="equation-12.3">
<p><span class="eqno">(3)<a class="headerlink" href="#equation-12.3" title="Permalink to this equation">¶</a></span><img src="../../_images/math/6358a57e58660ba1ccffcaa1d3d3bb3cf5bff37b.png" alt="\begin{array}{l} {R_{0} =\frac{z_{0m} u_{*} }{\nu } ,} \\ {z_{0h} =z_{0q} =z_{0m} \exp \left\{-0.13R_{0} ^{0.45} \right\}} \end{array}"/></p>
</div><p>where <img class="math" src="../../_images/math/0de9c100e7dfa3c431e6aead57d39b68c862fb26.png" alt="R_{0}"/> is the near-surface atmospheric roughness
Reynolds number, <img class="math" src="../../_images/math/5664af9bf4aba357b95e1d86be4b07bd5c6f4fca.png" alt="z_{0h}"/> is the roughness
length for sensible heat,  <img class="math" src="../../_images/math/d7809302d9ae530b67ffbc04fec671fe6cd383f1.png" alt="z_{0q}"/> is the
roughness length for latent heat, <img class="math" src="../../_images/math/ca3b8fa4180eee2dfc3af9d13fae1da451cd2c31.png" alt="\nu"/> (m<sup>2</sup> s<sup>-1</sup>) is the kinematic viscosity of air, and
<img class="math" src="../../_images/math/10e1fc078e5283ca0b2c98f3cd5c3a87e06e7bab.png" alt="u_{\*}"/>  (m s<sup>-1</sup>) is the friction velocity in the
atmospheric surface layer. For frozen lakes without resolved snow
layers, <img class="math" src="../../_images/math/166dd310a5fa7395dd8554d81cce2d0e25657154.png" alt="z_{0m} =1\times 10^{-3} {\rm m}"/> (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#subinetal2012a"><span class="std std-ref">Subin et al. (2012a)</span></a>),
and the scalar roughness lengths are given by .</p>
<p>For unfrozen lakes, <em>z</em><sub>0m</sub> is given by (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#subinetal2012a"><span class="std std-ref">Subin et al. (2012a)</span></a>)</p>
<div class="math" id="equation-12.4">
<p><span class="eqno">(4)<a class="headerlink" href="#equation-12.4" title="Permalink to this equation">¶</a></span><img src="../../_images/math/67bcf0de91683923bb40e9d0d11791d3efc9c3b0.png" alt="z_{0m} =\max \left(\frac{\alpha \nu }{u_{*} } ,C\frac{u_{*} ^{2} }{g} \right)"/></p>
</div><p>where <img class="math" src="../../_images/math/877d234f4cec6974ce218fc2e975a486a7972dfd.png" alt="\alpha"/> = 0.1, <img class="math" src="../../_images/math/ca3b8fa4180eee2dfc3af9d13fae1da451cd2c31.png" alt="\nu"/> is the kinematic viscosity
of air given below, <em>C</em> is the effective Charnock coefficient given
below, and <em>g</em> is the acceleration of gravity (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.6</span></a>). The kinematic
viscosity is given by</p>
<div class="math" id="equation-12.5">
<p><span class="eqno">(5)<a class="headerlink" href="#equation-12.5" title="Permalink to this equation">¶</a></span><img src="../../_images/math/f316ba5a03def1243062528bfcfd086f5656c940.png" alt="\nu =\nu _{0} \left(\frac{T_{g} }{T_{0} } \right)^{1.5} \frac{P_{0} }{P_{ref} }"/></p>
</div><p>where
<img class="math" src="../../_images/math/d84ea6f1ea9eac082b4d4c14b4faf2121446f24b.png" alt="\nu _{0} =1.51\times 10^{-5} {\textstyle\frac{{\rm m}^{{\rm 2}} }{{\rm s}}}"/>
, <img class="math" src="../../_images/math/d392a17778051c2ee2aad6a7fcc694a9a07e02cf.png" alt="T_{0} ={\rm 293.15\; K}"/>,
<img class="math" src="../../_images/math/9c19954b0daeff3ee1e031c6d3408cb1f023fa47.png" alt="P_{0} =1.013\times 10^{5} {\rm \; Pa}"/> , and
<img class="math" src="../../_images/math/1a83a22b1208e59fa42309aa888b929f11fa9e19.png" alt="P_{ref}"/> is the pressure at the atmospheric reference
height. The Charnock coefficient <em>C</em> is a function of the lake fetch <em>F</em>
(m), given in the surface data or set to 25 times the lake depth <em>d</em> by
default:</p>
<div class="math" id="equation-12.6">
<p><span class="eqno">(6)<a class="headerlink" href="#equation-12.6" title="Permalink to this equation">¶</a></span><img src="../../_images/math/0b30150c0ece32fa0cd01d5b4d5ed6b53389b23c.png" alt="\begin{array}{l} {C=C_{\min } +(C_{\max } -C_{\min } )\exp \left\{-\min \left(A,B\right)\right\}} \\ {A={\left(\frac{Fg}{u_{\*} ^{2} } \right)^{{1\mathord{\left/ {\vphantom {1 3}} \right. \kern-\nulldelimiterspace} 3} } \mathord{\left/ {\vphantom {\left(\frac{Fg}{u_{\*} ^{2} } \right)^{{1\mathord{\left/ {\vphantom {1 3}} \right. \kern-\nulldelimiterspace} 3} }  f_{c} }} \right. \kern-\nulldelimiterspace} f_{c} } } \\ {B=\varepsilon \frac{\sqrt{dg} }{u} } \end{array}"/></p>
</div><p>where <em>A</em> and <em>B</em> define the fetch- and depth-limitation, respectively;
<img class="math" src="../../_images/math/459a8661fa5f13b9f9c486484146db6a46a3ff69.png" alt="C_{\min } =0.01"/> , <img class="math" src="../../_images/math/b216e2bd01705eec09e03214040b98bd563fbbdf.png" alt="C_{\max } =0.01"/>,
<img class="math" src="../../_images/math/6bb2397db7909e7748ba7b140a5cb0a6fb76e9b1.png" alt="\varepsilon =1"/> , <img class="math" src="../../_images/math/09f971c8f878bae578658efe92ad0f260e2cceed.png" alt="f_{c} =100"/> , and <em>u</em> (m
s<sup>-1</sup>) is the atmospheric forcing wind.</p>
</div>
<div class="section" id="surface-flux-solution">
<span id="surface-flux-solution-lake"></span><h3>12.4.2. Surface Flux Solution<a class="headerlink" href="#surface-flux-solution" title="Permalink to this headline">¶</a></h3>
<p>Conservation of energy at the lake surface requires</p>
<div class="math" id="equation-12.7">
<p><span class="eqno">(7)<a class="headerlink" href="#equation-12.7" title="Permalink to this equation">¶</a></span><img src="../../_images/math/062ff2a045a36094acc7c385eb43b1ab05ea20ab.png" alt="\beta \vec{S}_{g} -\vec{L}_{g} -H_{g} -\lambda E_{g} -G=0"/></p>
</div><p>where <img class="math" src="../../_images/math/9a1bdb88f6a92871c044b411ca8581aeab89741a.png" alt="\vec{S}_{g}"/> is the absorbed solar radiation in the lake,
<img class="math" src="../../_images/math/410a9d0df9c135dd73b269cba7ef04dcfd932b1f.png" alt="\beta"/> is the fraction absorbed at the surface,
<img class="math" src="../../_images/math/19e4fcc9abd0e48090e0f261c83f4786e90203cc.png" alt="\vec{L}_{g}"/> is the net emitted longwave radiation (+ upwards),
<img class="math" src="../../_images/math/300c104b366ac58e868e172c492bebdba1c12e30.png" alt="H_{g}"/> is the sensible heat flux (+ upwards),
<img class="math" src="../../_images/math/8525155a3a4fea88abbafe102ddbd2fb5b6867e5.png" alt="E_{g}"/> is the water vapor flux (+ upwards), and <em>G</em> is the
ground heat flux (+ downwards). All of these fluxes depend implicitly on
the temperature at the lake surface <img class="math" src="../../_images/math/3dc5da767342c6f5c337cad15fd295401e5f5324.png" alt="{T}_{g}"/>.
<img class="math" src="../../_images/math/76f1d8ace30435987c01a00ca53a71cba1f40e6c.png" alt="\lambda"/>  converts <img class="math" src="../../_images/math/8525155a3a4fea88abbafe102ddbd2fb5b6867e5.png" alt="E_{g}"/>  to an energy flux based on</p>
<div class="math" id="equation-12.8">
<p><span class="eqno">(8)<a class="headerlink" href="#equation-12.8" title="Permalink to this equation">¶</a></span><img src="../../_images/math/198ea14f3cc39eab24e8f355b56edf56f085916b.png" alt="\lambda =\left\{\begin{array}{l} {\lambda _{sub} \qquad T_{g} \le T_{f} } \\ {\lambda _{vap} \qquad T_{g} &gt;T_{f} } \end{array}\right\}."/></p>
</div><p>The sensible heat flux (W m<sup>-2</sup>) is</p>
<div class="math" id="equation-12.9">
<p><span class="eqno">(9)<a class="headerlink" href="#equation-12.9" title="Permalink to this equation">¶</a></span><img src="../../_images/math/830a2b90ae9bd55d1e9bfac23fb7ff577674f6e3.png" alt="H_{g} =-\rho _{atm} C_{p} \frac{\left(\theta _{atm} -T_{g} \right)}{r_{ah} }"/></p>
</div><p>where <img class="math" src="../../_images/math/488d242d2c249cf5bf3182b58bbcc9ead040b82c.png" alt="\rho _{atm}"/>  is the density of moist air (kg
m<sup>-3</sup>) (Chapter <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#rst-momentum-sensible-heat-and-latent-heat-fluxes"><span class="std std-numref">5</span></a>), <img class="math" src="../../_images/math/db86e3dd888fe93465a17ab80876d9bfc5d5f2a0.png" alt="C_{p}"/>  is the specific heat
capacity of air (J kg<sup>-1</sup> K<sup>-1</sup>) (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.6</span></a>),
<img class="math" src="../../_images/math/906178b0bee16df0e6217d4336b94f054cefaf04.png" alt="\theta _{atm}"/>  is the atmospheric potential temperature (K)
(Chapter <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#rst-momentum-sensible-heat-and-latent-heat-fluxes"><span class="std std-numref">5</span></a>), <img class="math" src="../../_images/math/04eb83d8d8a3d4bded815024e685288439cff3b6.png" alt="T_{g}"/>  is the lake surface temperature (K) (at an
infinitesimal interface just above the top resolved model layer: snow,
ice, or water), and <img class="math" src="../../_images/math/46656df1217677ced4bee59fa86bfae6a1db5d35.png" alt="r_{ah}"/>  is the aerodynamic resistance to
sensible heat transfer (s m<sup>-1</sup>) (section <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#monin-obukhov-similarity-theory"><span class="std std-numref">5.1</span></a>).</p>
<p>The water vapor flux (kg m<sup>-2</sup> s<sup>-1</sup>) is</p>
<div class="math" id="equation-12.10">
<p><span class="eqno">(10)<a class="headerlink" href="#equation-12.10" title="Permalink to this equation">¶</a></span><img src="../../_images/math/25bb0933f910b136ccdbdd1b78b7e0122cd1606e.png" alt="E_{g} =-\frac{\rho _{atm} \left(q_{atm} -q_{sat}^{T_{g} } \right)}{r_{aw} }"/></p>
</div><p>where <img class="math" src="../../_images/math/a54750e213d3b891fa2093cc89a7ca6e16f28111.png" alt="q_{atm}"/>  is the atmospheric specific humidity (kg
kg<sup>-1</sup>) (section <a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#atmospheric-coupling"><span class="std std-numref">2.3.1</span></a>),
<img class="math" src="../../_images/math/b1bd404709e85a841c8920f644b622bd3add48cd.png" alt="q_{sat}^{T_{g} }"/> is the saturated specific humidity
(kg kg<sup>-1</sup>) (section <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#saturation-vapor-pressure"><span class="std std-numref">5.5</span></a>) at
the lake surface temperature <img class="math" src="../../_images/math/04eb83d8d8a3d4bded815024e685288439cff3b6.png" alt="T_{g}"/> , and <img class="math" src="../../_images/math/c5090d921ba3611d8352e988e98ec22c002fcce1.png" alt="r_{aw}"/>  is the
aerodynamic resistance to water vapor transfer (s m<sup>-1</sup>)
(section <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#monin-obukhov-similarity-theory"><span class="std std-numref">5.1</span></a>).</p>
<p>The zonal and meridional momentum fluxes are</p>
<div class="math" id="equation-12.11">
<p><span class="eqno">(11)<a class="headerlink" href="#equation-12.11" title="Permalink to this equation">¶</a></span><img src="../../_images/math/bfdf8c82f07bfad1aa40fd8c011c2e0053a9bbb3.png" alt="\tau _{x} =-\rho _{atm} \frac{u_{atm} }{r_{atm} }"/></p>
</div><div class="math" id="equation-12.12">
<p><span class="eqno">(12)<a class="headerlink" href="#equation-12.12" title="Permalink to this equation">¶</a></span><img src="../../_images/math/782a0e8ea2f159745c0c5f05344a5f73c0b0595f.png" alt="\tau _{y} =-\rho _{atm} \frac{v_{atm} }{r_{atm} }"/></p>
</div><p>where <img class="math" src="../../_images/math/9ffcba9696377c29c7ae3732d5549a459247f5c8.png" alt="u_{atm}"/>  and <img class="math" src="../../_images/math/ece928846883442ecb9fa4ee5289c165209828dd.png" alt="v_{atm}"/>  are the zonal and
meridional atmospheric winds (m s<sup>-1</sup>) (section
<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#atmospheric-coupling"><span class="std std-numref">2.3.1</span></a>), and
<img class="math" src="../../_images/math/7c953667333686f584c3ae983e6bf27771451095.png" alt="r_{am}"/>  is the aerodynamic resistance for momentum (s
m<sup>-1</sup>) (section <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#monin-obukhov-similarity-theory"><span class="std std-numref">5.1</span></a>).</p>
<p>The heat flux into the lake surface <img class="math" src="../../_images/math/dee63237674afc3154c2e33b7b68d67f85f2ee0a.png" alt="G"/> (W m<sup>-2</sup>) is</p>
<div class="math" id="equation-12.13">
<p><span class="eqno">(13)<a class="headerlink" href="#equation-12.13" title="Permalink to this equation">¶</a></span><img src="../../_images/math/40fd4fdecf949f5858c75c011d3e7ec6088d9ad2.png" alt="G=\frac{2\lambda _{T} }{\Delta z_{T} } \left(T_{g} -T_{T} \right)"/></p>
</div><p>where <img class="math" src="../../_images/math/30c00ac5607819b1104711bc421dc2132ff277cc.png" alt="\lambda _{T}"/>  is the thermal conductivity (W
m<sup>-1</sup> K<sup>-1</sup>), <img class="math" src="../../_images/math/689431b034809de8e45c6adf861647cf5e39cfdd.png" alt="\Delta z_{T}"/>  is the
thickness (m), and <img class="math" src="../../_images/math/0ca014498e74ce11bd86bb373520dee650febcbe.png" alt="T_{T}"/>  is the temperature (K) of the top
resolved lake layer (snow, ice, or water). The top thermal conductivity
<img class="math" src="../../_images/math/30c00ac5607819b1104711bc421dc2132ff277cc.png" alt="\lambda _{T}"/>  of unfrozen lakes ( <img class="math" src="../../_images/math/8da24025b5910b9efaa75906bfa6001bc6c7cf9c.png" alt="T_{g} &gt;T_{f}"/> )
includes conductivities due to molecular ( <img class="math" src="../../_images/math/aec81c0cab3354859546d5e95ccf6413f0f536e7.png" alt="\lambda _{liq}"/> ) and
eddy (<img class="math" src="../../_images/math/34711129c4e46c8b3362f0bfa17fb0349c010318.png" alt="\lambda _{K}"/> ) diffusivities (section <a class="reference internal" href="#eddy-diffusivity-and-thermal-conductivities"><span class="std std-numref">12.5.4</span></a>), as evaluated
in the top lake layer at the previous timestep, where
<img class="math" src="../../_images/math/aec81c0cab3354859546d5e95ccf6413f0f536e7.png" alt="\lambda _{liq}"/>  is the thermal conductivity of water (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.6</span></a>). For frozen lakes without resolved snow layers,
<img class="math" src="../../_images/math/6b2f37ee85a69093edaea7a9348946fd89535a85.png" alt="\lambda _{T} =\lambda _{ice}"/>  . When resolved snow layers are
present, <img class="math" src="../../_images/math/30c00ac5607819b1104711bc421dc2132ff277cc.png" alt="\lambda _{T}"/> is calculated based on the water
content, ice content, and thickness of the top snow layer, as for
non-vegetated surfaces.</p>
<p>The absorbed solar radiation <img class="math" src="../../_images/math/9a1bdb88f6a92871c044b411ca8581aeab89741a.png" alt="\vec{S}_{g}"/>  is</p>
<div class="math" id="equation-12.14">
<p><span class="eqno">(14)<a class="headerlink" href="#equation-12.14" title="Permalink to this equation">¶</a></span><img src="../../_images/math/b38d40d6132b871d0feba2a0ef00c322859d6122.png" alt="\vec{S}_{g} =\sum _{\Lambda }S_{atm} \, \downarrow _{\Lambda }^{\mu } \left(1-\alpha _{g,\, \Lambda }^{\mu } \right) +S_{atm} \, \downarrow _{\Lambda } \left(1-\alpha _{g,\, \Lambda } \right)"/></p>
</div><p>where <img class="math" src="../../_images/math/b24a9d29c136a2f32e0b8a6af7e45d2026ebf997.png" alt="S_{atm} \, \downarrow _{\Lambda }^{\mu }"/>  and
<img class="math" src="../../_images/math/1f89e1a41a6bb82d2e8319d4db3dcf396b584c66.png" alt="S_{atm} \, \downarrow _{\Lambda }"/>  are the incident direct beam
and diffuse solar fluxes (W m<sup>-2</sup>) and <img class="math" src="../../_images/math/5b99ed91598429157b547a2c3700a6b25c52824a.png" alt="\Lambda"/>
denotes the visible (<img class="math" src="../../_images/math/863f524a433d6d1e5715f76f12040c654f10d86d.png" alt="&lt;"/> 0.7<img class="math" src="../../_images/math/95311af10ee5d3d8654dc94e99cfcaac84876219.png" alt="\mu {\rm m}"/>) and
near-infrared (<img class="math" src="../../_images/math/744a7e944983312265f2ed7497ddf42da26942a6.png" alt="\ge"/>  0.7<img class="math" src="../../_images/math/95311af10ee5d3d8654dc94e99cfcaac84876219.png" alt="\mu {\rm m}"/>) wavebands (section
<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#atmospheric-coupling"><span class="std std-numref">2.3.1</span></a>), and <img class="math" src="../../_images/math/e6eb8371b2e10a8ab423bd90450690f5b9c5d4a4.png" alt="\alpha _{g,\, \Lambda }^{\mu }"/>  and
<img class="math" src="../../_images/math/36b5a4677d22215995b60ad8ca5f546dc28e9128.png" alt="\alpha _{g,\, \mu }"/>  are the direct beam and diffuse lake
albedos (section <a class="reference internal" href="#surface-albedo-lake"><span class="std std-numref">12.3</span></a>).</p>
<p>The net emitted longwave radiation is</p>
<div class="math" id="equation-12.15">
<p><span class="eqno">(15)<a class="headerlink" href="#equation-12.15" title="Permalink to this equation">¶</a></span><img src="../../_images/math/34b640dc909f07d445432203924ed0fb1aded2b2.png" alt="\vec{L}_{g} =L_{g} \, \uparrow -L_{atm} \, \downarrow"/></p>
</div><p>where <img class="math" src="../../_images/math/2a43dd7c4df5177120843c893505c2a5854428f5.png" alt="L_{g} \, \uparrow"/>  is the upward longwave radiation from
the surface, <img class="math" src="../../_images/math/472a10bc1f860b13e32a7c46d63c467dfa5cfffa.png" alt="L_{atm} \, \downarrow"/>  is the downward atmospheric
longwave radiation (section <a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#atmospheric-coupling"><span class="std std-numref">2.3.1</span></a>). The upward
longwave radiation from the surface is</p>
<div class="math" id="equation-12.16">
<p><span class="eqno">(16)<a class="headerlink" href="#equation-12.16" title="Permalink to this equation">¶</a></span><img src="../../_images/math/680738ca0ddcaa422cfe2a58753357c71275180f.png" alt="L\, \uparrow =\left(1-\varepsilon _{g} \right)L_{atm} \, \downarrow +\varepsilon _{g} \sigma \left(T_{g}^{n} \right)^{4} +4\varepsilon _{g} \sigma \left(T_{g}^{n} \right)^{3} \left(T_{g}^{n+1} -T_{g}^{n} \right)"/></p>
</div><p>where <img class="math" src="../../_images/math/35e46ef128b2e2e73ecd92f22e5a3b6d1b0a69da.png" alt="\varepsilon _{g} =0.97"/> is the lake surface emissivity,
<img class="math" src="../../_images/math/011e5790a6c33043ceadca81d9657dde6c61d769.png" alt="\sigma"/> is the Stefan-Boltzmann constant (W m<sup>-2</sup> K<sup>-4</sup>) (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.6</span></a>), and
<img class="math" src="../../_images/math/d547954f83169909daba53c583e0a713e1198b59.png" alt="T_{g}^{n+1} -T_{g}^{n}"/> is the difference in lake surface
temperature between Newton-Raphson iterations (see below).</p>
<p>The sensible heat <img class="math" src="../../_images/math/300c104b366ac58e868e172c492bebdba1c12e30.png" alt="H_{g}"/> , the water vapor flux <img class="math" src="../../_images/math/8525155a3a4fea88abbafe102ddbd2fb5b6867e5.png" alt="E_{g}"/>
through its dependence on the saturated specific humidity, the net
longwave radiation <img class="math" src="../../_images/math/19e4fcc9abd0e48090e0f261c83f4786e90203cc.png" alt="\vec{L}_{g}"/> , and the ground heat flux
<img class="math" src="../../_images/math/dee63237674afc3154c2e33b7b68d67f85f2ee0a.png" alt="G"/>, all depend on the lake surface temperature <img class="math" src="../../_images/math/04eb83d8d8a3d4bded815024e685288439cff3b6.png" alt="T_{g}"/> .
Newton-Raphson iteration is applied to solve for <img class="math" src="../../_images/math/04eb83d8d8a3d4bded815024e685288439cff3b6.png" alt="T_{g}"/>  and the
surface fluxes as</p>
<div class="math" id="equation-12.17">
<p><span class="eqno">(17)<a class="headerlink" href="#equation-12.17" title="Permalink to this equation">¶</a></span><img src="../../_images/math/9b073b1523101b0080da4827d2dee8709fb9755b.png" alt="\Delta T_{g} =\frac{\beta \overrightarrow{S}_{g} -\overrightarrow{L}_{g} -H_{g} -\lambda E_{g} -G}{\frac{\partial \overrightarrow{L}_{g} }{\partial T_{g} } +\frac{\partial H_{g} }{\partial T_{g} } +\frac{\partial \lambda E_{g} }{\partial T_{g} } +\frac{\partial G}{\partial T_{g} } }"/></p>
</div><p>where <img class="math" src="../../_images/math/fc1508c2ff45d415c6b8cc290dfda3dc1ae81122.png" alt="\Delta T_{g} =T_{g}^{n+1} -T_{g}^{n}"/>  and the subscript
“n” indicates the iteration. Therefore, the surface temperature
<img class="math" src="../../_images/math/a26921b3bfa3a4158e32fc2cf4915c9a7dd86fcb.png" alt="T_{g}^{n+1}"/>  can be written as</p>
<div class="math" id="equation-12.18">
<p><span class="eqno">(18)<a class="headerlink" href="#equation-12.18" title="Permalink to this equation">¶</a></span><img src="../../_images/math/a63107675914e36ebbe52cdf3300b68fbf003fe7.png" alt="T_{g}^{n+1} =\frac{\beta \overrightarrow{S}_{g} -\overrightarrow{L}_{g} -H_{g} -\lambda E_{g} -G+T_{g}^{n} \left(\frac{\partial \overrightarrow{L}_{g} }{\partial T_{g} } +\frac{\partial H_{g} }{\partial T_{g} } +\frac{\partial \lambda E_{g} }{\partial T_{g} } +\frac{\partial G}{\partial T_{g} } \right)}{\frac{\partial \overrightarrow{L}_{g} }{\partial T_{g} } +\frac{\partial H_{g} }{\partial T_{g} } +\frac{\partial \lambda E_{g} }{\partial T_{g} } +\frac{\partial G}{\partial T_{g} } }"/></p>
</div><p>where the partial derivatives are</p>
<div class="math" id="equation-12.19">
<p><span class="eqno">(19)<a class="headerlink" href="#equation-12.19" title="Permalink to this equation">¶</a></span><img src="../../_images/math/96bda2679379b79bd629a771674d6c55147f19f8.png" alt="\frac{\partial \overrightarrow{L}_{g} }{\partial T_{g} } =4\varepsilon _{g} \sigma \left(T_{g}^{n} \right)^{3} ,"/></p>
</div><div class="math" id="equation-12.20">
<p><span class="eqno">(20)<a class="headerlink" href="#equation-12.20" title="Permalink to this equation">¶</a></span><img src="../../_images/math/b909eb92486ccf50524e6b2dac2428ca1e96b5f7.png" alt="\frac{\partial H_{g} }{\partial T_{g} } =\frac{\rho _{atm} C_{p} }{r_{ah} } ,"/></p>
</div><div class="math" id="equation-12.21">
<p><span class="eqno">(21)<a class="headerlink" href="#equation-12.21" title="Permalink to this equation">¶</a></span><img src="../../_images/math/4e51f66c1e8d45689b53b9c7976505b12c02327a.png" alt="\frac{\partial \lambda E_{g} }{\partial T_{g} } =\frac{\lambda \rho _{atm} }{r_{aw} } \frac{dq_{sat}^{T_{g} } }{dT_{g} } ,"/></p>
</div><div class="math" id="equation-12.22">
<p><span class="eqno">(22)<a class="headerlink" href="#equation-12.22" title="Permalink to this equation">¶</a></span><img src="../../_images/math/1f1292b53df868a58383665ee82628006175172b.png" alt="\frac{\partial G}{\partial T_{g} } =\frac{2\lambda _{T} }{\Delta z_{T} } ."/></p>
</div><p>The fluxes of momentum, sensible heat, and water vapor are solved for
simultaneously with lake surface temperature as follows. The
stability-related equations are the same as for non-vegetated surfaces
(section <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#sensible-and-latent-heat-fluxes-for-non-vegetated-surfaces"><span class="std std-numref">5.2</span></a>),
except that the surface roughnesses are here (weakly varying) functions
of the friction velocity <img class="math" src="../../_images/math/10e1fc078e5283ca0b2c98f3cd5c3a87e06e7bab.png" alt="u_{\*}"/> . To begin, <em>z</em><sub>0m</sub> is set
based on the value calculated for the last timestep (for
<img class="math" src="../../_images/math/8da24025b5910b9efaa75906bfa6001bc6c7cf9c.png" alt="T_{g} &gt;T_{f}"/> ) or based on the values in section
<a class="reference internal" href="#surface-properties-lake"><span class="std std-numref">12.4.1</span></a> (otherwise), and the scalar roughness
lengths are set based on the relationships in section <a class="reference internal" href="#surface-properties-lake"><span class="std std-numref">12.4.1</span></a>.</p>
<ol class="arabic">
<li><p class="first">An initial guess for the wind speed <img class="math" src="../../_images/math/c58d24f1cd15b29c4e1c238b79987d16cb8a3308.png" alt="V_{a}"/>  including the
convective velocity <img class="math" src="../../_images/math/e496f368cc6ec4cad64b89010ef8570c02f025a7.png" alt="U_{c}"/>  is obtained from <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.24">(24)</a> assuming an
initial convective velocity <img class="math" src="../../_images/math/246e42b203c3df8d2694c2ae0fa5664b1d3f0b78.png" alt="U_{c} =0"/> m s<sup>-1</sup> for
stable conditions (<img class="math" src="../../_images/math/a7337208e0138558d7be0f3d3e956c788f21d1e0.png" alt="\theta _{v,\, atm} -\theta _{v,\, s} \ge 0"/>
as evaluated from <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.50">(50)</a>) and <img class="math" src="../../_images/math/9bd02b7abb7f5be6dc22cef4fc93a23f8bf37352.png" alt="U_{c} =0.5"/> for unstable
conditions (<img class="math" src="../../_images/math/75601d905c29ab56cf14710beac4d1b7005c40ec.png" alt="\theta _{v,\, atm} -\theta _{v,\, s} &lt;0"/>).</p>
</li>
<li><p class="first">An initial guess for the Monin-Obukhov length <img class="math" src="../../_images/math/ae2b750f71e1fc0daaa3de9a85d42794d7cd1326.png" alt="L"/> is obtained
from the bulk Richardson number using <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.46">(46)</a> and <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.48">(48)</a>.</p>
</li>
<li><p class="first">The following system of equations is iterated four times:</p>
</li>
<li><p class="first">Heat of vaporization / sublimation <img class="math" src="../../_images/math/76f1d8ace30435987c01a00ca53a71cba1f40e6c.png" alt="\lambda"/> (<a class="reference internal" href="#equation-12.8">(8)</a>)</p>
</li>
<li><p class="first">Thermal conductivity <img class="math" src="../../_images/math/30c00ac5607819b1104711bc421dc2132ff277cc.png" alt="\lambda _{T}"/> (above)</p>
</li>
<li><p class="first">Friction velocity <img class="math" src="../../_images/math/10e1fc078e5283ca0b2c98f3cd5c3a87e06e7bab.png" alt="u_{\*}"/>  (<a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.32">(32)</a>, <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.33">(33)</a>, <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.34">(34)</a>, <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.35">(35)</a>)</p>
</li>
<li><p class="first">Potential temperature scale <img class="math" src="../../_images/math/d15e230f5fbbd8f5b5f793ea8fc31a0c09b90293.png" alt="\theta _{\*}"/>  (<a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.37">(37)</a> , <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.38">(38)</a>, <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.39">(39)</a>, <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.40">(40)</a>)</p>
</li>
<li><p class="first">Humidity scale <img class="math" src="../../_images/math/fff2f6ed111fb99c9acb2a517b12c4d13368150a.png" alt="q_{\*}"/>  (<a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.41">(41)</a>, <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.42">(42)</a>, <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.43">(43)</a>, <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.44">(44)</a>)</p>
</li>
<li><p class="first">Aerodynamic resistances <img class="math" src="../../_images/math/7c953667333686f584c3ae983e6bf27771451095.png" alt="r_{am}"/> , <img class="math" src="../../_images/math/46656df1217677ced4bee59fa86bfae6a1db5d35.png" alt="r_{ah}"/> , and
<img class="math" src="../../_images/math/c5090d921ba3611d8352e988e98ec22c002fcce1.png" alt="r_{aw}"/>  (<a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.55">(55)</a>, <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.56">(56)</a>, <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.57">(57)</a>)</p>
</li>
<li><p class="first">Lake surface temperature <img class="math" src="../../_images/math/a26921b3bfa3a4158e32fc2cf4915c9a7dd86fcb.png" alt="T_{g}^{n+1}"/>  (<a class="reference internal" href="#equation-12.18">(18)</a>)</p>
</li>
<li><p class="first">Heat of vaporization / sublimation <img class="math" src="../../_images/math/76f1d8ace30435987c01a00ca53a71cba1f40e6c.png" alt="\lambda"/>  (<a class="reference internal" href="#equation-12.8">(8)</a>)</p>
</li>
<li><p class="first">Sensible heat flux <img class="math" src="../../_images/math/300c104b366ac58e868e172c492bebdba1c12e30.png" alt="H_{g}"/>  is updated for <img class="math" src="../../_images/math/a26921b3bfa3a4158e32fc2cf4915c9a7dd86fcb.png" alt="T_{g}^{n+1}"/>
(<a class="reference internal" href="#equation-12.9">(9)</a>)</p>
</li>
<li><p class="first">Water vapor flux <img class="math" src="../../_images/math/8525155a3a4fea88abbafe102ddbd2fb5b6867e5.png" alt="E_{g}"/>  is updated for <img class="math" src="../../_images/math/a26921b3bfa3a4158e32fc2cf4915c9a7dd86fcb.png" alt="T_{g}^{n+1}"/>
as</p>
<div class="math" id="equation-12.23">
<p><span class="eqno">(23)<a class="headerlink" href="#equation-12.23" title="Permalink to this equation">¶</a></span><img src="../../_images/math/fef50a5b8d971951fb7b858b6f6e08410ccca08e.png" alt="E_{g} =-\frac{\rho _{atm} }{r_{aw} } \left[q_{atm} -q_{sat}^{T_{g} } -\frac{\partial q_{sat}^{T_{g} } }{\partial T_{g} } \left(T_{g}^{n+1} -T_{g}^{n} \right)\right]"/></p>
</div></li>
</ol>
<p>where the last term on the right side of equation is the change in
saturated specific humidity due to the change in <img class="math" src="../../_images/math/04eb83d8d8a3d4bded815024e685288439cff3b6.png" alt="T_{g}"/>  between
iterations.</p>
<ol class="arabic simple">
<li>Saturated specific humidity <img class="math" src="../../_images/math/b1bd404709e85a841c8920f644b622bd3add48cd.png" alt="q_{sat}^{T_{g} }"/>  and its
derivative <img class="math" src="../../_images/math/9adc4fc02f0ad5109418b72a533194f55fdb892d.png" alt="\frac{dq_{sat}^{T_{g} } }{dT_{g} }"/>  are updated
for <img class="math" src="../../_images/math/a26921b3bfa3a4158e32fc2cf4915c9a7dd86fcb.png" alt="T_{g}^{n+1}"/>  (section <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#monin-obukhov-similarity-theory"><span class="std std-numref">5.1</span></a>).</li>
<li>Virtual potential temperature scale <img class="math" src="../../_images/math/41eb2a2b18e3fa3defd052d64c1a399912cf19d2.png" alt="\theta _{v\*}"/>  (<a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.17">(17)</a>)</li>
<li>Wind speed including the convective velocity, <img class="math" src="../../_images/math/c58d24f1cd15b29c4e1c238b79987d16cb8a3308.png" alt="V_{a}"/>  (<a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.24">(24)</a>)</li>
<li>Monin-Obukhov length <img class="math" src="../../_images/math/ae2b750f71e1fc0daaa3de9a85d42794d7cd1326.png" alt="L"/> (<a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#equation-5.49">(49)</a>)</li>
<li>Roughness lengths (<a class="reference internal" href="#equation-12.3">(3)</a>, <a class="reference internal" href="#equation-12.4">(4)</a>).</li>
</ol>
<p>Once the four iterations for lake surface temperature have been yielded
a tentative solution <img class="math" src="../../_images/math/0f67182fa56a2a817b5ea910b9c07a2ba44d3d25.png" alt="T_{g} ^{{'} }"/> , several restrictions
are imposed in order to maintain consistency with the top lake model
layer temperature <img class="math" src="../../_images/math/0ca014498e74ce11bd86bb373520dee650febcbe.png" alt="T_{T}"/> (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#subinetal2012a"><span class="std std-ref">Subin et al. (2012a)</span></a>).</p>
<div class="math" id="equation-12.24">
<p><span class="eqno">(24)<a class="headerlink" href="#equation-12.24" title="Permalink to this equation">¶</a></span><img src="../../_images/math/e6a048889718bfee799e4bc0c4e8613330d4400f.png" alt="\begin{array}{l} {{\rm 1)\; }T_{T} \le T_{f} &lt;T_{g} ^{{'} } \Rightarrow T_{g} =T_{f} ,} \\ {{\rm 2)\; }T_{T} &gt;T_{g} ^{{'} } &gt;T_{m} \Rightarrow T_{g} =T_{T} ,} \\ {{\rm 3)\; }T_{m} &gt;T_{g} ^{{'} } &gt;T_{T} &gt;T_{f} \Rightarrow T_{g} =T_{T} } \end{array}"/></p>
</div><p>where <img class="math" src="../../_images/math/ed2777deb5ba863453fd8d6350f95b5d7186bbb3.png" alt="T_{m}"/> is the temperature of maximum liquid water
density, 3.85<sup>o</sup> C (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#hostetlerbartlein1990"><span class="std std-ref">Hostetler and Bartlein (1990)</span></a>). The
first condition requires that, if there is any snow or ice present, the
surface temperature is restricted to be less than or equal to freezing.
The second and third conditions maintain convective stability in the top
lake layer.</p>
<p>If eq. XXX is applied, the turbulent fluxes <img class="math" src="../../_images/math/300c104b366ac58e868e172c492bebdba1c12e30.png" alt="H_{g}"/> and
<img class="math" src="../../_images/math/8525155a3a4fea88abbafe102ddbd2fb5b6867e5.png" alt="E_{g}"/> are re-evaluated. The emitted longwave radiation and
the momentum fluxes are re-evaluated in any case. The final ground heat
flux <img class="math" src="../../_images/math/dee63237674afc3154c2e33b7b68d67f85f2ee0a.png" alt="G"/> is calculated from the residual of the energy balance eq.
XXX in order to precisely conserve energy. XXX This ground heat flux
is taken as a prescribed flux boundary condition for the lake
temperature solution (section <a class="reference internal" href="#boundary-conditions-lake"><span class="std std-numref">12.5.3</span></a>).
An energy balance check is
included at each timestep to insure that eq. XXX is obeyed to within
0.1 W m<sup>-2</sup>.</p>
</div>
</div>
<div class="section" id="lake-temperature">
<span id="id1"></span><h2>12.5. Lake Temperature<a class="headerlink" href="#lake-temperature" title="Permalink to this headline">¶</a></h2>
<div class="section" id="introduction">
<span id="introduction-lake"></span><h3>12.5.1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h3>
<p>The (optional-) snow, lake body (water and/or ice), soil, and bedrock
system is unified for the lake temperature solution. The governing
equation, similar to that for the snow-soil-bedrock system for vegetated
land units (Chapter <a class="reference internal" href="../Soil_Snow_Temperatures/CLM50_Tech_Note_Soil_Snow_Temperatures.html#rst-soil-and-snow-temperatures"><span class="std std-numref">6</span></a>), is</p>
<div class="math" id="equation-12.25">
<p><span class="eqno">(25)<a class="headerlink" href="#equation-12.25" title="Permalink to this equation">¶</a></span><img src="../../_images/math/ab11b465698187a9509c74882783ef7b34a2454e.png" alt="\tilde{c}_{v} \frac{\partial T}{\partial t} =\frac{\partial }{\partial z} \left(\tau \frac{\partial T}{\partial z} \right)-\frac{d\phi }{dz}"/></p>
</div><p>where <img class="math" src="../../_images/math/9f76fa7a9bc4161d374a8bfa8e1f37c5ed770649.png" alt="\tilde{c}_{v}"/>  is the volumetric heat capacity (J
m<sup>-3</sup> K<sup>-1</sup>), <img class="math" src="../../_images/math/5ec053cf70dc1c98cc297322250569eda193e7a4.png" alt="t"/> is time (s), <em>T</em> is
the temperature (K), <img class="math" src="../../_images/math/557d5fad862c9046d26e1a930f45a550c146d592.png" alt="\tau"/> is the thermal conductivity (W
m<sup>-1</sup> K<sup>-1</sup>), and <img class="math" src="../../_images/math/c2f31c22645274c375eff7920cfdfdc18d60341f.png" alt="\phi"/> is the solar
radiation (W m<sup>-2</sup>) penetrating to depth <em>z</em> (m). The
system is discretized into <em>N</em> layers, where</p>
<div class="math" id="equation-12.26">
<p><span class="eqno">(26)<a class="headerlink" href="#equation-12.26" title="Permalink to this equation">¶</a></span><img src="../../_images/math/98f87d106f47d258366aa85d91401bb51e6a469c.png" alt="N=n_{sno} +N_{levlak} +N_{levgrnd}  ,"/></p>
</div><p><img class="math" src="../../_images/math/f2bb7cad3b1e05a9961411675fb651d6ecce46e3.png" alt="n_{sno}"/>  is the number of actively modeled snow layers at the
current timestep (Chapter <a class="reference internal" href="../Snow_Hydrology/CLM50_Tech_Note_Snow_Hydrology.html#rst-snow-hydrology"><span class="std std-numref">8</span></a>), and
<img class="math" src="../../_images/math/13436989cbd3b0612f9f0ee081374e01da5780de.png" alt="N_{levgrnd}"/> is as for vegetated land units (Chapter
<a class="reference internal" href="../Soil_Snow_Temperatures/CLM50_Tech_Note_Soil_Snow_Temperatures.html#rst-soil-and-snow-temperatures"><span class="std std-numref">6</span></a>). Energy is conserved as</p>
<div class="math" id="equation-12.27">
<p><span class="eqno">(27)<a class="headerlink" href="#equation-12.27" title="Permalink to this equation">¶</a></span><img src="../../_images/math/720567d3e15c66a4913b404197883d3730c60533.png" alt="\frac{d}{dt} \sum _{j=1}^{N}\left[\tilde{c}_{v,j} (t)\left(T_{j} -T_{f} \right)+L_{j} (t)\right] \Delta z_{j} =G+\left(1-\beta \right)\vec{S}_{g}"/></p>
</div><p>where <img class="math" src="../../_images/math/59202a6338d8bbc1530a1ac23ac365091269f38a.png" alt="\tilde{c}_{v,j} (t)"/>is the volumetric heat capacity of
the <em>j</em>th layer (section <a class="reference internal" href="#radiation-penetration"><span class="std std-numref">12.5.5</span></a>),
<img class="math" src="../../_images/math/0d5df6f05c7617f1d69e1d4ac65311fb1d3f2756.png" alt="L_{j} (t)"/>is the latent heat
of fusion per unit volume of the <em>j</em>th layer (proportional to the mass
of liquid water present), and the right-hand side represents the net
influx of energy to the lake system. Note that
<img class="math" src="../../_images/math/59202a6338d8bbc1530a1ac23ac365091269f38a.png" alt="\tilde{c}_{v,j} (t)"/> can only change due to phase change (except
for changing snow layer mass, which, apart from energy required to melt
snow, represents an untracked energy flux in the land model, along with
advected energy associated with water flows in general), and this is
restricted to occur at <img class="math" src="../../_images/math/4494e175c1d4995be2b7aba96f18037245d80efb.png" alt="T_{j} =T_{f}"/> in the snow-lake-soil
system, allowing eq. to be precisely enforced and justifying the
exclusion of <img class="math" src="../../_images/math/99b76dd7781c5454226f49124d99685f979d53e3.png" alt="c_{v,j}"/>  from the time derivative in eq. .</p>
</div>
<div class="section" id="overview-of-changes-from-clm4">
<span id="overview-of-changes-from-clm4-2"></span><h3>12.5.2. Overview of Changes from CLM4<a class="headerlink" href="#overview-of-changes-from-clm4" title="Permalink to this headline">¶</a></h3>
<p>Thermal conductivities include additional eddy diffusivity, beyond the
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#hostetlerbartlein1990"><span class="std std-ref">Hostetler and Bartlein (1990)</span></a> formulation,
due to unresolved processes (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#fangstefan1996"><span class="std std-ref">Fang and Stefan 1996</span></a>;
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#subinetal2012a"><span class="std std-ref">Subin et al. (2012a)</span></a>). Lake water is now allowed to
freeze by an arbitrary fraction for each layer, which releases latent
heat and changes thermal properties. Convective mixing occurs for all
lakes, even if frozen. Soil and bedrock are included beneath the lake.
The full snow model is used if the snow thickness exceeds a threshold;
if there are resolved snow layers, radiation transfer is predicted by
the snow-optics submodel (Chapter <a class="reference internal" href="../Surface_Albedos/CLM50_Tech_Note_Surface_Albedos.html#rst-surface-albedos"><span class="std std-numref">3</span></a>), and the remaining radiation
penetrating the bottom snow layer is absorbed in the top layer of lake
ice; conversely, if there are no snow layers, the solar radiation
penetrating the bottom lake layer is absorbed in the top soil layer. The
lakes have variable depth, and all physics is assumed valid for
arbitrary depth, except for a depth-dependent enhanced mixing (section
<a class="reference internal" href="#eddy-diffusivity-and-thermal-conductivities"><span class="std std-numref">12.5.4</span></a>). Finally, a previous sign error in the calculation of eddy
diffusivity (specifically, the Brunt-Väisälä frequency term; eq. ) was
corrected.</p>
</div>
<div class="section" id="boundary-conditions">
<span id="boundary-conditions-lake"></span><h3>12.5.3. Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>The top boundary condition, imposed at the top modeled layer
<img class="math" src="../../_images/math/bb876b1424e414a58c1000b9e4ce5dabc1480eef.png" alt="i=j_{top}"/>  , where <img class="math" src="../../_images/math/9318f151818a1b96004ea54534bf516cbcaed79a.png" alt="j_{top} =-n_{sno} +1"/>, is the downwards
surface flux <em>G</em> defined by the energy flux residual during the surface
temperature solution (section <a class="reference internal" href="#boundary-conditions-lake"><span class="std std-numref">12.5.3</span></a>). The bottom
boundary condition, imposed at <img class="math" src="../../_images/math/276078fe1ab3fb41d6c8fa0b3a04bbf22c8dd687.png" alt="i=N_{levlak} +N_{levgrnd}"/>  , is zero flux.
The 2-m windspeed <img class="math" src="../../_images/math/d51a172fa86fb07cd09b4989597acf606ed231b0.png" alt="u_{2}"/> (m s<sup>-1</sup>) is used in the
calculation of eddy diffusivity:</p>
<div class="math" id="equation-12.28">
<p><span class="eqno">(28)<a class="headerlink" href="#equation-12.28" title="Permalink to this equation">¶</a></span><img src="../../_images/math/fe58fac7686cd97a8b269abd2bc472846e47d012.png" alt="u_{2} =\frac{u_{*} }{k} \ln \left(\frac{2}{z_{0m} } \right)\ge 0.1."/></p>
</div><p>where <img class="math" src="../../_images/math/0d674e7d8fec40bf9a08eea2a7f1f4a389c27959.png" alt="u_{*}"/> is the friction velocity calculated in section
<a class="reference internal" href="#boundary-conditions-lake"><span class="std std-numref">12.5.3</span></a> and <em>k</em> is the von Karman constant
(<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.6</span></a>).</p>
</div>
<div class="section" id="eddy-diffusivity-and-thermal-conductivities">
<span id="id2"></span><h3>12.5.4. Eddy Diffusivity and Thermal Conductivities<a class="headerlink" href="#eddy-diffusivity-and-thermal-conductivities" title="Permalink to this headline">¶</a></h3>
<p>The total eddy diffusivity <img class="math" src="../../_images/math/ffabc3734bd598b6d300e3cd945da54168045a52.png" alt="K_{W}"/>  (m<sup>2</sup> s<sup>-1</sup>) for liquid water in the lake body is given by (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#subinetal2012a"><span class="std std-ref">Subin et al. (2012a)</span></a>)</p>
<div class="math" id="equation-12.29">
<p><span class="eqno">(29)<a class="headerlink" href="#equation-12.29" title="Permalink to this equation">¶</a></span><img src="../../_images/math/ace84cead7bd83b2f4e1f99104de18e653c48d79.png" alt="K_{W} = m_{d} \left(\kappa _{e} +K_{ed} +\kappa _{m} \right)"/></p>
</div><p>where <img class="math" src="../../_images/math/d91a5db1c75c2be96ad521549eb8d5f448b46711.png" alt="\kappa _{e}"/>  is due to wind-driven eddies
(<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#hostetlerbartlein1990"><span class="std std-ref">Hostetler and Bartlein (1990)</span></a>),
<img class="math" src="../../_images/math/f3215dd25a414b144e1b2e8745098157f4781caf.png" alt="K_{ed}"/>  is a modest enhanced diffusivity
intended to represent unresolved mixing processes
(<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#fangstefan1996"><span class="std std-ref">Fang and Stefan 1996</span></a>),
<img class="math" src="../../_images/math/8c74b491a60001aaf3419b70f8b2e8207ece8a02.png" alt="\kappa _{m} =\frac{\lambda _{liq} }{c_{liq} \rho _{liq} }"/> is
the molecular diffusivity of water (given by the ratio of its thermal
conductivity (W m<sup>-1</sup> K<sup>-1</sup>) to the product of
its heat capacity (J kg<sup>-1</sup> K<sup>-1</sup>) and density
(kg m<sup>-3</sup>), values given in <a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.6</span></a>), and <img class="math" src="../../_images/math/c94f28a7282886ecce809306dc22f0ec830ec956.png" alt="m_{d}"/>
(unitless) is a factor which increases the overall diffusivity for large
lakes, intended to represent 3-dimensional mixing processes such as
caused by horizontal temperature gradients. As currently implemented,</p>
<div class="math" id="equation-12.30">
<p><span class="eqno">(30)<a class="headerlink" href="#equation-12.30" title="Permalink to this equation">¶</a></span><img src="../../_images/math/2e6c55564ed1e778b45d106ea33359f10664f47b.png" alt="m_{d} =\left\{\begin{array}{l} {1,\qquad d&lt;25{\rm m}} \\ {10,\qquad d\ge 25{\rm m}} \end{array}\right\}"/></p>
</div><p>where <em>d</em> is the lake depth.</p>
<p>The wind-driven eddy diffusion coefficient <img class="math" src="../../_images/math/f6b8c996bb4319018dd71fc8ff2433da0a759ec9.png" alt="\kappa _{e,\, i}"/> (m<sup>2</sup> s<sup>-1</sup>) for layers <img class="math" src="../../_images/math/86fe340edc0d9549cbd84dbdde8b1d87769b1729.png" alt="1\le i\le N_{levlak}"/>  is</p>
<div class="math" id="equation-12.31">
<p><span class="eqno">(31)<a class="headerlink" href="#equation-12.31" title="Permalink to this equation">¶</a></span><img src="../../_images/math/aad864cd17d0f2fc27d9c9dbc8af66b322d22c1b.png" alt="\kappa _{e,\, i} =\left\{\begin{array}{l} {\frac{kw^{*} z_{i} }{P_{0} \left(1+37Ri^{2} \right)} \exp \left(-k^{*} z_{i} \right)\qquad T_{g} &gt;T_{f} } \\ {0\qquad T_{g} \le T_{f} } \end{array}\right\}"/></p>
</div><p>where <img class="math" src="../../_images/math/c8661b0638b3055d437bd7bad1214497af710abd.png" alt="P_{0} =1"/> is the neutral value of the turbulent Prandtl
number, <img class="math" src="../../_images/math/5c6a6f366d550318f46ac322944a966f3e695c78.png" alt="z_{i}"/>  is the node depth (m), the surface friction
velocity (m s<sup>-1</sup>) is <img class="math" src="../../_images/math/4c09f83a7bec97e0b34e95ad817a0ad05e683d55.png" alt="w^{*} =0.0012u_{2}"/> , and
<img class="math" src="../../_images/math/30a875784ad696916734d9ab6939d52f0d96e177.png" alt="k^{*}"/>  varies with latitude <img class="math" src="../../_images/math/c2f31c22645274c375eff7920cfdfdc18d60341f.png" alt="\phi"/>  as
<img class="math" src="../../_images/math/22b4f42fa2f870160a5936d0c752cab0c5fadc0b.png" alt="k^{*} =6.6u_{2}^{-1.84} \sqrt{\left|\sin \phi \right|}"/> . For the
bottom layer,
<img class="math" src="../../_images/math/531a1b29c4cfb3170fe090afc288ee5b6663f551.png" alt="\kappa _{e,\, N_{levlak} } =\kappa _{e,N_{levlak} -1\, }"/> . As in
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#hostetlerbartlein1990"><span class="std std-ref">Hostetler and Bartlein (1990)</span></a>,
the 2-m wind speed <img class="math" src="../../_images/math/d51a172fa86fb07cd09b4989597acf606ed231b0.png" alt="u_{2}"/>  (m s<sup>-1</sup>) (eq. ) is used to evaluate
<img class="math" src="../../_images/math/756a5ed0c3b15955cc1f4ae01c2e5ae997d4530b.png" alt="w^{*}"/>  and <img class="math" src="../../_images/math/30a875784ad696916734d9ab6939d52f0d96e177.png" alt="k^{*}"/>  rather than the 10-m wind used by
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#henderson-sellers1985"><span class="std std-ref">Henderson-Sellers  (1985)</span></a>.</p>
<p>The Richardson number is</p>
<div class="math" id="equation-12.32">
<p><span class="eqno">(32)<a class="headerlink" href="#equation-12.32" title="Permalink to this equation">¶</a></span><img src="../../_images/math/cea09f9ca2df4463302b9ec547cc78241714e52b.png" alt="R_{i} =\frac{-1+\sqrt{1+\frac{40N^{2} k^{2} z_{i}^{2} }{w^{*^{2} } \exp \left(-2k^{*} z_{i} \right)} } }{20}"/></p>
</div><p>where</p>
<div class="math" id="equation-12.33">
<p><span class="eqno">(33)<a class="headerlink" href="#equation-12.33" title="Permalink to this equation">¶</a></span><img src="../../_images/math/eb9b5f730da450a1cb89d7ade95acbee3ef8aeab.png" alt="N^{2} =\frac{g}{\rho _{i} } \frac{\partial \rho }{\partial z}"/></p>
</div><p>and <img class="math" src="../../_images/math/307b3725cbb03398131f9ca542d79aff4933195f.png" alt="g"/> is the acceleration due to gravity (m s<sup>-2</sup>)
(<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.6</span></a>), <img class="math" src="../../_images/math/0029f7faf3083abb4709228990022266358c654a.png" alt="\rho _{i}"/>  is the density of water (kg
m<sup>-3</sup>), and <img class="math" src="../../_images/math/c2af6f7d1bf044a74f17dcb0d45a02d1a4656430.png" alt="\frac{\partial \rho }{\partial z}"/>  is
approximated as
<img class="math" src="../../_images/math/dce8ceb0262c7413ef3b81e305f73d068ed6c7c8.png" alt="\frac{\rho _{i+1} -\rho _{i} }{z_{i+1} -z_{i} }"/> . Note that
because here, <em>z</em> is increasing downwards (unlike in <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#hostetlerbartlein1990"><span class="std std-ref">Hostetler and Bartlein (1990)</span></a>), eq. contains no negative sign; this is a correction
from CLM4. The density of water is
(<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#hostetlerbartlein1990"><span class="std std-ref">Hostetler and Bartlein (1990)</span></a>)</p>
<div class="math" id="equation-12.34">
<p><span class="eqno">(34)<a class="headerlink" href="#equation-12.34" title="Permalink to this equation">¶</a></span><img src="../../_images/math/62ce89d8915e46cbd564c963886b0051db314c68.png" alt="\rho _{i} =1000\left(1-1.9549\times 10^{-5} \left|T_{i} -277\right|^{1.68} \right)."/></p>
</div><p>The enhanced diffusivity <img class="math" src="../../_images/math/f3215dd25a414b144e1b2e8745098157f4781caf.png" alt="K_{ed}"/>  is given by
(<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#fangstefan1996"><span class="std std-ref">Fang and Stefan 1996</span></a>)</p>
<div class="math" id="equation-12.35">
<p><span class="eqno">(35)<a class="headerlink" href="#equation-12.35" title="Permalink to this equation">¶</a></span><img src="../../_images/math/b60f293f431cb5f2979b16e6c945ddca0ef1fc6e.png" alt="K_{ed} =1.04\times 10^{-8} \left(N^{2} \right)^{-0.43} ,N^{2} \ge 7.5\times 10^{-5} {\rm s}^{2}"/></p>
</div><p>where <img class="math" src="../../_images/math/58f65ad7d83dff9026265eb4a81b977a16980b40.png" alt="N^{2}"/> is calculated as in eq. except for the minimum
value imposed in .</p>
<p>The thermal conductivity for the liquid water portion of lake body layer
<em>i</em>, <img class="math" src="../../_images/math/f6f25954ef47c7085a9103ac2394e1b3a3120315.png" alt="\tau _{liq,i}"/>  (W m<sup>-1</sup> K<sup>-1</sup>) is
given by</p>
<div class="math" id="equation-12.36">
<p><span class="eqno">(36)<a class="headerlink" href="#equation-12.36" title="Permalink to this equation">¶</a></span><img src="../../_images/math/cfcbd35c063b766897231d778cd543fa021175af.png" alt="\tau _{liq,i} =K_{W} c_{liq} \rho _{liq}  ."/></p>
</div><p>The thermal conductivity of the ice portion of lake body layer <em>i</em>,
<img class="math" src="../../_images/math/f1382a38267d799a53b854b81b77b57e0ecc59af.png" alt="\tau _{ice,eff}"/> (W m<sup>-1</sup> K<sup>-1</sup>), is
constant among layers, and is given by</p>
<div class="math" id="equation-12.37">
<p><span class="eqno">(37)<a class="headerlink" href="#equation-12.37" title="Permalink to this equation">¶</a></span><img src="../../_images/math/0e35a71e59a94a12215db2b61972f7015149b2d3.png" alt="\tau _{ice,eff} =\tau _{ice} \frac{\rho _{ice} }{\rho _{liq} }"/></p>
</div><p>where <img class="math" src="../../_images/math/58e01c5b957d1c25dad3080335d40a52b8237f2e.png" alt="\tau _{ice}"/> (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.6</span></a>) is the nominal thermal
conductivity of ice: <img class="math" src="../../_images/math/f1382a38267d799a53b854b81b77b57e0ecc59af.png" alt="\tau _{ice,eff}"/> is adjusted for the fact
that the nominal model layer thicknesses remain constant even while the
physical ice thickness exceeds the water thickness.</p>
<p>The overall thermal conductivity <img class="math" src="../../_images/math/ed580993acc8807ed3dfabe6ef4b655466b59f88.png" alt="\tau _{i}"/>  for layer <em>i</em> with
ice mass-fraction <img class="math" src="../../_images/math/9aee257cc5fc4699428fa11c5b23d5c1ab1e4410.png" alt="I_{i}"/> is the harmonic mean of the liquid
and water fractions, assuming that they will be physically vertically
stacked, and is given by</p>
<div class="math" id="equation-12.38">
<p><span class="eqno">(38)<a class="headerlink" href="#equation-12.38" title="Permalink to this equation">¶</a></span><img src="../../_images/math/be395dfe71dbb3dfc50239550449e4ead3056d88.png" alt="\tau _{i} =\frac{\tau _{ice,eff} \tau _{liq,i} }{\tau _{liq,i} I_{i} +\tau _{ice} \left(1-I_{i} \right)}  ."/></p>
</div><p>The thermal conductivity of snow, soil, and bedrock layers above and
below the lake, respectively, are computed identically to those for
vegetated land units (Chapter <a class="reference internal" href="../Soil_Snow_Temperatures/CLM50_Tech_Note_Soil_Snow_Temperatures.html#rst-soil-and-snow-temperatures"><span class="std std-numref">6</span></a>), except for the adjustment of thermal
conductivity for frost heave or excess ice (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#subinetal2012a"><span class="std std-ref">Subin et al., 2012a,
Supporting Information</span></a>).</p>
</div>
<div class="section" id="radiation-penetration">
<span id="id3"></span><h3>12.5.5. Radiation Penetration<a class="headerlink" href="#radiation-penetration" title="Permalink to this headline">¶</a></h3>
<p>If there are no resolved snow layers, the surface absorption fraction <img class="math" src="../../_images/math/410a9d0df9c135dd73b269cba7ef04dcfd932b1f.png" alt="\beta"/> is set according to the near-infrared fraction simulated
by the atmospheric model. This is apportioned to the surface energy
budget (section <a class="reference internal" href="#surface-properties-lake"><span class="std std-numref">12.4.1</span></a>), and thus no additional radiation is absorbed in
the top <img class="math" src="../../_images/math/6f835cb8cbb1d9f9748833321305b4bf2edc897d.png" alt="z_{a}"/>  (currently 0.6 m) of unfrozen lakes, for which
the light extinction coefficient <img class="math" src="../../_images/math/5635a7c34414599c2452d72430811e816b460335.png" alt="\eta"/> (m<sup>-1</sup>)
varies between lake columns (eq. ). For frozen lakes
(<img class="math" src="../../_images/math/d21a433ad8384f9fe95fffb9321580b5043b0cbe.png" alt="T_{g} \le T_{f}"/> ), the remaining <img class="math" src="../../_images/math/3f1884bae63864f7fa6c0c63bb59655244182c51.png" alt="\left(1-\beta \right)\vec{S}_{g}"/>  fraction of surface absorbed
radiation that is not apportioned to the surface energy budget is
absorbed in the top lake body layer. This is a simplification, as lake
ice is partially transparent. If there are resolved snow layers, then
the snow optics submodel (Chapter <a class="reference internal" href="../Surface_Albedos/CLM50_Tech_Note_Surface_Albedos.html#rst-surface-albedos"><span class="std std-numref">3</span></a>) is used to calculate the snow layer
absorption (except for the absorption predicted for the top layer by the
snow optics submodel, which is assigned to the surface energy budget),
with the remainder penetrating snow layers absorbed in the top lake body
ice layer.</p>
<p>For unfrozen lakes, the solar radiation remaining at depth
<img class="math" src="../../_images/math/a2d820a400132f64812dec7719773634cb82df3c.png" alt="z&gt;z_{a}"/>  in the lake body is given by</p>
<div class="math" id="equation-12.39">
<p><span class="eqno">(39)<a class="headerlink" href="#equation-12.39" title="Permalink to this equation">¶</a></span><img src="../../_images/math/6759255f44774fca08e6f7abe993a19707bf3ce8.png" alt="\phi =\left(1-\beta \vec{S}_{g} \right)\exp \left\{-\eta \left(z-z_{a} \right)\right\} ."/></p>
</div><p>For all lake body layers, the flux absorbed by the layer <em>i</em>,
<img class="math" src="../../_images/math/898bbc40b5024ddff2e291c3ee4bd9138f6cb94c.png" alt="\phi _{i}"/>  , is</p>
<div class="math" id="equation-12.40">
<p><span class="eqno">(40)<a class="headerlink" href="#equation-12.40" title="Permalink to this equation">¶</a></span><img src="../../_images/math/172c4225311a8785140a30a6aa5d0b7265a26fea.png" alt="\phi _{i} =\left(1-\beta \vec{S}_{g} \right)\left[\exp \left\{-\eta \left(z_{i} -\frac{\Delta z_{i} }{2} -z_{a} \right)\right\}-\exp \left\{-\eta \left(z_{i} +\frac{\Delta z_{i} }{2} -z_{a} \right)\right\}\right] ."/></p>
</div><p>The argument of each exponent is constrained to be non-negative (so
<img class="math" src="../../_images/math/898bbc40b5024ddff2e291c3ee4bd9138f6cb94c.png" alt="\phi _{i}"/>  = 0 for layers contained within <img class="math" src="../../_images/math/eeaa69dbada8d7647ac90714ffe9f4a21b3672fb.png" alt="{z}_{a}"/>).
The remaining flux exiting the bottom of layer <img class="math" src="../../_images/math/40c0907037aae4377936afaa4205b41b90f3d30c.png" alt="i=N_{levlak}"/>  is
absorbed in the top soil layer.</p>
<p>The light extinction coefficient <img class="math" src="../../_images/math/5635a7c34414599c2452d72430811e816b460335.png" alt="\eta"/> (m<sup>-1</sup>), if
not provided as external data, is a function of depth <em>d</em> (m)
(<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#subinetal2012a"><span class="std std-ref">Subin et al. (2012a)</span></a>):</p>
<div class="math" id="equation-12.41">
<p><span class="eqno">(41)<a class="headerlink" href="#equation-12.41" title="Permalink to this equation">¶</a></span><img src="../../_images/math/7c253ca78900d9612c6006cc440f197f2b79477a.png" alt="\eta =1.1925d^{-0.424}  ."/></p>
</div></div>
<div class="section" id="heat-capacities">
<span id="heat-capacities-lake"></span><h3>12.5.6. Heat Capacities<a class="headerlink" href="#heat-capacities" title="Permalink to this headline">¶</a></h3>
<p>The vertically-integrated heat capacity for each lake layer,
<img class="math" src="../../_images/math/338d970a6cf5de8d410cf5f76dfe41d896dc5936.png" alt="\text{c}_{v,i}"/> (J m<sup>-2</sup>) is determined by the mass-weighted average over the heat capacities for the
water and ice fractions:</p>
<div class="math" id="equation-12.42">
<p><span class="eqno">(42)<a class="headerlink" href="#equation-12.42" title="Permalink to this equation">¶</a></span><img src="../../_images/math/3d909d94c365497dff7130856fb22b25c8b9a29d.png" alt="c_{v,i} =\Delta z_{i} \rho _{liq} \left[c_{liq} \left(1-I_{i} \right)+c_{ice} I_{i} \right] ."/></p>
</div><p>Note that the density of water is used for both ice and water fractions,
as the thickness of the layer is fixed.</p>
<p>The total heat capacity <img class="math" src="../../_images/math/1a752a12528d9a4adae19697844e79fd4c73eaa1.png" alt="c_{v,i}"/>  for each soil, snow, and
bedrock layer (J m<sup>-2</sup>) is determined as for vegetated land
units (Chapter <a class="reference internal" href="../Soil_Snow_Temperatures/CLM50_Tech_Note_Soil_Snow_Temperatures.html#rst-soil-and-snow-temperatures"><span class="std std-numref">6</span></a>), as the sum of the heat capacities for the water, ice,
and mineral constituents.</p>
</div>
<div class="section" id="crank-nicholson-solution">
<span id="crank-nicholson-solution-lake"></span><h3>12.5.7. Crank-Nicholson Solution<a class="headerlink" href="#crank-nicholson-solution" title="Permalink to this headline">¶</a></h3>
<p>The solution method for thermal diffusion is similar to that used for
soil (Chapter <a class="reference internal" href="../Soil_Snow_Temperatures/CLM50_Tech_Note_Soil_Snow_Temperatures.html#rst-soil-and-snow-temperatures"><span class="std std-numref">6</span></a>), except that the
lake body layers are sandwiched between the snow and soil layers
(section <a class="reference internal" href="#introduction-lake"><span class="std std-numref">12.5.1</span></a>), and radiation flux is
absorbed throughout the lake layers. Before solution, layer temperatures
<img class="math" src="../../_images/math/27d3051333351004a42e41ee5a73760e14557bc3.png" alt="T_{i}"/>  (K), thermal conductivities <img class="math" src="../../_images/math/ed580993acc8807ed3dfabe6ef4b655466b59f88.png" alt="\tau _{i}"/>  (W
m<sup>-1</sup> K<sup>-1</sup>), heat capacities <img class="math" src="../../_images/math/1a752a12528d9a4adae19697844e79fd4c73eaa1.png" alt="c_{v,i}"/>
(J m<sup>-2</sup>), and layer and interface depths from all
components are transformed into a uniform set of vectors with length
<img class="math" src="../../_images/math/1d64ca3e32dbbc212663b61dfd8c72800f861944.png" alt="N=n_{sno} +N_{levlak} +N_{levgrnd}"/>  and consistent units to
simplify the solution. Thermal conductivities at layer interfaces are
calculated as the harmonic mean of the conductivities of the neighboring
layers:</p>
<div class="math" id="equation-12.43">
<p><span class="eqno">(43)<a class="headerlink" href="#equation-12.43" title="Permalink to this equation">¶</a></span><img src="../../_images/math/bdedcfe12cf673c31846c56d1987f41da0ac981d.png" alt="\lambda _{i} =\frac{\tau _{i} \tau _{i+1} \left(z_{i+1} -z_{i} \right)}{\tau _{i} \left(z_{i+1} -\hat{z}_{i} \right)+\tau _{i+1} \left(\hat{z}_{i} -z_{i} \right)}  ,"/></p>
</div><p>where <img class="math" src="../../_images/math/5a566cb21926ea5d16c54bc53464c6d90c4c0d2a.png" alt="\lambda _{i}"/>  is the conductivity at the interface between
layer <em>i</em> and layer <em>i +</em> 1, <img class="math" src="../../_images/math/5c6a6f366d550318f46ac322944a966f3e695c78.png" alt="z_{i}"/>  is the depth of the node of
layer <em>i</em>, and <img class="math" src="../../_images/math/bca6e78ff634b0b3c45b5aac80c2901e140445db.png" alt="\hat{z}_{i}"/>  is the depth of the interface below
layer <em>i</em>. Care is taken at the boundaries between snow and lake and
between lake and soil. The governing equation is discretized for each
layer as</p>
<div class="math" id="equation-12.44">
<p><span class="eqno">(44)<a class="headerlink" href="#equation-12.44" title="Permalink to this equation">¶</a></span><img src="../../_images/math/902acdb52778d9c6d877c32db67f86eb022e7efb.png" alt="\frac{c_{v,i} }{\Delta t} \left(T_{i}^{n+1} -T_{i}^{n} \right)=F_{i-1} -F_{i} +\phi _{i}"/></p>
</div><p>where superscripts <em>n</em> + 1 and <em>n</em> denote values at the end and
beginning of the timestep <img class="math" src="../../_images/math/ec002955bdf95ee9869878fbad4f80fc98539359.png" alt="\Delta t"/>, respectively, <img class="math" src="../../_images/math/7f0c47fab61cc2004c71e68c86d989d1182b2037.png" alt="F_{i}"/>
(W m<sup>-2</sup>) is the downward heat flux at the bottom of layer
<em>i</em>, and <img class="math" src="../../_images/math/898bbc40b5024ddff2e291c3ee4bd9138f6cb94c.png" alt="\phi _{i}"/>  is the solar radiation absorbed in layer
<em>i</em>.</p>
<p>Eq. is solved using the semi-implicit Crank-Nicholson Method, resulting
in a tridiagonal system of equations:</p>
<div class="math" id="equation-12.45">
<p><span class="eqno">(45)<a class="headerlink" href="#equation-12.45" title="Permalink to this equation">¶</a></span><img src="../../_images/math/1fdafce5a164ba7fddfe40a87e0ca68477ed0d0f.png" alt="\begin{array}{l} {r_{i} =a_{i} T_{i-1}^{n+1} +b_{i} T_{i}^{n+1} +cT_{i+1}^{n+1} ,} \\ {a_{i} =-0.5\frac{\Delta t}{c_{v,i} } \frac{\partial F_{i-1} }{\partial T_{i-1}^{n} } ,} \\ {b_{i} =1+0.5\frac{\Delta t}{c_{v,i} } \left(\frac{\partial F_{i-1} }{\partial T_{i-1}^{n} } +\frac{\partial F_{i} }{\partial T_{i}^{n} } \right),} \\ {c_{i} =-0.5\frac{\Delta t}{c_{v,i} } \frac{\partial F_{i} }{\partial T_{i}^{n} } ,} \\ {r_{i} =T_{i}^{n} +0.5\frac{\Delta t}{c_{v,i} } \left(F_{i-1} -F_{i} \right)+\frac{\Delta t}{c_{v,i} } \phi _{i} .} \end{array}"/></p>
</div><p>The fluxes <img class="math" src="../../_images/math/7f0c47fab61cc2004c71e68c86d989d1182b2037.png" alt="F_{i}"/>  are defined as follows: for the top layer,
<img class="math" src="../../_images/math/cc4ad3b0ef23803461172f8041c3e7306c65bab5.png" alt="F_{j_{top} -1} =2G;a_{j_{top} } =0"/>, where <em>G</em> is defined as in
section <a class="reference internal" href="#boundary-conditions-lake"><span class="std std-numref">12.5.3</span></a> (the factor of 2 merely cancels
out the Crank-Nicholson 0.5 in the equation for <img class="math" src="../../_images/math/75b74a5a14f4e86acb468df14bb74845e9df43da.png" alt="r_{j_{top} }"/> ).
For the bottom layer, <img class="math" src="../../_images/math/3c722498f8cce5f438e55d2816d033dfe194c79d.png" alt="F_{N_{levlak} +N_{levgrnd} } =0"/>.
For all other layers:</p>
<div class="math" id="equation-12.46">
<p><span class="eqno">(46)<a class="headerlink" href="#equation-12.46" title="Permalink to this equation">¶</a></span><img src="../../_images/math/fe8d44f5ed9342deaaa58e6a00ceba39f52cea1b.png" alt="F_{i} =\lambda _{i} \frac{T_{i} ^{n} -T_{i+1}^{n} }{z_{n+1} -z_{n} }  ."/></p>
</div></div>
<div class="section" id="phase-change">
<span id="phase-change-lake"></span><h3>12.5.8. Phase Change<a class="headerlink" href="#phase-change" title="Permalink to this headline">¶</a></h3>
<p>Phase change in the lake, snow, and soil is done similarly to that done
for the soil and snow for vegetated land units (Chapter <a class="reference internal" href="../Soil_Snow_Temperatures/CLM50_Tech_Note_Soil_Snow_Temperatures.html#rst-soil-and-snow-temperatures"><span class="std std-numref">6</span></a>), except
without the allowance for freezing point depression in soil underlying
lakes. After the heat diffusion is calculated, phase change occurs in a
given layer if the temperature is below freezing and liquid water
remains, or if the temperature is above freezing and ice remains.</p>
<p>If melting occurs, the available energy for melting, <img class="math" src="../../_images/math/4c437f851933b72b191e38629a242f772817d8d2.png" alt="Q_{avail}"/>
(J m<sup>-2</sup>), is computed as</p>
<div class="math" id="equation-12.47">
<p><span class="eqno">(47)<a class="headerlink" href="#equation-12.47" title="Permalink to this equation">¶</a></span><img src="../../_images/math/529e417f520a0ce505d407edda352413c1d9db50.png" alt="Q_{avail} =\left(T_{i} -T_{f} \right)c_{v,i}"/></p>
</div><p>where <img class="math" src="../../_images/math/27d3051333351004a42e41ee5a73760e14557bc3.png" alt="T_{i}"/>  is the temperature of the layer after thermal
diffusion (section <a class="reference internal" href="#crank-nicholson-solution-lake"><span class="std std-numref">12.5.7</span></a>), and
<img class="math" src="../../_images/math/1a752a12528d9a4adae19697844e79fd4c73eaa1.png" alt="c_{v,i}"/> is as calculated in section
<a class="reference internal" href="#heat-capacities-lake"><span class="std std-numref">12.5.6</span></a>. The mass of melt in the layer <em>M</em>
(kg m<sup>-2</sup>) is given by</p>
<div class="math" id="equation-12.48">
<p><span class="eqno">(48)<a class="headerlink" href="#equation-12.48" title="Permalink to this equation">¶</a></span><img src="../../_images/math/86abc5ddabc2c7ee9201248bc6a557af9d170227.png" alt="M=\min \left\{M_{ice} ,\frac{Q_{avail} }{H_{fus} } \right\}"/></p>
</div><p>where <img class="math" src="../../_images/math/ca03e0aad7c2b3a974daf3c39f12712da5261684.png" alt="H_{fus}"/>  (J kg<sup>-1</sup>) is the latent heat of
fusion of water (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.6</span></a>), and <img class="math" src="../../_images/math/d5ac853b959e8e89375f5b8c9e534e622c57c464.png" alt="M_{ice}"/>  is the mass of ice in
the layer: <img class="math" src="../../_images/math/5cbb820ff409638d7bd8720be95c97ee102eb047.png" alt="I_{i} \rho _{liq} \Delta z_{i}"/>  for a lake body
layer, or simply the soil / snow ice content state variable
(<img class="math" src="../../_images/math/c55f0d86837d49741b8e5cd3844792ced2708da0.png" alt="w_{ice}"/> ) for a soil / snow layer. The heat remainder,
<img class="math" src="../../_images/math/d75f3b53eed062571612f73ff2e11a80b070ee75.png" alt="Q_{rem}"/> is given by</p>
<div class="math" id="equation-12.49">
<p><span class="eqno">(49)<a class="headerlink" href="#equation-12.49" title="Permalink to this equation">¶</a></span><img src="../../_images/math/c9a96a74b41ed4c1ebbc0f06d62dd53d5ab17fb3.png" alt="Q_{rem} =Q_{avail} -MH_{fus}  ."/></p>
</div><p>Finally, the mass of ice in the layer <img class="math" src="../../_images/math/d5ac853b959e8e89375f5b8c9e534e622c57c464.png" alt="M_{ice}"/>  is adjusted
downwards by <img class="math" src="../../_images/math/450a8e2c2320d77181e0d4fc68c947e9a5de8ecb.png" alt="M"/>, and the temperature <img class="math" src="../../_images/math/27d3051333351004a42e41ee5a73760e14557bc3.png" alt="T_{i}"/>  of the
layer is adjusted to</p>
<div class="math" id="equation-12.50">
<p><span class="eqno">(50)<a class="headerlink" href="#equation-12.50" title="Permalink to this equation">¶</a></span><img src="../../_images/math/d577d469b43c76b753430d70268c7be69b921917.png" alt="T_{i} =T_{f} +\frac{Q_{rem} }{c'_{v,i} }"/></p>
</div><p>where <img class="math" src="../../_images/math/e778ae59e82dcb74028679a5f7ba6736f3c0133b.png" alt="c'_{v,i} =c_{v,i} +M\left(c_{liq} -c_{ice} \right)"/>.</p>
<p>If freezing occurs, <img class="math" src="../../_images/math/4c437f851933b72b191e38629a242f772817d8d2.png" alt="Q_{avail}"/>  is again given by but will be
negative. The melt <img class="math" src="../../_images/math/450a8e2c2320d77181e0d4fc68c947e9a5de8ecb.png" alt="M"/>, also negative, is given by</p>
<div class="math" id="equation-12.51">
<p><span class="eqno">(51)<a class="headerlink" href="#equation-12.51" title="Permalink to this equation">¶</a></span><img src="../../_images/math/8db00f4125ee1bf9c1c159e2ca1baf51cf6f83f2.png" alt="M=\max \left\{-M_{liq} ,\frac{Q_{avail} }{H_{fus} } \right\}"/></p>
</div><p>where <img class="math" src="../../_images/math/ac7eace2d07768c3ed936577612bba171df8297f.png" alt="M_{liq}"/>  is the mass of water in the layer:
<img class="math" src="../../_images/math/34edde9551ce8d8b71018442c6b802e440806a68.png" alt="\left(1-I_{i} \right)\rho _{liq} \Delta z_{i}"/>  for a lake body
layer, or the soil / snow water content state variable
(<img class="math" src="../../_images/math/d141210f985c164fbf9197a648f82ea1c0f84328.png" alt="w_{liq}"/> ). The heat remainder <img class="math" src="../../_images/math/d75f3b53eed062571612f73ff2e11a80b070ee75.png" alt="Q_{rem}"/>  is given by eq.
and will be negative or zero. Finally, <img class="math" src="../../_images/math/ac7eace2d07768c3ed936577612bba171df8297f.png" alt="M_{liq}"/>  is adjusted
downwards by <img class="math" src="../../_images/math/a355beabe336a23a8da422e1d7922884286eaaa0.png" alt="-M"/> and the temperature is reset according to eq. .</p>
<p>In the presence of nonzero snow water <img class="math" src="../../_images/math/6860800c19b4740d9848e1fbd83097c81e081014.png" alt="W_{sno}"/>  without resolved
snow layers over</p>
<p>an unfrozen top lake layer, the available energy in the top lake layer
<img class="math" src="../../_images/math/982fbdab38c716dc7a0964f1bd1e1fc368df8d3f.png" alt="\left(T_{1} -T_{f} \right)c_{v,1}"/>  is used to melt the snow.
Similar to above, <img class="math" src="../../_images/math/6860800c19b4740d9848e1fbd83097c81e081014.png" alt="W_{sno}"/>  is either completely melted and the
remainder of heat returned to the top lake layer, or the available heat
is exhausted and the top lake layer is set to freezing. The snow
thickness is adjusted downwards in proportion to the amount of melt,
maintaining constant density.</p>
</div>
<div class="section" id="convection">
<span id="convection-lake"></span><h3>12.5.9. Convection<a class="headerlink" href="#convection" title="Permalink to this headline">¶</a></h3>
<p>Convective mixing is based on
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#hostetleretal1993"><span class="std std-ref">Hostetler et al.’s (1993, 1994)</span></a> coupled
lake-atmosphere model, adjusting the lake temperature after diffusion
and phase change to maintain a stable density profile. Unfrozen lakes
overturn when <img class="math" src="../../_images/math/9bca4bdbdfe52422306ea03acecd8cba925feb47.png" alt="\rho _{i} &gt;\rho _{i+1}"/> , in which case the layer
thickness weighted average temperature for layers 1 to <img class="math" src="../../_images/math/332e5378de791e071e4c73e332d91ae51120deea.png" alt="i+1"/> is
applied to layers 1 to <img class="math" src="../../_images/math/332e5378de791e071e4c73e332d91ae51120deea.png" alt="i+1"/> and the densities are updated. This
scheme is applied iteratively to layers <img class="math" src="../../_images/math/71776ef46a3fd7fb945a9e7613d514369c0d70fe.png" alt="1\le i&lt;N_{levlak} -1"/>.
Unstable profiles occurring at the bottom of the lake (i.e., between
layers <img class="math" src="../../_images/math/c4e96e651ec59be8d4708433a006fdf2bd47b943.png" alt="i=N_{levlak} -1"/> and <img class="math" src="../../_images/math/40c0907037aae4377936afaa4205b41b90f3d30c.png" alt="i=N_{levlak}"/> ) are treated
separately (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#subinetal2012a"><span class="std std-ref">Subin et al. (2012a)</span></a>), as occasionally
these can be induced by
heat expelled from the sediments (not present in the original
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#hostetleretal1994"><span class="std std-ref">Hostetler et al. (1994)</span></a> model). Mixing proceeds
from the bottom upward in this
case (i.e., first mixing layers <img class="math" src="../../_images/math/c4e96e651ec59be8d4708433a006fdf2bd47b943.png" alt="i=N_{levlak} -1"/> and
<img class="math" src="../../_images/math/40c0907037aae4377936afaa4205b41b90f3d30c.png" alt="i=N_{levlak}"/> , then checking <img class="math" src="../../_images/math/adf700bf9c02e30ec929d10d328f8cd7dd7b6c8b.png" alt="i=N_{levlak} -2"/> and
<img class="math" src="../../_images/math/c4e96e651ec59be8d4708433a006fdf2bd47b943.png" alt="i=N_{levlak} -1"/> and mixing down to <img class="math" src="../../_images/math/40c0907037aae4377936afaa4205b41b90f3d30c.png" alt="i=N_{levlak}"/>  if
needed, and on to the top), so as not to mix in with warmer over-lying
layers.</p>
<p>For frozen lakes, this algorithm is generalized to conserve total
enthalpy and ice content, and to maintain ice contiguous at the top of
the lake. Thus, an additional mixing criterion is added: the presence of
ice in a layer that is below a layer which is not completely frozen.
When this occurs, these two lake layers and all those above mix. Total
enthalpy <em>Q</em> is conserved as</p>
<div class="math" id="equation-12.52">
<p><span class="eqno">(52)<a class="headerlink" href="#equation-12.52" title="Permalink to this equation">¶</a></span><img src="../../_images/math/fb25a6bc0f2423b893ffc6629e0cc0f55dcba529.png" alt="Q=\sum _{j=1}^{i+1}\Delta z_{j} \rho _{liq} \left(T_{j} -T_{f} \right)\left[\left(1-I_{j} \right)c_{liq} +I_{j} c_{ice} \right]  ."/></p>
</div><p>Once the average ice fraction <img class="math" src="../../_images/math/d674f87726190a95d498b99ccb23c4c57414bc15.png" alt="I_{av}"/>  is calculated from</p>
<div class="math" id="equation-12.53">
<p><span class="eqno">(53)<a class="headerlink" href="#equation-12.53" title="Permalink to this equation">¶</a></span><img src="../../_images/math/e69b4885a06e06fa9d2f26548b57390044b0cd56.png" alt="\begin{array}{l} {I_{av} =\frac{\sum _{j=1}^{i+1}I_{j} \Delta z_{j}  }{Z_{i+1} } ,} \\ {Z_{i+1} =\sum _{j=1}^{i+1}\Delta z_{j}  ,} \end{array}"/></p>
</div><p>the temperatures are calculated. A separate temperature is calculated
for the frozen (<img class="math" src="../../_images/math/c645e67b348952c7337dded53580a378a6d5b7bb.png" alt="T_{froz}"/> ) and unfrozen (<img class="math" src="../../_images/math/3c5709fa47282f088486051e45284dfbcacd6d1a.png" alt="T_{unfr}"/> )
fractions of the mixed layers. If the total heat content <em>Q</em> is positive
(e.g. some layers will be above freezing), then the extra heat is all
assigned to the unfrozen layers, while the fully frozen layers are kept
at freezing. Conversely, if <img class="math" src="../../_images/math/1abdb1e1b6a363b301d3d1b8e81a270c50c9dbf9.png" alt="Q &lt; 0"/>, the heat deficit will all
be assigned to the ice, and the liquid layers will be kept at freezing.
For the layer that contains both ice and liquid (if present), a weighted
average temperature will have to be calculated.</p>
<p>If <img class="math" src="../../_images/math/97ce8490384510232af439974e12cd5336841e7c.png" alt="Q &gt; 0"/>, then <img class="math" src="../../_images/math/e128ddc8d99764931f2311005d0f58e74e8e02c7.png" alt="T_{froz} =T_{f}"/> , and <img class="math" src="../../_images/math/3c5709fa47282f088486051e45284dfbcacd6d1a.png" alt="T_{unfr}"/>
is given by</p>
<div class="math" id="equation-12.54">
<p><span class="eqno">(54)<a class="headerlink" href="#equation-12.54" title="Permalink to this equation">¶</a></span><img src="../../_images/math/3b9f1c1a9d5b621109a4b1221dcecb1e35035f86.png" alt="T_{unfr} =\frac{Q}{\rho _{liq} Z_{i+1} \left[\left(1-I_{av} \right)c_{liq} \right]} +T_{f}  ."/></p>
</div><p>If <img class="math" src="../../_images/math/1abdb1e1b6a363b301d3d1b8e81a270c50c9dbf9.png" alt="Q &lt; 0"/>, then <img class="math" src="../../_images/math/7dc179e8e1f377f006a36d5e7ab718f39a96a2ac.png" alt="T_{unfr} =T_{f}"/> , and <img class="math" src="../../_images/math/c645e67b348952c7337dded53580a378a6d5b7bb.png" alt="T_{froz}"/>
is given by</p>
<div class="math" id="equation-12.55">
<p><span class="eqno">(55)<a class="headerlink" href="#equation-12.55" title="Permalink to this equation">¶</a></span><img src="../../_images/math/34c1c096de629bee7bc34bbaed9e7afffca6809b.png" alt="T_{froz} =\frac{Q}{\rho _{liq} Z_{i+1} \left[I_{av} c_{ice} \right]} +T_{f}  ."/></p>
</div><p>The ice is lumped together at the top. For each lake layer <em>j</em> from 1
to <em>i</em> + 1, the ice fraction and temperature are set as follows, where
<img class="math" src="../../_images/math/b773d80d402e4ad718d14f41ed0a4b221a5dbcad.png" alt="Z_{j} =\sum _{m=1}^{j}\Delta z_{m}"/>  :</p>
<ol class="arabic">
<li><p class="first">If <img class="math" src="../../_images/math/8b55887df745e3d0c0454c5cd664e91cb3f07663.png" alt="Z_{j} \le Z_{i+1} I_{av}"/>  , then <img class="math" src="../../_images/math/dfadac55b671298bc7fee9b1cbe7b1a7d3ac27c9.png" alt="I_{j} =1"/> and
<img class="math" src="../../_images/math/3e1b8f68c2c75ea82c07fe501d416764fcc34c67.png" alt="T_{j} =T_{froz}"/>  .</p>
</li>
<li><p class="first">Otherwise, if <img class="math" src="../../_images/math/f12fd1d0891a75adeb8728db2327925b7eae0776.png" alt="Z_{j-1} &lt;Z_{i+1} I_{av}"/>  , then the layer will
contain both ice and water. The ice fraction is given by
<img class="math" src="../../_images/math/da7e7cde7a04f181acf8da03d014ff774489a218.png" alt="I_{j} =\frac{Z_{i+1} I_{av} -Z_{j-1} }{\Delta z_{j} }"/>  . The
temperature is set to conserve the desired heat content that would be
present if the layer could have two temperatures, and then dividing
by the heat capacity of the layer to yield</p>
<div class="math" id="equation-12.56">
<p><span class="eqno">(56)<a class="headerlink" href="#equation-12.56" title="Permalink to this equation">¶</a></span><img src="../../_images/math/f13345412631370c906d3fe9237e0a5e946368c1.png" alt="T_{j} =\frac{T_{froz} I_{j} c_{ice} +T_{unfr} \left(1-I_{j} \right)c_{liq} }{I_{j} c_{ice} +\left(1-I_{j} \right)c_{liq} }  ."/></p>
</div></li>
<li><p class="first">Otherwise, <img class="math" src="../../_images/math/20c3c63069ad0ca927a3f2660ec85c96d5570513.png" alt="I_{j} =0"/> and <img class="math" src="../../_images/math/90aa91bc52c310cc16d8cef59c9a8fb0c6a1e01a.png" alt="T_{j} =T_{unfr}"/> .</p>
</li>
</ol>
</div>
<div class="section" id="energy-conservation">
<span id="energy-conservation-lake"></span><h3>12.5.10. Energy Conservation<a class="headerlink" href="#energy-conservation" title="Permalink to this headline">¶</a></h3>
<p>To check energy conservation, the left-hand side of eq. XXX is
re-written to yield the total enthalpy of the lake system (J
m<sup>-2</sup>) <img class="math" src="../../_images/math/056f0f36016acc2023804843c1bcb311b8ac9e5d.png" alt="H_{tot}"/> :</p>
<div class="math" id="equation-12.57">
<p><span class="eqno">(57)<a class="headerlink" href="#equation-12.57" title="Permalink to this equation">¶</a></span><img src="../../_images/math/f5418d1268ea43544f2bf689f168eebf00b00a07.png" alt="H_{tot} =\sum _{i=j_{top} }^{N_{levlak} +N_{levgrnd} }\left[c_{v,i} \left(T_{i} -T_{f} \right)+M_{liq,i} H_{fus} \right] -W_{sno,bulk} H_{fus}"/></p>
</div><p>where <img class="math" src="../../_images/math/24f5f519228beb19ec69342a01a73f3359d86125.png" alt="M_{liq,i}"/>  is the water mass of the <em>i</em>th layer (similar
to section <a class="reference internal" href="#phase-change-lake"><span class="std std-numref">12.5.8</span></a>), and <img class="math" src="../../_images/math/da52aec1bb32c0407767570ab57b6a97114bd30d.png" alt="W_{sno,bulk}"/>  is the mass of snow-ice not
present in resolved snow layers. This expression is evaluated once at
the beginning and once at the end of the timestep (re-evaluating each
<img class="math" src="../../_images/math/1a752a12528d9a4adae19697844e79fd4c73eaa1.png" alt="c_{v,i}"/> ), and the change is compared with the net surface
energy flux to yield the error flux <img class="math" src="../../_images/math/953918ef5b78fa3bc7b1b1d3f10d1c8fe501dae6.png" alt="E_{soi}"/>  (W
m<sup>-2</sup>):</p>
<div class="math" id="equation-12.58">
<p><span class="eqno">(58)<a class="headerlink" href="#equation-12.58" title="Permalink to this equation">¶</a></span><img src="../../_images/math/b44fdfe2f7076ccc1c4f925b2086cd10e7ccf0b8.png" alt="E_{soi} =\frac{\Delta H_{tot} }{\Delta t} -G-\sum _{i=j_{top} }^{N_{levlak} +N_{levgrnd} }\phi _{i}"/></p>
</div><p>If <img class="math" src="../../_images/math/cc4265aa52914ba270e7c67c1095d16b9a5481ba.png" alt="\left|E_{soi} \right|&lt;0.1"/>W m<sup>-2</sup>, it is
subtracted from the sensible heat flux and added to <em>G</em>. Otherwise, the
model is aborted.</p>
</div>
</div>
<div class="section" id="lake-hydrology">
<span id="id4"></span><h2>12.6. Lake Hydrology<a class="headerlink" href="#lake-hydrology" title="Permalink to this headline">¶</a></h2>
<div class="section" id="overview">
<span id="overview-lake-hydrology"></span><h3>12.6.1. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p>Hydrology is done similarly to other impervious non-vegetated columns
(e.g., glaciers) where snow layers may be resolved but infiltration into
the permanent ground is not allowed. The water mass of lake columns is
currently maintained constant, aside from overlying snow. The water
budget is balanced with <img class="math" src="../../_images/math/e667285d49e1651ab47c8d1cf5a3f359680f724c.png" alt="q_{rgwl}"/>  (eq. ; kg m<sup>-2</sup>
s<sup>-1</sup>), a generalized runoff term for impervious land units
that may be negative.</p>
<p>There are some modifications to the soil and snow parameterizations as
compared with the soil in vegetated land units, or the snow overlying
other impervious columns. The soil can freeze or thaw, with the
allowance for frost heave (or the initialization of excess ice)
(sections <a class="reference internal" href="#eddy-diffusivity-and-thermal-conductivities"><span class="std std-numref">12.5.4</span></a> and
<a class="reference internal" href="#phase-change-lake"><span class="std std-numref">12.5.8</span></a>), but no air-filled pore space is allowed in
the soil. To preserve numerical stability in the lake model (which uses
a slightly different surface flux algorithm than over other
non-vegetated land units), two changes are made to the snow model.
First, dew or frost is not allowed to be absorbed by a top snow layer
which has become completely melted during the timestep. Second, because
occasional instabilities occurred during model testing when the
Courant–Friedrichs–Lewy (CFL) condition was violated, due to the
explicit time-stepping integration of the surface flux solution,
resolved snow layers must be a minimum of <img class="math" src="../../_images/math/c51cd18261e8f8c9fd1795e3f79d779a4a29a0ce.png" alt="s_{\min }"/>  = 4 cm
thick rather than 1 cm when the default timestep of 1800 s is used.</p>
</div>
<div class="section" id="water-balance">
<span id="water-balance-lake"></span><h3>12.6.2. Water Balance<a class="headerlink" href="#water-balance" title="Permalink to this headline">¶</a></h3>
<p>The total water balance of the system is given by</p>
<div class="math" id="equation-12.59">
<p><span class="eqno">(59)<a class="headerlink" href="#equation-12.59" title="Permalink to this equation">¶</a></span><img src="../../_images/math/9be336a3ecbdafe754b319718ac7515f31a40a14.png" alt="\Delta W_{sno} +\sum _{i=1}^{n_{levsoi} }\left(\Delta w_{liq,i} +\Delta w_{ice,i} \right) =\left(q_{rain} +q_{sno} -E_{g} -q_{rgwl} -q_{snwcp,\, ice} \right)\Delta t"/></p>
</div><p>where <img class="math" src="../../_images/math/6860800c19b4740d9848e1fbd83097c81e081014.png" alt="W_{sno}"/>  (kg m<sup>-2</sup>) is the total mass of snow
(both liquid and ice, in resolved snow layers or bulk snow),
<img class="math" src="../../_images/math/9b38021be899f869dcb9a2eec54e1034d941bd39.png" alt="w_{liq,i}"/>  and <img class="math" src="../../_images/math/fd8a0fbaf8024407f6cf74f5e9187a713d94776d.png" alt="w_{ice,i}"/>  are the masses of water phases
(kg m<sup>-2</sup>) in soil layer <em>i</em>, <img class="math" src="../../_images/math/43e9a978c2c013603f21a25558bdd04a2da09abb.png" alt="q_{rain}"/>  and
<img class="math" src="../../_images/math/9e3a93d40819f3cda6b4d99a456ba6a669ddf573.png" alt="q_{sno}"/>  are the precipitation forcing from the atmosphere (kg
m<sup>-2</sup> s<sup>-1</sup>), <img class="math" src="../../_images/math/07c8434ad1ac2492e0c564b54971b36e42f41e40.png" alt="q_{snwcp,\, ice}"/>  is the ice runoff
associated with snow-capping (below), <img class="math" src="../../_images/math/8525155a3a4fea88abbafe102ddbd2fb5b6867e5.png" alt="E_{g}"/>  is the ground
evaporation (section <a class="reference internal" href="#surface-flux-solution-lake"><span class="std std-numref">12.4.2</span></a>), and <img class="math" src="../../_images/math/5dedf1f6807b41bef196c069c86e39c243661169.png" alt="n_{levsoi}"/>
is the number of hydrologically active soil layers (as opposed to dry bedrock
layers).</p>
</div>
<div class="section" id="precipitation-evaporation-and-runoff">
<span id="precipitation-evaporation-and-runoff-lake"></span><h3>12.6.3. Precipitation, Evaporation, and Runoff<a class="headerlink" href="#precipitation-evaporation-and-runoff" title="Permalink to this headline">¶</a></h3>
<p>All precipitation reaches the ground, as there is no vegetated fraction.
As for other land types, incident snowfall accumulates (with ice mass
<img class="math" src="../../_images/math/6860800c19b4740d9848e1fbd83097c81e081014.png" alt="W_{sno}"/>  and thickness <img class="math" src="../../_images/math/c93c3a1834f19d010eeafd4cd70822a3d8d2cbe0.png" alt="z_{sno}"/> ) until its thickness
exceeds a minimum thickness <img class="math" src="../../_images/math/c51cd18261e8f8c9fd1795e3f79d779a4a29a0ce.png" alt="s_{\min }"/> , at which point a
resolved snow layer is initiated, with water, ice, dissolved aerosol,
snow-grain radius, etc., state variables tracked by the Snow Hydrology
submodel (Chapter <a class="reference internal" href="../Snow_Hydrology/CLM50_Tech_Note_Snow_Hydrology.html#rst-snow-hydrology"><span class="std std-numref">8</span></a>). The density of fresh snow is
assigned as for other land types (Chapter <a class="reference internal" href="../Snow_Hydrology/CLM50_Tech_Note_Snow_Hydrology.html#rst-snow-hydrology"><span class="std std-numref">8</span></a>).
Solid precipitation is added immediately
to the snow, while liquid precipitation is added to snow layers, if they
exist, after accounting for dew, frost, and sublimation (below). If
<img class="math" src="../../_images/math/c93c3a1834f19d010eeafd4cd70822a3d8d2cbe0.png" alt="z_{sno}"/>  exceeds <img class="math" src="../../_images/math/c51cd18261e8f8c9fd1795e3f79d779a4a29a0ce.png" alt="s_{\min }"/>  after solid precipitation is
added but no snow layers are present, a new snow layer is initiated
immediately, and then dew, frost, and sublimation are accounted for.
Snow-capping is invoked if the snow depth <img class="math" src="../../_images/math/999230b405d7b8f355a7d096d58df783e456cf17.png" alt="z_{sno} &gt;1000{\rm m}"/>,
in which case additional precipitation and frost deposition is added to
<img class="math" src="../../_images/math/07c8434ad1ac2492e0c564b54971b36e42f41e40.png" alt="q_{snwcp,\, ice}"/> .</p>
<p>If there are resolved snow layers, the generalized “evaporation”
<img class="math" src="../../_images/math/8525155a3a4fea88abbafe102ddbd2fb5b6867e5.png" alt="E_{g}"/>  (i.e., evaporation, dew, frost, and sublimation) is
treated as over other land units, except that the allowed evaporation
from the ground is unlimited (though the top snow layer cannot lose more
water mass than it contains). If there are no resolved snow layers but
<img class="math" src="../../_images/math/2e30e905c9b70608a74c2c4d97e1d1e535f84954.png" alt="W_{sno} &gt;0"/> and <img class="math" src="../../_images/math/d9bcd809fd981fae20ae3f2f3f5e476cc89f30f6.png" alt="E_{g} &gt;0"/>, sublimation
<img class="math" src="../../_images/math/b9d1bbf3cc677c7424e20d7e210be56b85eae749.png" alt="q_{sub,sno}"/> (kg m<sup>-2</sup> s<sup>-1</sup>) will be
given by</p>
<div class="math" id="equation-12.60">
<p><span class="eqno">(60)<a class="headerlink" href="#equation-12.60" title="Permalink to this equation">¶</a></span><img src="../../_images/math/ad3433f3119dc6e785a982632f5451cb088bb834.png" alt="q_{sub,sno} =\min \left\{E_{g} ,\frac{W_{sno} }{\Delta t} \right\} ."/></p>
</div><p>If <img class="math" src="../../_images/math/442b98bcee34b3235a9b895744c923002808c5a0.png" alt="E_{g} &lt;0,T_{g} \le T_{f}"/>  , and there are no resolved snow
layers or the top snow layer is not unfrozen, then the rate of frost
production <img class="math" src="../../_images/math/034da399cedcab60ce5c0a8ba3aaddc5f2a3a8d3.png" alt="q_{frost} =\left|E_{g} \right|"/>. If <img class="math" src="../../_images/math/1dbae5bfd66a3161aa748bea57dbc4c7cc7a7ee4.png" alt="E_{g} &lt;0"/>
but the top snow layer has completely thawed during the Phase Change step
of the Lake Temperature solution (section <a class="reference internal" href="#phase-change-lake"><span class="std std-numref">12.5.8</span></a>), then
frost (or dew) is not allowed to accumulate (<img class="math" src="../../_images/math/4e58e56416a1dd8f05e45d296c9eebac43f70f78.png" alt="q_{frost} =0"/>), to
insure that the layer is eliminated by the Snow Hydrology
(Chapter <a class="reference internal" href="../Snow_Hydrology/CLM50_Tech_Note_Snow_Hydrology.html#rst-snow-hydrology"><span class="std std-numref">8</span></a>) code. (If <img class="math" src="../../_images/math/8da24025b5910b9efaa75906bfa6001bc6c7cf9c.png" alt="T_{g} &gt;T_{f}"/>,
then no snow is present (section <a class="reference internal" href="#surface-flux-solution-lake"><span class="std std-numref">12.4.2</span></a>), and
evaporation or dew deposition is balanced by <img class="math" src="../../_images/math/e667285d49e1651ab47c8d1cf5a3f359680f724c.png" alt="q_{rgwl}"/> .) The
snowpack is updated for frost and sublimation:</p>
<div class="math" id="equation-12.61">
<p><span class="eqno">(61)<a class="headerlink" href="#equation-12.61" title="Permalink to this equation">¶</a></span><img src="../../_images/math/e045024b51cac54cc64334ca3e09ac2dce28f282.png" alt="W_{sno} =W_{sno} +\Delta t\left(q_{frost} -q_{sub,sno} \right) ."/></p>
</div><p>If there are resolved snow layers, then this update occurs using the Snow
Hydrology submodel (Chapter <a class="reference internal" href="../Snow_Hydrology/CLM50_Tech_Note_Snow_Hydrology.html#rst-snow-hydrology"><span class="std std-numref">8</span></a>). Otherwise, the
snow ice mass is updated directly, and <img class="math" src="../../_images/math/c93c3a1834f19d010eeafd4cd70822a3d8d2cbe0.png" alt="z_{sno}"/> is adjusted by the same
proportion as the snow ice (i.e., maintaining the same density), unless
there was no snow before adding the frost, in which case the density is
assumed to be 250 kg m<sup>-3</sup>.</p>
</div>
<div class="section" id="soil-hydrology">
<span id="soil-hydrology-lake"></span><h3>12.6.4. Soil Hydrology<a class="headerlink" href="#soil-hydrology" title="Permalink to this headline">¶</a></h3>
<p>The combined water and ice soil volume fraction in a soil layer
<img class="math" src="../../_images/math/d361e948ee087b03ae6d55eb9f42e1c98f1fb517.png" alt="\theta _{i}"/>  is given by</p>
<div class="math" id="equation-12.62">
<p><span class="eqno">(62)<a class="headerlink" href="#equation-12.62" title="Permalink to this equation">¶</a></span><img src="../../_images/math/d64ee1e680dba54ffa44b7f9b15a6fd39ea4b2a6.png" alt="\theta _{i} =\frac{1}{\Delta z_{i} } \left(\frac{w_{ice,i} }{\rho _{ice} } +\frac{w_{liq,i} }{\rho _{liq} } \right) ."/></p>
</div><p>If <img class="math" src="../../_images/math/8db30005a0110c045b9f8b2e4481e5a9a0c3702a.png" alt="\theta _{i} &lt;\theta _{sat,i}"/>  , the pore volume fraction at
saturation (as may occur when ice melts), then the liquid water mass is
adjusted to</p>
<div class="math" id="equation-12.63">
<p><span class="eqno">(63)<a class="headerlink" href="#equation-12.63" title="Permalink to this equation">¶</a></span><img src="../../_images/math/d3d03cf034e3aa2fa618ec8bb15d3863e30043d9.png" alt="w_{liq,i} =\left(\theta _{sat,i} \Delta z_{i} -\frac{w_{ice,i} }{\rho _{ice} } \right)\rho _{liq}  ."/></p>
</div><p>Otherwise, if excess ice is melting and
<img class="math" src="../../_images/math/a8943e9b04af64b6213e65940263fea90ed80e3c.png" alt="w_{liq,i} &gt;\theta _{sat,i} \rho _{liq} \Delta z_{i}"/>  , then the
water in the layer is reset to</p>
<div class="math" id="equation-12.64">
<p><span class="eqno">(64)<a class="headerlink" href="#equation-12.64" title="Permalink to this equation">¶</a></span><img src="../../_images/math/22c4901fbbb374b5311968a0a674f08770517bb0.png" alt="w_{liq,i} = \theta _{sat,i} \rho _{liq} \Delta z_{i}"/></p>
</div><p>This allows excess ice to be initialized (and begin to be lost only
after the pore ice is melted, which is realistic if the excess ice is
found in heterogeneous chunks) but irreversibly lost when melt occurs.</p>
</div>
<div class="section" id="modifications-to-snow-layer-logic">
<span id="modifications-to-snow-layer-logic-lake"></span><h3>12.6.5. Modifications to Snow Layer Logic<a class="headerlink" href="#modifications-to-snow-layer-logic" title="Permalink to this headline">¶</a></h3>
<p>A thickness difference <img class="math" src="../../_images/math/7234711dd903a501c58929109ddd908db6d6098e.png" alt="z_{lsa} =s_{\min } -\tilde{s}_{\min }"/>
adjusts the minimum resolved snow layer thickness for lake columns as
compared to non-lake columns. The value of <img class="math" src="../../_images/math/cad4fdadaa7f55583357726af510ab8bdf4d20fa.png" alt="z_{lsa}"/>  is chosen to
satisfy the CFL condition for the model timestep. By default,
<img class="math" src="../../_images/math/33023946221e09fb8d8b0d129a428c5c5c584e10.png" alt="\tilde{s}_{\min }"/> = 1 cm and <img class="math" src="../../_images/math/c51cd18261e8f8c9fd1795e3f79d779a4a29a0ce.png" alt="s_{\min }"/> = 4 cm. See
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#subinetal2012a"><span class="std std-ref">Subin et al. (2012a; including Supporting Information)</span></a>
for further discussion.</p>
<p>The rules for combining and sub-dividing snow layers (section
<a class="reference internal" href="../Snow_Hydrology/CLM50_Tech_Note_Snow_Hydrology.html#snow-layer-combination-and-subdivision"><span class="std std-numref">8.7</span></a>) are
adjusted for lakes to maintain minimum thicknesses of <img class="math" src="../../_images/math/c51cd18261e8f8c9fd1795e3f79d779a4a29a0ce.png" alt="s_{\min }"/>
and to increase all target layer thicknesses by <img class="math" src="../../_images/math/cad4fdadaa7f55583357726af510ab8bdf4d20fa.png" alt="z_{lsa}"/> . The
rules for combining layers are modified by simply increasing layer
thickness thresholds by <img class="math" src="../../_images/math/cad4fdadaa7f55583357726af510ab8bdf4d20fa.png" alt="z_{lsa}"/> . The rules for dividing snow
layers are contained in a separate subroutine that is modified for
lakes, and is a function of the number of layers and the layer
thicknesses. There are two types of operations: (a) subdividing layers
in half, and (b) shifting some volume from higher layers to lower layers
(without increasing the layer number). For subdivisions of type (a), the
thickness thresholds triggering subdivision are increased by
<img class="math" src="../../_images/math/9776c439ed5358504d0bffe01f7ba81697ed4e99.png" alt="2z_{lsa}"/>  for lakes. For shifts of type (b), the thickness
thresholds triggering the shifts are increased by <img class="math" src="../../_images/math/cad4fdadaa7f55583357726af510ab8bdf4d20fa.png" alt="z_{lsa}"/> . At
the end of the modified subroutine, a snow ice and liquid balance check
are performed.</p>
<p>In rare instances, resolved snow layers may be present over an unfrozen
top lake body layer. In this case, the snow layers may be eliminated if
enough heat is present in the top layer to melt the snow: see
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#subinetal2012a"><span class="std std-ref">Subin et al. (2012a, Supporting Information)</span></a>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../Glacier/CLM50_Tech_Note_Glacier.html" title="13. Glaciers"
             >next</a> |</li>
        <li class="right" >
          <a href="../Plant_Hydraulics/CLM50_Tech_Note_Plant_Hydraulics.html" title="11. Plant Hydraulics"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">clmdoc  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >CLM Technical Note</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Erik Kluzek, Bill Sacks, Ben Andre.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>