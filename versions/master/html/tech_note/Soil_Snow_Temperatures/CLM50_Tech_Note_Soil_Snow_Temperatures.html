

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2.6. Soil and Snow Temperatures &mdash; ctsm CTSM master documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="ctsm CTSM master documentation" href="../../index.html"/>
        <link rel="up" title="2. CLM Technical Note" href="../index.html"/>
        <link rel="next" title="2.7. Hydrology" href="../Hydrology/CLM50_Tech_Note_Hydrology.html"/>
        <link rel="prev" title="2.5. Momentum, Sensible Heat, and Latent Heat Fluxes" href="../Fluxes/CLM50_Tech_Note_Fluxes.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> ctsm
          

          
          </a>

          
            
            
              <div class="version">
                
                  <div class="version-dropdown">
                    <select class="version-list" id="version-list">
                      <option value=''>CTSM1</option>
                      
                        
                      
                        
                          <option value="">[placeholder]</option>
                        
                      
                    </select>
                  </div>
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/index.html">1. CTSM1 User’s Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">2. CLM Technical Note</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Introduction/CLM50_Tech_Note_Introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html">2.2. Surface Characterization, Vertical Discretization, and Model Input Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Surface_Albedos/CLM50_Tech_Note_Surface_Albedos.html">2.3. Surface Albedos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Radiative_Fluxes/CLM50_Tech_Note_Radiative_Fluxes.html">2.4. Radiative Fluxes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html">2.5. Momentum, Sensible Heat, and Latent Heat Fluxes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.6. Soil and Snow Temperatures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#numerical-solution">2.6.1. Numerical Solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#phase-change">2.6.2. Phase Change</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#soil-and-snow-layers">2.6.2.1. Soil and Snow Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#surface-water">2.6.2.2. Surface Water</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#soil-and-snow-thermal-properties">2.6.3. Soil and Snow Thermal Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="#excess-ground-ice">2.6.4. Excess Ground Ice</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Hydrology/CLM50_Tech_Note_Hydrology.html">2.7. Hydrology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Snow_Hydrology/CLM50_Tech_Note_Snow_Hydrology.html">2.8. Snow Hydrology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Photosynthesis/CLM50_Tech_Note_Photosynthesis.html">2.9. Stomatal Resistance and Photosynthesis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Photosynthetic_Capacity/CLM50_Tech_Note_Photosynthetic_Capacity.html">2.10. Photosynthetic Capacity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Plant_Hydraulics/CLM50_Tech_Note_Plant_Hydraulics.html">2.11. Plant Hydraulics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lake/CLM50_Tech_Note_Lake.html">2.12. Lake Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Glacier/CLM50_Tech_Note_Glacier.html">2.13. Glaciers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MOSART/CLM50_Tech_Note_MOSART.html">2.14. Model for Scale Adaptive River Transport (MOSART)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Urban/CLM50_Tech_Note_Urban.html">2.15. Urban Model (CLMU)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CN_Pools/CLM50_Tech_Note_CN_Pools.html">2.16. CN Pools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Plant_Respiration/CLM50_Tech_Note_Plant_Respiration.html">2.17. Plant Respiration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../FUN/CLM50_Tech_Note_FUN.html">2.18. Fixation and Uptake of Nitrogen (FUN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CN_Allocation/CLM50_Tech_Note_CN_Allocation.html">2.19. Carbon and Nitrogen Allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Vegetation_Phenology_Turnover/CLM50_Tech_Note_Vegetation_Phenology_Turnover.html">2.20. Vegetation Phenology and Turnover</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Decomposition/CLM50_Tech_Note_Decomposition.html">2.21. Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../External_Nitrogen_Cycle/CLM50_Tech_Note_External_Nitrogen_Cycle.html">2.22. External Nitrogen Cycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Plant_Mortality/CLM50_Tech_Note_Plant_Mortality.html">2.23. Plant Mortality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Fire/CLM50_Tech_Note_Fire.html">2.24. Fire</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Methane/CLM50_Tech_Note_Methane.html">2.25. Methane Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Crop_Irrigation/CLM50_Tech_Note_Crop_Irrigation.html">2.26. Crops and Irrigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Transient_Landcover/CLM50_Tech_Note_Transient_Landcover.html">2.27. Transient Land Use and Land Cover Change</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DGVM/CLM50_Tech_Note_DGVM.html">2.28. Dynamic Global Vegetation and FATES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../BVOCs/CLM50_Tech_Note_BVOCs.html">2.29. Biogenic Volatile Organic Compounds (BVOCs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Dust/CLM50_Tech_Note_Dust.html">2.30. Dust Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Isotopes/CLM50_Tech_Note_Isotopes.html">2.31. Carbon Isotopes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Land-Only_Mode/CLM50_Tech_Note_Land-Only_Mode.html">2.32. Land-Only Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../References/CLM50_Tech_Note_References.html">2.33. References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lilac/index.html">3. CTSM-LILAC User’s Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ctsm</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html"><span class="section-number">2. </span>CLM Technical Note</a> &raquo;</li>
        
      <li><span class="section-number">2.6. </span>Soil and Snow Temperatures</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tech_note/Soil_Snow_Temperatures/CLM50_Tech_Note_Soil_Snow_Temperatures.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="soil-and-snow-temperatures">
<span id="rst-soil-and-snow-temperatures"></span><h1><span class="section-number">2.6. </span>Soil and Snow Temperatures<a class="headerlink" href="#soil-and-snow-temperatures" title="Permalink to this headline">¶</a></h1>
<p>The first law of heat conduction is</p>
<div class="math notranslate nohighlight" id="equation-6-1">
<span class="eqno">(2.6.1)<a class="headerlink" href="#equation-6-1" title="Permalink to this equation">¶</a></span>\[F=-\lambda \nabla T\]</div>
<p>where <span class="math notranslate nohighlight">\(F\)</span> is the amount of heat conducted across a unit cross-sectional area in unit time (W m<sup>-2</sup>), <span class="math notranslate nohighlight">\(\lambda\)</span> is thermal conductivity (W m<sup>-1</sup> K<sup>-1</sup>), and <span class="math notranslate nohighlight">\(\nabla T\)</span> is the spatial gradient of temperature (K m<sup>-1</sup>). In one-dimensional form</p>
<div class="math notranslate nohighlight" id="equation-6-2">
<span class="eqno">(2.6.2)<a class="headerlink" href="#equation-6-2" title="Permalink to this equation">¶</a></span>\[F_{z} =-\lambda \frac{\partial T}{\partial z}\]</div>
<p>where <span class="math notranslate nohighlight">\(z\)</span> is in the vertical direction (m) and is positive downward and <span class="math notranslate nohighlight">\(F_{z}\)</span> is positive upward. To account for non-steady or transient conditions, the principle of energy conservation in the form of the continuity equation is invoked as</p>
<div class="math notranslate nohighlight" id="equation-6-3">
<span class="eqno">(2.6.3)<a class="headerlink" href="#equation-6-3" title="Permalink to this equation">¶</a></span>\[c\frac{\partial T}{\partial t} =-\frac{\partial F_{z} }{\partial z}\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> is the volumetric snow/soil heat capacity (J m<sup>-3</sup> K<sup>-1</sup>) and <span class="math notranslate nohighlight">\(t\)</span> is time (s). Combining equations and yields the second law of heat conduction in one-dimensional form</p>
<div class="math notranslate nohighlight" id="equation-6-4">
<span class="eqno">(2.6.4)<a class="headerlink" href="#equation-6-4" title="Permalink to this equation">¶</a></span>\[c\frac{\partial T}{\partial t} =\frac{\partial }{\partial z} \left[\lambda \frac{\partial T}{\partial z} \right].\]</div>
<p>This equation is solved numerically to calculate the soil, snow, and surface water temperatures for a 25-layer soil column with up to twelve overlying layers of snow and a single surface water layer with the boundary conditions of <span class="math notranslate nohighlight">\(h\)</span> as the heat flux into the top soil, snow, and surface water layers from the overlying atmosphere (section <a class="reference internal" href="#numerical-solution-temperature"><span class="std std-numref">2.6.1</span></a>) and zero heat flux at the bottom of the soil column. The temperature profile is calculated first without phase change and then readjusted for phase change (section <a class="reference internal" href="#phase-change"><span class="std std-numref">2.6.2</span></a>).</p>
<div class="section" id="numerical-solution">
<span id="numerical-solution-temperature"></span><h2><span class="section-number">2.6.1. </span>Numerical Solution<a class="headerlink" href="#numerical-solution" title="Permalink to this headline">¶</a></h2>
<p>The soil column is discretized into 25 layers (section <a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#vertical-discretization"><span class="std std-numref">2.2.2</span></a>) where <span class="math notranslate nohighlight">\(N_{levgrnd} = 25\)</span> is the number of soil layers (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-soil-layer-structure"><span class="std std-numref">Table 2.2.3</span></a>).</p>
<p>The overlying snow pack is modeled with up to twelve layers depending on the total snow depth. The layers from top to bottom are indexed in the Fortran code as <span class="math notranslate nohighlight">\(i=-4,-3,-2,-1,0\)</span>, which permits the accumulation or ablation of snow at the top of the snow pack without renumbering the layers. Layer <span class="math notranslate nohighlight">\(i=0\)</span> is the snow layer next to the soil surface and layer <span class="math notranslate nohighlight">\(i=snl+1\)</span> is the top layer, where the variable <span class="math notranslate nohighlight">\(snl\)</span> is the negative of the number of snow layers. The number of snow layers and the thickness of each layer is a function of snow depth <span class="math notranslate nohighlight">\(z_{sno}\)</span> (m) as follows.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{ \begin{array}{l}
snl=-1 \\
\Delta z_{0} = z_{sno}
\end{array} \right\} &amp; \qquad {\rm for\; 0.01}\le {\rm z}_{{\rm sno}} \le 0.03 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{ \begin{array}{l}
snl=-2  \\
\Delta z_{-1} ={z_{sno} \mathord{\left/ {\vphantom {z_{sno}  2}} \right.} 2} \\
\Delta z_{0} = \Delta z_{-1}
\end{array} \right\} &amp; \qquad {\rm for\; 0.03}\, {\rm &lt;}\, {\rm z}_{{\rm sno}} \le 0.04 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{ \begin{array}{l}
snl=-2 \\
\Delta z_{-1} = 0.02 \\
\Delta z_{0} = z_{sno} -\Delta z_{-1}
\end{array} \right\} &amp; \qquad {\rm for\; 0.04}\, {\rm &lt;}\, {\rm z}_{{\rm sno}} \le 0.07 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{ \begin{array}{l}
snl=-3 \\
\Delta z_{-2} = 0.02 \\
\Delta z_{-1} = {\left(z_{sno} -0.02\right)\mathord{\left/ {\vphantom {\left(z_{sno} -0.02\right) 2}} \right.} 2} \\
\Delta z_{0} = \Delta z_{-1}
\end{array} \right\} &amp; \qquad {\rm for\; 0.07}\, {\rm &lt;}\, {\rm z}_{{\rm sno}} \le 0.12 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{ \begin{array}{l}
snl=-3 \\
\Delta z_{-2} = 0.02 \\
\Delta z_{-1} = 0.05 \\
\Delta z_{0} = z_{sno} -\Delta z_{-2} -\Delta z_{-1}
\end{array} \right\} &amp; \qquad {\rm for\; 0.12}\, {\rm &lt;}\, {\rm z}_{{\rm sno}} \le 0.18 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{ \begin{array}{l}
snl=-4  \\
\Delta z_{-3} = 0.02 \\
\Delta z_{-2} = 0.05 \\
\Delta z_{-1} = {\left(z_{sno} -\Delta z_{-3} -\Delta z_{-2} \right)\mathord{\left/ {\vphantom {\left(z_{sno} -\Delta z_{-3} -\Delta z_{-2} \right) 2}} \right.} 2}  \\
\Delta z_{0} =\Delta z_{-1}
\end{array} \right\} &amp; \qquad {\rm for\; 0.18}\, {\rm &lt;}\, {\rm z}_{{\rm sno}} \le 0.29 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{ \begin{array}{l}
snl=-4 \\
\Delta z_{-3} = 0.02  \\
\Delta z_{-2} = 0.05  \\
\Delta z_{-1} = 0.11  \\
\Delta z_{0} = z_{sno} -\Delta z_{-3} -\Delta z_{-2} -\Delta z_{-1}
\end{array} \right\} &amp; \qquad {\rm for\; 0.29}\, {\rm &lt;}\, {\rm z}_{{\rm sno}} \le 0.41 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{ \begin{array}{l}
snl=-5  \\
\Delta z_{-4} = 0.02  \\
\Delta z_{-3} = 0.05  \\
\Delta z_{-2} = 0.11  \\
\Delta z_{-1} = {\left(z_{sno} -\Delta z_{-4} -\Delta z_{-3} -\Delta z_{-2} \right)\mathord{\left/ {\vphantom {\left(z_{sno} -\Delta z_{-4} -\Delta z_{-3} -\Delta z_{-2} \right) 2}} \right.} 2}  \\
\Delta z_{0} = \Delta z_{-1}
\end{array} \right\} &amp; \qquad {\rm for\; 0.41}\, {\rm &lt;}\, {\rm z}_{{\rm sno}} \le 0.64 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{ \begin{array}{l}
snl=-5 \\
\Delta z_{-4} = 0.02  \\
\Delta z_{-3} = 0.05  \\
\Delta z_{-2} = 0.11  \\
\Delta z_{-1} = 0.23  \\
\Delta z_{0} = z_{sno} -\Delta z_{-4} -\Delta z_{-3} -\Delta z_{-2} -\Delta z_{-1}
\end{array} \right\} &amp; \qquad {\rm for\; 0.64}\, {\rm &lt;}\, {\rm z}_{{\rm sno}}\end{split}\]</div>
<p>The node depths, which are located at the midpoint of the snow layers, and the layer interfaces are both referenced from the soil surface and are defined as negative values</p>
<div class="math notranslate nohighlight" id="equation-6-8">
<span class="eqno">(2.6.5)<a class="headerlink" href="#equation-6-8" title="Permalink to this equation">¶</a></span>\[z_{i} =z_{h,\, i} -0.5\Delta z_{i} \qquad i=snl+1,\ldots ,0\]</div>
<div class="math notranslate nohighlight" id="equation-6-9">
<span class="eqno">(2.6.6)<a class="headerlink" href="#equation-6-9" title="Permalink to this equation">¶</a></span>\[z_{h,\, i} =z_{h,\, i+1} -\Delta z_{i+1} \qquad i=snl,\ldots ,-1.\]</div>
<p>Note that <span class="math notranslate nohighlight">\(z_{h,\, 0}\)</span>, the interface between the bottom snow layer and the top soil layer, is zero. Thermal properties (i.e., temperature <span class="math notranslate nohighlight">\(T_{i}\)</span> [K]; thermal conductivity <span class="math notranslate nohighlight">\(\lambda _{i}\)</span> [W m<sup>-1</sup> K<sup>-1</sup>]; volumetric heat capacity <span class="math notranslate nohighlight">\(c_{i}\)</span> [J m<sup>-3</sup> K<sup>-1</sup>]) are defined for soil layers at the node depths (<a class="reference internal" href="#figure-soil-temperature-schematic"><span class="std std-numref">Figure 2.6.1</span></a>) and for snow layers at the layer midpoints. When present, snow occupies a fraction of a grid cell’s area, therefore snow depth represents the thickness of the snowpack averaged over only the snow covered area. The grid cell average snow depth is related to the depth of the snow covered area as <span class="math notranslate nohighlight">\(\bar{z}_{sno} =f_{sno} z_{sno}\)</span>. By default, the grid cell average snow depth is written to the history file.</p>
<p>The heat flux <span class="math notranslate nohighlight">\(F_{i}\)</span>  (W m<sup>-2</sup>) from layer <span class="math notranslate nohighlight">\(i\)</span>
to layer <span class="math notranslate nohighlight">\(i+1\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-6-10">
<span class="eqno">(2.6.7)<a class="headerlink" href="#equation-6-10" title="Permalink to this equation">¶</a></span>\[F_{i} =-\lambda \left[z_{h,\, i} \right]\left(\frac{T_{i} -T_{i+1} }{z_{i+1} -z_{i} } \right)\]</div>
<p>where the thermal conductivity at the interface <span class="math notranslate nohighlight">\(\lambda \left[z_{h,\, i} \right]\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-6-11">
<span class="eqno">(2.6.8)<a class="headerlink" href="#equation-6-11" title="Permalink to this equation">¶</a></span>\[\begin{split}\lambda \left[z_{h,\, i} \right]=\left\{\begin{array}{l} {\frac{\lambda _{i} \lambda _{i+1} \left(z_{i+1} -z_{i} \right)}{\lambda _{i} \left(z_{i+1} -z_{h,\, i} \right)+\lambda _{i+1} \left(z_{h,\, i} -z_{i} \right)} \qquad i=snl+1,\ldots ,N_{levgrnd} -1} \\ {0\qquad i=N_{levgrnd} } \end{array}\right\}.\end{split}\]</div>
<p>These equations are derived, with reference to <a class="reference internal" href="#figure-soil-temperature-schematic"><span class="std std-numref">Figure 2.6.1</span></a>, assuming that the heat flux from <span class="math notranslate nohighlight">\(i\)</span> (depth <span class="math notranslate nohighlight">\(z_{i}\)</span> ) to the interface between <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(i+1\)</span> (depth <span class="math notranslate nohighlight">\(z_{h,\, i}\)</span> ) equals the heat flux from the interface to <span class="math notranslate nohighlight">\(i+1\)</span> (depth <span class="math notranslate nohighlight">\(z_{i+1}\)</span> ), i.e.,</p>
<div class="math notranslate nohighlight" id="equation-6-12">
<span class="eqno">(2.6.9)<a class="headerlink" href="#equation-6-12" title="Permalink to this equation">¶</a></span>\[-\lambda _{i} \frac{T_{i} -T_{m} }{z_{h,\, i} -z_{i} } =-\lambda _{i+1} \frac{T_{m} -T_{i+1} }{z_{i+1} -z_{h,\, i} }\]</div>
<p>where <span class="math notranslate nohighlight">\(T_{m}\)</span> is the temperature at the interface of layers <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(i+1\)</span>.</p>
<p>Shown are three soil layers, <span class="math notranslate nohighlight">\(i-1\)</span>, <span class="math notranslate nohighlight">\(i\)</span>, and <span class="math notranslate nohighlight">\(i+1\)</span>. The thermal conductivity <span class="math notranslate nohighlight">\(\lambda\)</span>, specific heat capacity <span class="math notranslate nohighlight">\(c\)</span>, and temperature <span class="math notranslate nohighlight">\(T\)</span> are defined at the layer node depth <span class="math notranslate nohighlight">\(z\)</span>. <span class="math notranslate nohighlight">\(T_{m}\)</span> is the interface temperature. The thermal conductivity <span class="math notranslate nohighlight">\(\lambda \left[z_{h} \right]\)</span> is defined at the interface of two layers <span class="math notranslate nohighlight">\(z_{h}\)</span>. The layer thickness is <span class="math notranslate nohighlight">\(\Delta z\)</span>. The heat fluxes <span class="math notranslate nohighlight">\(F_{i-1}\)</span> and <span class="math notranslate nohighlight">\(F_{i}\)</span> are defined as positive upwards.</p>
<div class="figure align-default" id="id6">
<span id="figure-soil-temperature-schematic"></span><img alt="../../_images/image17.png" src="../../_images/image17.png" />
<p class="caption"><span class="caption-number">Figure 2.6.1 </span><span class="caption-text">Schematic diagram of numerical scheme used to solve for soil temperature.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<p>The energy balance for the <span class="math notranslate nohighlight">\(i^{th}\)</span>  layer is</p>
<div class="math notranslate nohighlight" id="equation-6-13">
<span class="eqno">(2.6.10)<a class="headerlink" href="#equation-6-13" title="Permalink to this equation">¶</a></span>\[\frac{c_{i} \Delta z_{i} }{\Delta t} \left(T_{i}^{n+1} -T_{i}^{n} \right)=-F_{i-1} +F_{i}\]</div>
<p>where the superscripts <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(n+1\)</span> indicate values at the beginning and end of the time step, respectively, and <span class="math notranslate nohighlight">\(\Delta t\)</span> is the time step (s). This equation is solved using the Crank-Nicholson method, which combines the explicit method with fluxes evaluated at <span class="math notranslate nohighlight">\(n\)</span> (<span class="math notranslate nohighlight">\(F_{i-1}^{n},F_{i}^{n}\)</span> ) and the implicit method with fluxes evaluated at <span class="math notranslate nohighlight">\(n+1\)</span> (<span class="math notranslate nohighlight">\(F_{i-1}^{n+1},F_{i}^{n+1}\)</span> )</p>
<div class="math notranslate nohighlight" id="equation-6-14">
<span class="eqno">(2.6.11)<a class="headerlink" href="#equation-6-14" title="Permalink to this equation">¶</a></span>\[\frac{c_{i} \Delta z_{i} }{\Delta t} \left(T_{i}^{n+1} -T_{i}^{n} \right)=\alpha \left(-F_{i-1}^{n} +F_{i}^{n} \right)+\left(1-\alpha \right)\left(-F_{i-1}^{n+1} +F_{i}^{n+1} \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha =0.5\)</span>, resulting in a tridiagonal system of equations</p>
<div class="math notranslate nohighlight" id="equation-6-15">
<span class="eqno">(2.6.12)<a class="headerlink" href="#equation-6-15" title="Permalink to this equation">¶</a></span>\[r_{i} =a_{i} T_{i-1}^{n+1} +b_{i} T_{i}^{n+1} +c_{i} T_{i+1}^{n+1}\]</div>
<p>where <span class="math notranslate nohighlight">\(a_{i}\)</span>, <span class="math notranslate nohighlight">\(b_{i}\)</span>, and <span class="math notranslate nohighlight">\(c_{i}\)</span> are the subdiagonal, diagonal, and superdiagonal elements in the tridiagonal matrix and <span class="math notranslate nohighlight">\(r_{i}\)</span> is a column vector of constants. When surface water is present, the equation for the top soil layer has an additional term representing the surface water temperature; this results in a four element band-diagonal system of equations.</p>
<p>For the top soil layer <span class="math notranslate nohighlight">\(i=1\)</span>, top snow layer <span class="math notranslate nohighlight">\(i=snl+1\)</span>, or surface water layer, the heat flux from the overlying atmosphere <span class="math notranslate nohighlight">\(h\)</span> (W m<sup>-2</sup>, defined as positive into the surface) is</p>
<div class="math notranslate nohighlight" id="equation-6-16">
<span class="eqno">(2.6.13)<a class="headerlink" href="#equation-6-16" title="Permalink to this equation">¶</a></span>\[h^{n+1} =-\alpha F_{i-1}^{n} -\left(1-\alpha \right)F_{i-1}^{n+1} .\]</div>
<p>The energy balance for these layers is then</p>
<div class="math notranslate nohighlight" id="equation-6-17">
<span class="eqno">(2.6.14)<a class="headerlink" href="#equation-6-17" title="Permalink to this equation">¶</a></span>\[\frac{c_{i} \Delta z_{i} }{\Delta t} \left(T_{i}^{n+1} -T_{i}^{n} \right)=h^{n+1} +\alpha F_{i}^{n} +\left(1-\alpha \right)F_{i}^{n+1} .\]</div>
<p>The heat flux <span class="math notranslate nohighlight">\(h\)</span> at <span class="math notranslate nohighlight">\(n+1\)</span> may be approximated as follows</p>
<div class="math notranslate nohighlight" id="equation-6-18">
<span class="eqno">(2.6.15)<a class="headerlink" href="#equation-6-18" title="Permalink to this equation">¶</a></span>\[h^{n+1} =h^{n} +\frac{\partial h}{\partial T_{i} } \left(T_{i}^{n+1} -T_{i}^{n} \right).\]</div>
<p>The resulting equations are then</p>
<div class="math notranslate nohighlight" id="equation-6-19">
<span class="eqno">(2.6.16)<a class="headerlink" href="#equation-6-19" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{rcl} {\frac{c_{i} \Delta z_{i} }{\Delta t} \left(T_{i}^{n+1} -T_{i}^{n} \right)} &amp; {=} &amp; {h^{n} +\frac{\partial h}{\partial T_{i} } \left(T_{i}^{n+1} -T_{i} \right)} \\ {} &amp; {} &amp; {-\alpha \frac{\lambda \left[z_{h,\, i} \right]\left(T_{i}^{n} -T_{i+1}^{n} \right)}{z_{i+1} -z_{i} } -\left(1-\alpha \right)\frac{\lambda \left[z_{h,\, i} \right]\left(T_{i}^{n+1} -T_{i+1}^{n+1} \right)}{z_{i+1} -z_{i} } } \end{array}\end{split}\]</div>
<p>For the top snow layer, <span class="math notranslate nohighlight">\(i=snl+1\)</span>, the coefficients are</p>
<div class="math notranslate nohighlight" id="equation-6-20">
<span class="eqno">(2.6.17)<a class="headerlink" href="#equation-6-20" title="Permalink to this equation">¶</a></span>\[a_{i} =0\]</div>
<div class="math notranslate nohighlight" id="equation-6-21">
<span class="eqno">(2.6.18)<a class="headerlink" href="#equation-6-21" title="Permalink to this equation">¶</a></span>\[b_{i} =1+\frac{\Delta t}{c_{i} \Delta z_{i} } \left[\left(1-\alpha \right)\frac{\lambda \left[z_{h,\, i} \right]}{z_{i+1} -z_{i} } -\frac{\partial h}{\partial T_{i} } \right]\]</div>
<div class="math notranslate nohighlight" id="equation-6-22">
<span class="eqno">(2.6.19)<a class="headerlink" href="#equation-6-22" title="Permalink to this equation">¶</a></span>\[c_{i} =-\left(1-\alpha \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \frac{\lambda \left[z_{h,\, i} \right]}{z_{i+1} -z_{i} }\]</div>
<div class="math notranslate nohighlight" id="equation-6-23">
<span class="eqno">(2.6.20)<a class="headerlink" href="#equation-6-23" title="Permalink to this equation">¶</a></span>\[r_{i} =T_{i}^{n} +\frac{\Delta t}{c_{i} \Delta z_{i} } \left[h_{sno} ^{n} -\frac{\partial h}{\partial T_{i} } T_{i}^{n} +\alpha F_{i} \right]\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-6-24">
<span class="eqno">(2.6.21)<a class="headerlink" href="#equation-6-24" title="Permalink to this equation">¶</a></span>\[F_{i} =-\lambda \left[z_{h,\, i} \right]\left(\frac{T_{i}^{n} -T_{i+1}^{n} }{z_{i+1} -z_{i} } \right).\]</div>
<p>The heat flux into the snow surface from the overlying atmosphere <span class="math notranslate nohighlight">\(h\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-6-25">
<span class="eqno">(2.6.22)<a class="headerlink" href="#equation-6-25" title="Permalink to this equation">¶</a></span>\[h=\overrightarrow{S}_{sno} -\overrightarrow{L}_{sno} -H_{sno} -\lambda E_{sno}\]</div>
<p>where <span class="math notranslate nohighlight">\(\overrightarrow{S}_{sno}\)</span> is the solar radiation absorbed by the top snow layer (section <a class="reference internal" href="../Surface_Albedos/CLM50_Tech_Note_Surface_Albedos.html#snow-albedo"><span class="std std-numref">2.3.2.1</span></a>), <span class="math notranslate nohighlight">\(\overrightarrow{L}_{sno}\)</span> is the longwave radiation absorbed by the snow (positive toward the atmosphere) (section <a class="reference internal" href="../Radiative_Fluxes/CLM50_Tech_Note_Radiative_Fluxes.html#longwave-fluxes"><span class="std std-numref">2.4.2</span></a>), <span class="math notranslate nohighlight">\(H_{sno}\)</span> is the sensible heat flux from the snow (Chapter <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#rst-momentum-sensible-heat-and-latent-heat-fluxes"><span class="std std-numref">2.5</span></a>), and <span class="math notranslate nohighlight">\(\lambda E_{sno}\)</span> is the latent heat flux from the snow (Chapter <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#rst-momentum-sensible-heat-and-latent-heat-fluxes"><span class="std std-numref">2.5</span></a>). The partial derivative of the heat flux <span class="math notranslate nohighlight">\(h\)</span> with respect to temperature is</p>
<div class="math notranslate nohighlight" id="equation-6-26">
<span class="eqno">(2.6.23)<a class="headerlink" href="#equation-6-26" title="Permalink to this equation">¶</a></span>\[\frac{\partial h}{\partial T_{} } =-\frac{\partial \overrightarrow{L}_{} }{\partial T_{} } -\frac{\partial H_{} }{\partial T_{} } -\frac{\partial \lambda E_{} }{\partial T_{} }\]</div>
<p>where the partial derivative of the net longwave radiation is</p>
<div class="math notranslate nohighlight" id="equation-6-27">
<span class="eqno">(2.6.24)<a class="headerlink" href="#equation-6-27" title="Permalink to this equation">¶</a></span>\[\frac{\partial \overrightarrow{L}_{} }{\partial T_{} } =4\varepsilon _{g} \sigma \left(T_{}^{n} \right)^{3}\]</div>
<p>and the partial derivatives of the sensible and latent heat fluxes are given by equations and for non-vegetated surfaces, and by equations and for vegetated surfaces. <span class="math notranslate nohighlight">\(\sigma\)</span> is the Stefan-Boltzmann constant (W m<sup>-2</sup> K<sup>-4</sup>) (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.2.7</span></a>) and <span class="math notranslate nohighlight">\(\varepsilon _{g}\)</span> is the ground emissivity (section <a class="reference internal" href="../Radiative_Fluxes/CLM50_Tech_Note_Radiative_Fluxes.html#longwave-fluxes"><span class="std std-numref">2.4.2</span></a>). For purposes of computing <span class="math notranslate nohighlight">\(h\)</span> and <span class="math notranslate nohighlight">\(\frac{\partial h}{\partial T_{g} }\)</span>, the term <span class="math notranslate nohighlight">\(\lambda\)</span> is arbitrarily assumed to be</p>
<div class="math notranslate nohighlight" id="equation-6-28">
<span class="eqno">(2.6.25)<a class="headerlink" href="#equation-6-28" title="Permalink to this equation">¶</a></span>\[\begin{split}\lambda =\left\{\begin{array}{l} {\lambda _{sub} \qquad {\rm if\; }w_{liq,\, snl+1} =0{\rm \; and\; }w_{ice,\, snl+1} &gt;0} \\ {\lambda _{vap} \qquad {\rm otherwise}} \end{array}\right\}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda _{sub}\)</span> and <span class="math notranslate nohighlight">\(\lambda _{vap}\)</span> are the latent heat of sublimation and vaporization, respectively (J kg<sup>-1</sup>) (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.2.7</span></a>), and <span class="math notranslate nohighlight">\(w_{liq,\, snl+1}\)</span> and <span class="math notranslate nohighlight">\(w_{ice,\, snl+1}\)</span> are the liquid water and ice contents of the top snow/soil layer, respectively (kg m<sup>-2</sup>) (Chapter <a class="reference internal" href="../Hydrology/CLM50_Tech_Note_Hydrology.html#rst-hydrology"><span class="std std-numref">2.7</span></a>).</p>
<p>For the top soil layer, <span class="math notranslate nohighlight">\(i=1\)</span>, the coefficients are</p>
<div class="math notranslate nohighlight" id="equation-6-29">
<span class="eqno">(2.6.26)<a class="headerlink" href="#equation-6-29" title="Permalink to this equation">¶</a></span>\[a_{i} =-f_{sno} \left(1-\alpha \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \frac{\lambda \left[z_{h,\, i-1} \right]}{z_{i} -z_{i-1} }\]</div>
<div class="math notranslate nohighlight" id="equation-6-30">
<span class="eqno">(2.6.27)<a class="headerlink" href="#equation-6-30" title="Permalink to this equation">¶</a></span>\[b_{i} =1+\left(1-\alpha \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \left[f_{sno} \frac{\lambda \left[z_{h,\, i-1} \right]}{z_{i} -z_{i-1} } +\frac{\lambda \left[z_{h,\, i} \right]}{z_{i+1} -z_{i} } \right]-\left(1-f_{sno} \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \frac{\partial h}{\partial T}\]</div>
<div class="math notranslate nohighlight" id="equation-6-31">
<span class="eqno">(2.6.28)<a class="headerlink" href="#equation-6-31" title="Permalink to this equation">¶</a></span>\[c_{i} =-\left(1-\alpha \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \frac{\lambda \left[z_{h,\, i} \right]}{z_{i+1} -z_{i} }\]</div>
<div class="math notranslate nohighlight" id="equation-6-32">
<span class="eqno">(2.6.29)<a class="headerlink" href="#equation-6-32" title="Permalink to this equation">¶</a></span>\[r_{i} =T_{i}^{n} +\frac{\Delta t}{c_{i} \Delta z_{i} } \left[\left(1-f_{sno} \right)\left(h_{soil} ^{n} -\frac{\partial h}{\partial T_{} } T_{i}^{n} \right)+\alpha \left(F_{i} -f_{sno} F_{i-1} \right)\right]\]</div>
<p>The heat flux into the soil surface from the overlying atmosphere
<span class="math notranslate nohighlight">\(h\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-6-33">
<span class="eqno">(2.6.30)<a class="headerlink" href="#equation-6-33" title="Permalink to this equation">¶</a></span>\[h=\overrightarrow{S}_{soil} -\overrightarrow{L}_{soil} -H_{soil} -\lambda E_{soil}\]</div>
<p>It can be seen that when no snow is present (<span class="math notranslate nohighlight">\(f_{sno} =0\)</span>), the expressions for the coefficients of the top soil layer have the same form as those for the top snow layer.</p>
<p>The surface snow/soil layer temperature computed in this way is the layer-averaged temperature and hence has somewhat reduced diurnal amplitude compared with surface temperature. An accurate surface temperature is provided that compensates for this effect and numerical error by tuning the heat capacity of the top layer (through adjustment of the layer thickness) to give an exact match to the analytic solution for diurnal heating. The top layer thickness for <span class="math notranslate nohighlight">\(i=snl+1\)</span> is given by</p>
<div class="math notranslate nohighlight" id="equation-6-34">
<span class="eqno">(2.6.31)<a class="headerlink" href="#equation-6-34" title="Permalink to this equation">¶</a></span>\[\Delta z_{i*} =0.5\left[z_{i} -z_{h,\, i-1} +c_{a} \left(z_{i+1} -z_{h,\, i-1} \right)\right]\]</div>
<p>where <span class="math notranslate nohighlight">\(c_{a}\)</span> is a tunable parameter, varying from 0 to 1, and is taken as 0.34 by comparing the numerical solution with the analytic solution (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#yang1998"><span class="std std-ref">Z.-L. Yang 1998, unpublished manuscript</span></a>). <span class="math notranslate nohighlight">\(\Delta z_{i*}\)</span> is used in place of <span class="math notranslate nohighlight">\(\Delta z_{i}\)</span> for <span class="math notranslate nohighlight">\(i=snl+1\)</span> in equations -. The top snow/soil layer temperature computed in this way is the ground surface temperature <span class="math notranslate nohighlight">\(T_{g}^{n+1}\)</span>.</p>
<p>The boundary condition at the bottom of the snow/soil column is zero heat flux, <span class="math notranslate nohighlight">\(F_{i} =0\)</span>, resulting in, for <span class="math notranslate nohighlight">\(i=N_{levgrnd}\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-6-35">
<span class="eqno">(2.6.32)<a class="headerlink" href="#equation-6-35" title="Permalink to this equation">¶</a></span>\[\frac{c_{i} \Delta z_{i} }{\Delta t} \left(T_{i}^{n+1} -T_{i}^{n} \right)=\alpha \frac{\lambda \left[z_{h,\, i-1} \right]\left(T_{i-1}^{n} -T_{i}^{n} \right)}{z_{i} -z_{i-1} } +\left(1-\alpha \right)\frac{\lambda \left[z_{h,\, i-1} \right]\left(T_{i-1}^{n+1} -T_{i}^{n+1} \right)}{z_{i} -z_{i-1} }\]</div>
<div class="math notranslate nohighlight" id="equation-6-36">
<span class="eqno">(2.6.33)<a class="headerlink" href="#equation-6-36" title="Permalink to this equation">¶</a></span>\[a_{i} =-\left(1-\alpha \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \frac{\lambda \left[z_{h,\, i-1} \right]}{z_{i} -z_{i-1} }\]</div>
<div class="math notranslate nohighlight" id="equation-6-37">
<span class="eqno">(2.6.34)<a class="headerlink" href="#equation-6-37" title="Permalink to this equation">¶</a></span>\[b_{i} =1+\left(1-\alpha \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \frac{\lambda \left[z_{h,\, i-1} \right]}{z_{i} -z_{i-1} }\]</div>
<div class="math notranslate nohighlight" id="equation-6-38">
<span class="eqno">(2.6.35)<a class="headerlink" href="#equation-6-38" title="Permalink to this equation">¶</a></span>\[c_{i} =0\]</div>
<div class="math notranslate nohighlight" id="equation-6-39">
<span class="eqno">(2.6.36)<a class="headerlink" href="#equation-6-39" title="Permalink to this equation">¶</a></span>\[r_{i} =T_{i}^{n} -\alpha \frac{\Delta t}{c_{i} \Delta z_{i} } F_{i-1}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-6-40">
<span class="eqno">(2.6.37)<a class="headerlink" href="#equation-6-40" title="Permalink to this equation">¶</a></span>\[F_{i-1} =-\frac{\lambda \left[z_{h,\, i-1} \right]}{z_{i} -z_{i-1} } \left(T_{i-1}^{n} -T_{i}^{n} \right).\]</div>
<p>For the interior snow/soil layers, <span class="math notranslate nohighlight">\(snl+1&lt;i&lt;N_{levgrnd}\)</span>, excluding the top soil layer,</p>
<div class="math notranslate nohighlight" id="equation-6-41">
<span class="eqno">(2.6.38)<a class="headerlink" href="#equation-6-41" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{rcl} {\frac{c_{i} \Delta z_{i} }{\Delta t} \left(T_{i}^{n+1} -T_{i}^{n} \right)} &amp; {=} &amp; {-\alpha \frac{\lambda \left[z_{h,\, i} \right]\left(T_{i}^{n} -T_{i+1}^{n} \right)}{z_{i+1} -z_{i} } +\alpha \frac{\lambda \left[z_{h,\, i-1} \right]\left(T_{i-1}^{n} -T_{i}^{n} \right)}{z_{i} -z_{i-1} } } \\ {} \end{array}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-6-42">
<span class="eqno">(2.6.39)<a class="headerlink" href="#equation-6-42" title="Permalink to this equation">¶</a></span>\[a_{i} =-\left(1-\alpha \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \frac{\lambda \left[z_{h,\, i-1} \right]}{z_{i} -z_{i-1} }\]</div>
<div class="math notranslate nohighlight" id="equation-6-43">
<span class="eqno">(2.6.40)<a class="headerlink" href="#equation-6-43" title="Permalink to this equation">¶</a></span>\[b_{i} =1+\left(1-\alpha \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \left[\frac{\lambda \left[z_{h,\, i-1} \right]}{z_{i} -z_{i-1} } +\frac{\lambda \left[z_{h,\, i} \right]}{z_{i+1} -z_{i} } \right]\]</div>
<div class="math notranslate nohighlight" id="equation-6-44">
<span class="eqno">(2.6.41)<a class="headerlink" href="#equation-6-44" title="Permalink to this equation">¶</a></span>\[c_{i} =-\left(1-\alpha \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \frac{\lambda \left[z_{h,\, i} \right]}{z_{i+1} -z_{i} }\]</div>
<div class="math notranslate nohighlight" id="equation-6-45">
<span class="eqno">(2.6.42)<a class="headerlink" href="#equation-6-45" title="Permalink to this equation">¶</a></span>\[r_{i} =T_{i}^{n} +\alpha \frac{\Delta t}{c_{i} \Delta z_{i} } \left(F_{i} -F_{i-1} \right)+\frac{\Delta t}{c_{i} \Delta z_{i} } \vec{S}_{g,i} .\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{S}_{g,i}\)</span> is the absorbed solar flux in layer <span class="math notranslate nohighlight">\(i\)</span> (section <a class="reference internal" href="../Surface_Albedos/CLM50_Tech_Note_Surface_Albedos.html#snow-albedo"><span class="std std-numref">2.3.2.1</span></a>).</p>
<p>When surface water exists, the following top soil layer coefficients are modified</p>
<div class="math notranslate nohighlight" id="equation-6-46">
<span class="eqno">(2.6.43)<a class="headerlink" href="#equation-6-46" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{l} {b_{i} =1+\left(1-\alpha \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \left[f_{h2osfc} \frac{\lambda _{h2osfc} }{z_{i} -z_{h2osfc} } +f_{sno} \frac{\lambda \left[z_{h,\, i-1} \right]}{z_{i} -z_{i-1} } +\frac{\lambda \left[z_{h,\, i} \right]}{z_{i+1} -z_{i} } \right]} \\ {\quad \quad -\left(1-f_{sno} -f_{h2osfc} \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \frac{\partial h}{\partial T} } \end{array}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-6-47">
<span class="eqno">(2.6.44)<a class="headerlink" href="#equation-6-47" title="Permalink to this equation">¶</a></span>\[\begin{split}r_{i} =T_{i}^{n} +\frac{\Delta t}{c_{i} \Delta z_{i} } \left[\begin{array}{l} {\left(1-f_{sno} -f_{h2osfc} \right)\left(h_{soil} ^{n} -\frac{\partial h}{\partial T_{} } T_{i}^{n} \right)} \\ {+\alpha \left(F_{i} -f_{sno} F_{i-1} +f_{h2osfc} \frac{\lambda _{h2osfc} }{z_{1} -z_{h2osfc} } \left(T_{1} -T_{h2osfc} \right)\right)} \end{array}\right]\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-6-48">
<span class="eqno">(2.6.45)<a class="headerlink" href="#equation-6-48" title="Permalink to this equation">¶</a></span>\[d_{i} =-f_{h2osfc} \left(1-\alpha \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \left[\frac{\lambda _{h2osfc} }{z_{i} -z_{h2osfc} } \right]\]</div>
<p>where <span class="math notranslate nohighlight">\(d_{i}\)</span> is an additional coefficient representing the heat flux from the surface water layer. The surface water layer coefficients are</p>
<div class="math notranslate nohighlight" id="equation-6-49">
<span class="eqno">(2.6.46)<a class="headerlink" href="#equation-6-49" title="Permalink to this equation">¶</a></span>\[a_{h2osfc} =0\]</div>
<div class="math notranslate nohighlight" id="equation-6-50">
<span class="eqno">(2.6.47)<a class="headerlink" href="#equation-6-50" title="Permalink to this equation">¶</a></span>\[b_{h2osfc} =1+\frac{\Delta t}{c_{h2osfc} \Delta z_{h2osfc} } \left[\left(1-\alpha \right)\frac{\lambda _{h2osfc} }{z_{1} -z_{h2osfc} } -\frac{\partial h}{\partial T} \right]\]</div>
<div class="math notranslate nohighlight" id="equation-6-51">
<span class="eqno">(2.6.48)<a class="headerlink" href="#equation-6-51" title="Permalink to this equation">¶</a></span>\[c_{h2osfc} =-\left(1-\alpha \right)\frac{\Delta t}{c_{h2osfc} \Delta z_{h2osfc} } \frac{\lambda _{h2osfc} }{z_{1} -z_{h2osfc} }\]</div>
<div class="math notranslate nohighlight" id="equation-6-52">
<span class="eqno">(2.6.49)<a class="headerlink" href="#equation-6-52" title="Permalink to this equation">¶</a></span>\[r_{h2osfc} =T_{h2osfc}^{n} +\frac{\Delta t}{c_{i} \Delta z_{i} } \left[h_{h2osfc} ^{n} -\frac{\partial h}{\partial T_{} } T_{h2osfc}^{n} +\alpha \frac{\lambda _{h2osfc} }{z_{1} -z_{h2osfc} } \left(T_{1} -T_{h2osfc} \right)\right]_{}\]</div>
</div>
<div class="section" id="phase-change">
<span id="id1"></span><h2><span class="section-number">2.6.2. </span>Phase Change<a class="headerlink" href="#phase-change" title="Permalink to this headline">¶</a></h2>
<div class="section" id="soil-and-snow-layers">
<span id="id2"></span><h3><span class="section-number">2.6.2.1. </span>Soil and Snow Layers<a class="headerlink" href="#soil-and-snow-layers" title="Permalink to this headline">¶</a></h3>
<p>Upon update, the snow/soil temperatures are evaluated to determine if phase change will take place as</p>
<div class="math notranslate nohighlight" id="equation-6-53a">
<span class="eqno">(2.6.50)<a class="headerlink" href="#equation-6-53a" title="Permalink to this equation">¶</a></span>\[\begin{array}{lr}
T_{i}^{n+1} &gt;T_{f} {\rm \; and\; }w_{ice,\, i} &gt;0 &amp; \qquad i=snl+1,\ldots ,N_{levgrnd} \qquad {\rm melting}   \end{array}\]</div>
<div class="math notranslate nohighlight" id="equation-6-53b">
<span class="eqno">(2.6.51)<a class="headerlink" href="#equation-6-53b" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{lr}
\begin{array}{lr}
T_{i}^{n+1} &lt;T_{f} {\rm \; and\; }w_{liq,\, i} &gt;0 &amp; \qquad i=snl+1,\ldots ,0 \\
T_{i}^{n+1} &lt;T_{f} {\rm \; and\; }w_{liq,\, i} &gt;w_{liq,\, \max ,\, i} &amp; \quad i=1,\ldots ,N_{levgrnd}
\end{array} &amp; \quad {\rm freezing}
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(T_{i}^{n+1}\)</span> is the soil layer temperature after solution of the tridiagonal equation set, <span class="math notranslate nohighlight">\(w_{ice,\, i}\)</span> and <span class="math notranslate nohighlight">\(w_{liq,\, i}\)</span> are the mass of ice and liquid water (kg m<sup>-2</sup>) in each snow/soil layer, respectively, and <span class="math notranslate nohighlight">\(T_{f}\)</span> is the freezing temperature of water (K) (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.2.7</span></a>). For the freezing process in soil layers, the concept of supercooled soil water from <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#niuyang2006"><span class="std std-ref">Niu and Yang (2006)</span></a> is adopted. The supercooled soil water is the liquid water that coexists with ice over a wide range of temperatures below freezing and is implemented through a freezing point depression equation</p>
<div class="math notranslate nohighlight" id="equation-6-54">
<span class="eqno">(2.6.52)<a class="headerlink" href="#equation-6-54" title="Permalink to this equation">¶</a></span>\[w_{liq,\, \max ,\, i} =\Delta z_{i} \theta _{sat,\, i} \left[\frac{10^{3} L_{f} \left(T_{f} -T_{i} \right)}{gT_{i} \psi _{sat,\, i} } \right]^{{-1\mathord{\left/ {\vphantom {-1 B_{i} }} \right.} B_{i} } } \qquad T_{i} &lt;T_{f}\]</div>
<p>where <span class="math notranslate nohighlight">\(w_{liq,\, \max,\, i}\)</span> is the maximum liquid water in layer <span class="math notranslate nohighlight">\(i\)</span> (kg m<sup>-2</sup>) when the soil temperature <span class="math notranslate nohighlight">\(T_{i}\)</span> is below the freezing temperature <span class="math notranslate nohighlight">\(T_{f}\)</span>, <span class="math notranslate nohighlight">\(L_{f}\)</span> is the latent heat of fusion (J kg<sup>-1</sup>) (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.2.7</span></a>), <span class="math notranslate nohighlight">\(g\)</span> is the gravitational acceleration (m s<sup>-2</sup>) (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.2.7</span></a>), and <span class="math notranslate nohighlight">\(\psi _{sat,\, i}\)</span> and <span class="math notranslate nohighlight">\(B_{i}\)</span> are the soil texture-dependent saturated matric potential (mm) and <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#clapphornberger1978"><span class="std std-ref">Clapp and Hornberger (1978)</span></a> exponent (section <a class="reference internal" href="../Hydrology/CLM50_Tech_Note_Hydrology.html#soil-water"><span class="std std-numref">2.7.3</span></a>).</p>
<p>For the special case when snow is present (snow mass <span class="math notranslate nohighlight">\(W_{sno} &gt;0\)</span>) but there are no explicit snow layers (<span class="math notranslate nohighlight">\(snl=0\)</span>) (i.e., there is not enough snow present to meet the minimum snow depth requirement of 0.01 m), snow melt will take place for soil layer <span class="math notranslate nohighlight">\(i=1\)</span> if the soil layer temperature is greater than the freezing temperature (<span class="math notranslate nohighlight">\(T_{1}^{n+1} &gt;T_{f}\)</span> ).</p>
<p>The rate of phase change is assessed from the energy excess (or deficit) needed to change <span class="math notranslate nohighlight">\(T_{i}\)</span> to freezing temperature, <span class="math notranslate nohighlight">\(T_{f}\)</span>. The excess or deficit of energy <span class="math notranslate nohighlight">\(H_{i}\)</span> (W m<sup>-2</sup>) is determined as follows</p>
<div class="math notranslate nohighlight" id="equation-6-55">
<span class="eqno">(2.6.53)<a class="headerlink" href="#equation-6-55" title="Permalink to this equation">¶</a></span>\[\begin{split}H_{i} =\left\{\begin{array}{lr}
\frac{\partial h}{\partial T} \left(T_{f} -T_{i}^{n} \right)-\frac{c_{i} \Delta z_{i} }{\Delta t} \left(T_{f} -T_{i}^{n} \right) &amp; \quad \quad i=snl+1 \\
\left(1-f_{sno} -f_{h2osfc} \right)\frac{\partial h}{\partial T} \left(T_{f} -T_{i}^{n} \right)-\frac{c_{i} \Delta z_{i} }{\Delta t} \left(T_{f} -T_{i}^{n} \right)\quad {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} &amp; i=1 \\
-\frac{c_{i} \Delta z_{i} }{\Delta t} \left(T_{f} -T_{i}^{n} \right) &amp; \quad \quad i\ne \left\{1,snl+1\right\}
\end{array}\right\}.\end{split}\]</div>
<p>If the melting criteria is met <a class="reference internal" href="#equation-6-53a">(2.6.50)</a> and <span class="math notranslate nohighlight">\(H_{m} =\frac{H_{i} \Delta t}{L_{f} } &gt;0\)</span>, then the ice mass is readjusted as</p>
<div class="math notranslate nohighlight" id="equation-6-56">
<span class="eqno">(2.6.54)<a class="headerlink" href="#equation-6-56" title="Permalink to this equation">¶</a></span>\[w_{ice,\, i}^{n+1} =w_{ice,\, i}^{n} -H_{m} \ge 0\qquad i=snl+1,\ldots ,N_{levgrnd} .\]</div>
<p>If the freezing criteria is met <a class="reference internal" href="#equation-6-53b">(2.6.51)</a> and <span class="math notranslate nohighlight">\(H_{m} &lt;0\)</span>, then the ice mass is readjusted for <span class="math notranslate nohighlight">\(i=snl+1,\ldots,0\)</span> as</p>
<div class="math notranslate nohighlight" id="equation-6-57">
<span class="eqno">(2.6.55)<a class="headerlink" href="#equation-6-57" title="Permalink to this equation">¶</a></span>\[w_{ice,\, i}^{n+1} =\min \left(w_{liq,\, i}^{n} +w_{ice,\, i}^{n} ,w_{ice,\, i}^{n} -H_{m} \right)\]</div>
<p>and for <span class="math notranslate nohighlight">\(i=1,\ldots,N_{levgrnd}\)</span> as</p>
<div class="math notranslate nohighlight" id="equation-6-58">
<span class="eqno">(2.6.56)<a class="headerlink" href="#equation-6-58" title="Permalink to this equation">¶</a></span>\[\begin{split}w_{ice,\, i}^{n+1} =
\left\{\begin{array}{lr}
\min \left(w_{liq,\, i}^{n} +w_{ice,\, i}^{n} -w_{liq,\, \max ,\, i}^{n} ,\, w_{ice,\, i}^{n} -H_{m} \right) &amp; \qquad w_{liq,\, i}^{n} +w_{ice,\, i}^{n} \ge w_{liq,\, \max ,\, i}^{n} {\rm \; } \\
{\rm 0} &amp; \qquad w_{liq,\, i}^{n} +w_{ice,\, i}^{n} &lt;w_{liq,\, \max ,\, i}^{n} {\rm \; \; }\,
\end{array}\right\}.\end{split}\]</div>
<p>Liquid water mass is readjusted as</p>
<div class="math notranslate nohighlight" id="equation-6-59">
<span class="eqno">(2.6.57)<a class="headerlink" href="#equation-6-59" title="Permalink to this equation">¶</a></span>\[w_{liq,\, i}^{n+1} =w_{liq,\, i}^{n} +w_{ice,\, i}^{n} -w_{ice,\, i}^{n+1} \ge 0.\]</div>
<p>Because part of the energy <span class="math notranslate nohighlight">\(H_{i}\)</span> may not be consumed in melting or released in freezing, the energy is recalculated as</p>
<div class="math notranslate nohighlight" id="equation-6-60">
<span class="eqno">(2.6.58)<a class="headerlink" href="#equation-6-60" title="Permalink to this equation">¶</a></span>\[H_{i*} =H_{i} -\frac{L_{f} \left(w_{ice,\, i}^{n} -w_{ice,\, i}^{n+1} \right)}{\Delta t}\]</div>
<p>and this energy is used to cool or warm the snow/soil layer (if <span class="math notranslate nohighlight">\(\left|H_{i*} \right|&gt;0\)</span>) as</p>
<div class="math notranslate nohighlight" id="equation-6-61">
<span class="eqno">(2.6.59)<a class="headerlink" href="#equation-6-61" title="Permalink to this equation">¶</a></span>\[\begin{split}T_{i}^{n+1} =
\left\{\begin{array}{lr}
T_{f} +{\frac{\Delta t}{c_{i} \Delta z_{i} } H_{i*} \mathord{\left/ {\vphantom {\frac{\Delta t}{c_{i} \Delta z_{i} } H_{i*}  \left(1-\frac{\Delta t}{c_{i} \Delta z_{i} } \frac{\partial h}{\partial T} \right)}} \right.} \left(1-\frac{\Delta t}{c_{i} \Delta z_{i} } \frac{\partial h}{\partial T} \right)} &amp; \quad \quad \quad \quad \, i=snl+1 \\
T_{f} +{\frac{\Delta t}{c_{i} \Delta z_{i} } H_{i*} \mathord{\left/ {\vphantom {\frac{\Delta t}{c_{i} \Delta z_{i} } H_{i*}  \left(1-\left(1-f_{sno} -f_{h2osfc} \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \frac{\partial h}{\partial T} \right)}} \right.} \left(1-\left(1-f_{sno} -f_{h2osfc} \right)\frac{\Delta t}{c_{i} \Delta z_{i} } \frac{\partial h}{\partial T} \right)} &amp; \qquad i=1 \\
T_{f} +\frac{\Delta t}{c_{i} \Delta z_{i} } H_{i*} &amp; \quad \quad \quad \quad \, i\ne \left\{1,snl+1\right\}
\end{array}\right\}.\end{split}\]</div>
<p>For the special case when snow is present (<span class="math notranslate nohighlight">\(W_{sno} &gt;0\)</span>), there are no explicit snow layers (<span class="math notranslate nohighlight">\(snl=0\)</span>), and <span class="math notranslate nohighlight">\(\frac{H_{1} \Delta t}{L_{f} } &gt;0\)</span> (melting), the snow mass <span class="math notranslate nohighlight">\(W_{sno}\)</span> (kg m<sup>-2</sup>) is reduced according to</p>
<div class="math notranslate nohighlight" id="equation-6-62">
<span class="eqno">(2.6.60)<a class="headerlink" href="#equation-6-62" title="Permalink to this equation">¶</a></span>\[W_{sno}^{n+1} =W_{sno}^{n} -\frac{H_{1} \Delta t}{L_{f} } \ge 0.\]</div>
<p>The snow depth is reduced proportionally</p>
<div class="math notranslate nohighlight" id="equation-6-63">
<span class="eqno">(2.6.61)<a class="headerlink" href="#equation-6-63" title="Permalink to this equation">¶</a></span>\[z_{sno}^{n+1} =\frac{W_{sno}^{n+1} }{W_{sno}^{n} } z_{sno}^{n} .\]</div>
<p>Again, because part of the energy may not be consumed in melting, the energy for the surface soil layer <span class="math notranslate nohighlight">\(i=1\)</span> is recalculated as</p>
<div class="math notranslate nohighlight" id="equation-6-64">
<span class="eqno">(2.6.62)<a class="headerlink" href="#equation-6-64" title="Permalink to this equation">¶</a></span>\[H_{1*} =H_{1} -\frac{L_{f} \left(W_{sno}^{n} -W_{sno}^{n+1} \right)}{\Delta t} .\]</div>
<p>If there is excess energy (<span class="math notranslate nohighlight">\(H_{1*} &gt;0\)</span>), this energy becomes available to the top soil layer as</p>
<div class="math notranslate nohighlight" id="equation-6-65">
<span class="eqno">(2.6.63)<a class="headerlink" href="#equation-6-65" title="Permalink to this equation">¶</a></span>\[H_{1} =H_{1*} .\]</div>
<p>The ice mass, liquid water content, and temperature of the top soil layer are then determined from <a class="reference internal" href="#equation-6-56">(2.6.54)</a>, <a class="reference internal" href="#equation-6-59">(2.6.57)</a>, and <a class="reference internal" href="#equation-6-61">(2.6.59)</a> using the recalculated energy from <a class="reference internal" href="#equation-6-65">(2.6.63)</a>. Snow melt <span class="math notranslate nohighlight">\(M_{1S}\)</span> (kg m<sup>-2</sup> s<sup>-1</sup>) and phase change energy <span class="math notranslate nohighlight">\(E_{p,\, 1S}\)</span> (W m<sup>-2</sup>) for this special case are</p>
<div class="math notranslate nohighlight" id="equation-6-66">
<span class="eqno">(2.6.64)<a class="headerlink" href="#equation-6-66" title="Permalink to this equation">¶</a></span>\[M_{1S} =\frac{W_{sno}^{n} -W_{sno}^{n+1} }{\Delta t} \ge 0\]</div>
<div class="math notranslate nohighlight" id="equation-6-67">
<span class="eqno">(2.6.65)<a class="headerlink" href="#equation-6-67" title="Permalink to this equation">¶</a></span>\[E_{p,\, 1S} =L_{f} M_{1S} .\]</div>
<p>The total energy of phase change <span class="math notranslate nohighlight">\(E_{p}\)</span> (W m<sup>-2</sup>) for the snow/soil column is</p>
<div class="math notranslate nohighlight" id="equation-6-68">
<span class="eqno">(2.6.66)<a class="headerlink" href="#equation-6-68" title="Permalink to this equation">¶</a></span>\[E_{p} =E_{p,\, 1S} +\sum _{i=snl+1}^{N_{levgrnd} }E_{p,i}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-6-69">
<span class="eqno">(2.6.67)<a class="headerlink" href="#equation-6-69" title="Permalink to this equation">¶</a></span>\[E_{p,\, i} =L_{f} \frac{\left(w_{ice,\, i}^{n} -w_{ice,\, i}^{n+1} \right)}{\Delta t} .\]</div>
<p>The total snow melt <span class="math notranslate nohighlight">\(M\)</span> (kg m<sup>-2</sup> s<sup>-1</sup>) is</p>
<div class="math notranslate nohighlight" id="equation-6-70">
<span class="eqno">(2.6.68)<a class="headerlink" href="#equation-6-70" title="Permalink to this equation">¶</a></span>\[M=M_{1S} +\sum _{i=snl+1}^{i=0}M_{i}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-6-71">
<span class="eqno">(2.6.69)<a class="headerlink" href="#equation-6-71" title="Permalink to this equation">¶</a></span>\[M_{i} =\frac{\left(w_{ice,\, i}^{n} -w_{ice,\, i}^{n+1} \right)}{\Delta t} \ge 0.\]</div>
<p>The solution for snow/soil temperatures conserves energy as</p>
<div class="math notranslate nohighlight" id="equation-6-72">
<span class="eqno">(2.6.70)<a class="headerlink" href="#equation-6-72" title="Permalink to this equation">¶</a></span>\[G-E_{p} -\sum _{i=snl+1}^{i=N_{levgrnd} }\frac{c_{i} \Delta z_{i} }{\Delta t}  \left(T_{i}^{n+1} -T_{i}^{n} \right)=0\]</div>
<p>where <span class="math notranslate nohighlight">\(G\)</span> is the ground heat flux (section <a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html#update-of-ground-sensible-and-latent-heat-fluxes"><span class="std std-numref">2.5.4</span></a>).</p>
</div>
<div class="section" id="surface-water">
<span id="id3"></span><h3><span class="section-number">2.6.2.2. </span>Surface Water<a class="headerlink" href="#surface-water" title="Permalink to this headline">¶</a></h3>
<p>Phase change of surface water takes place when the surface water temperature, <span class="math notranslate nohighlight">\(T_{h2osfc}\)</span>, becomes less than <span class="math notranslate nohighlight">\(T_{f}\)</span>. The energy available for freezing is</p>
<div class="math notranslate nohighlight" id="equation-6-73">
<span class="eqno">(2.6.71)<a class="headerlink" href="#equation-6-73" title="Permalink to this equation">¶</a></span>\[H_{h2osfc} =\frac{\partial h}{\partial T} \left(T_{f} -T_{h2osfc}^{n} \right)-\frac{c_{h2osfc} \Delta z_{h2osfc} }{\Delta t} \left(T_{f} -T_{h2osfc}^{n} \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(c_{h2osfc}\)</span> is the volumetric heat capacity of water, and <span class="math notranslate nohighlight">\(\Delta z_{h2osfc}\)</span> is the depth of the surface water layer. If <span class="math notranslate nohighlight">\(H_{m} =\frac{H_{h2osfc} \Delta t}{L_{f} } &gt;0\)</span> then <span class="math notranslate nohighlight">\(H_{m}\)</span> is removed from surface water and added to the snow column as ice</p>
<div class="math notranslate nohighlight" id="equation-6-74">
<span class="eqno">(2.6.72)<a class="headerlink" href="#equation-6-74" title="Permalink to this equation">¶</a></span>\[H^{n+1} _{h2osfc} =H^{n} _{h2osfc} -H_{m}\]</div>
<div class="math notranslate nohighlight" id="equation-6-75">
<span class="eqno">(2.6.73)<a class="headerlink" href="#equation-6-75" title="Permalink to this equation">¶</a></span>\[w_{ice,\, 0}^{n+1} =w_{ice,\, 0}^{n} +H_{m}\]</div>
<p>The snow depth is adjusted to account for the additional ice mass</p>
<div class="math notranslate nohighlight" id="equation-6-76">
<span class="eqno">(2.6.74)<a class="headerlink" href="#equation-6-76" title="Permalink to this equation">¶</a></span>\[\Delta z_{sno} =\frac{H_{m} }{\rho _{ice} }\]</div>
<p>If <span class="math notranslate nohighlight">\(H_{m}\)</span> is greater than <span class="math notranslate nohighlight">\(W_{sfc}\)</span>, the excess heat <span class="math notranslate nohighlight">\(\frac{L_{f} \left(H_{m} -W_{sfc} \right)}{\Delta t}\)</span> is used to cool the snow layer.</p>
</div>
</div>
<div class="section" id="soil-and-snow-thermal-properties">
<span id="id4"></span><h2><span class="section-number">2.6.3. </span>Soil and Snow Thermal Properties<a class="headerlink" href="#soil-and-snow-thermal-properties" title="Permalink to this headline">¶</a></h2>
<p>The thermal properties of the soil are assumed to be a weighted combination of the mineral and organic properties of the soil (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#lawrenceslater2008"><span class="std std-ref">Lawrence and Slater 2008</span></a>). The soil layer organic matter fraction <span class="math notranslate nohighlight">\(f_{om,i}\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-6-77">
<span class="eqno">(2.6.75)<a class="headerlink" href="#equation-6-77" title="Permalink to this equation">¶</a></span>\[f_{om,i} =\rho _{om,i} /\rho _{om,\max } .\]</div>
<p>Soil thermal conductivity <span class="math notranslate nohighlight">\(\lambda _{i}\)</span> (W m<sup>-1</sup> K<sup>-1</sup>) is from <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#farouki1981"><span class="std std-ref">Farouki (1981)</span></a></p>
<div class="math notranslate nohighlight" id="equation-6-78">
<span class="eqno">(2.6.76)<a class="headerlink" href="#equation-6-78" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{lr}
\lambda _{i} = \left\{
\begin{array}{lr}
K_{e,\, i} \lambda _{sat,\, i} +\left(1-K_{e,\, i} \right)\lambda _{dry,\, i} &amp;\qquad S_{r,\, i} &gt; 1\times 10^{-7}  \\
\lambda _{dry,\, i} &amp;\qquad S_{r,\, i} \le 1\times 10^{-7}
\end{array}\right\} &amp;\qquad i=1,\ldots ,N_{levsoi}  \\
\lambda _{i} =\lambda _{bedrock} &amp;\qquad i=N_{levsoi} +1,\ldots N_{levgrnd}
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda _{sat,\, i}\)</span> is the saturated thermal conductivity, <span class="math notranslate nohighlight">\(\lambda _{dry,\, i}\)</span> is the dry thermal conductivity, <span class="math notranslate nohighlight">\(K_{e,\, i}\)</span> is the Kersten number, <span class="math notranslate nohighlight">\(S_{r,\, i}\)</span> is the wetness of the soil with respect to saturation, and <span class="math notranslate nohighlight">\(\lambda _{bedrock} =3\)</span> W m<sup>-1</sup> K<sup>-1</sup> is the thermal conductivity assumed for the deep ground layers (typical of saturated granitic rock; <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#clauserhuenges1995"><span class="std std-ref">Clauser and Huenges 1995</span></a>). For glaciers,</p>
<div class="math notranslate nohighlight" id="equation-6-79">
<span class="eqno">(2.6.77)<a class="headerlink" href="#equation-6-79" title="Permalink to this equation">¶</a></span>\[\begin{split}\lambda _{i} =\left\{\begin{array}{l} {\lambda _{liq,\, i} \qquad T_{i} \ge T_{f} } \\ {\lambda _{ice,\, i} \qquad T_{i} &lt;T_{f} } \end{array}\right\}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda _{liq}\)</span> and <span class="math notranslate nohighlight">\(\lambda _{ice}\)</span> are the thermal conductivities of liquid water and ice, respectively (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.2.7</span></a>). The saturated thermal conductivity <span class="math notranslate nohighlight">\(\lambda _{sat,\, i}\)</span> (W m<sup>-1</sup> K<sup>-1</sup>) depends on the thermal conductivities of the soil solid, liquid water, and ice constituents</p>
<div class="math notranslate nohighlight" id="equation-6-80">
<span class="eqno">(2.6.78)<a class="headerlink" href="#equation-6-80" title="Permalink to this equation">¶</a></span>\[\lambda _{sat} =\lambda _{s}^{1-\theta _{sat} } \lambda _{liq}^{\frac{\theta _{liq} }{\theta _{liq} +\theta _{ice} } \theta _{sat} } \lambda _{ice}^{\theta _{sat} \left(1-\frac{\theta _{liq} }{\theta _{liq} +\theta _{ice} } \right)}\]</div>
<p>where the thermal conductivity of soil solids <span class="math notranslate nohighlight">\(\lambda _{s,\, i}\)</span> varies with the sand, clay, and organic matter content</p>
<div class="math notranslate nohighlight" id="equation-6-81">
<span class="eqno">(2.6.79)<a class="headerlink" href="#equation-6-81" title="Permalink to this equation">¶</a></span>\[\lambda _{s,i} =(1-f_{om,i} )\lambda _{s,\min ,i} +f_{om,i} \lambda _{s,om}\]</div>
<p>where the mineral soil solid thermal conductivity <span class="math notranslate nohighlight">\(\lambda _{s,\min,i}\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-6-82">
<span class="eqno">(2.6.80)<a class="headerlink" href="#equation-6-82" title="Permalink to this equation">¶</a></span>\[\lambda _{s,\, \min ,i} =\frac{8.80{\rm \; }\left(\% sand\right)_{i} +{\rm 2.92\; }\left(\% clay\right)_{i} }{\left(\% sand\right)_{i} +\left(\% clay\right)_{i} } ,\]</div>
<p>and <span class="math notranslate nohighlight">\(\lambda _{s,om} =0.25\)</span>W m<sup>-1</sup> K<sup>-1</sup> (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#farouki1981"><span class="std std-ref">Farouki 1981</span></a>). <span class="math notranslate nohighlight">\(\theta _{sat,\, i}\)</span> is the volumetric water content at saturation (porosity) (section <a class="reference internal" href="../Hydrology/CLM50_Tech_Note_Hydrology.html#hydraulic-properties"><span class="std std-numref">2.7.3.1</span></a>).</p>
<p>The thermal conductivity of dry soil is</p>
<div class="math notranslate nohighlight" id="equation-6-83">
<span class="eqno">(2.6.81)<a class="headerlink" href="#equation-6-83" title="Permalink to this equation">¶</a></span>\[\lambda _{dry,i} =(1-f_{om,i} )\lambda _{dry,\min ,i} +f_{om,i} \lambda _{dry,om}\]</div>
<p>where the thermal conductivity of dry mineral soil <span class="math notranslate nohighlight">\(\lambda _{dry,\min,i}\)</span> (W m<sup>-1</sup> K<sup>-1</sup>) depends on the bulk density <span class="math notranslate nohighlight">\(\rho _{d,\, i} =2700\left(1-\theta _{sat,\, i} \right)\)</span> (kg m<sup>-3</sup>) as</p>
<div class="math notranslate nohighlight" id="equation-6-84">
<span class="eqno">(2.6.82)<a class="headerlink" href="#equation-6-84" title="Permalink to this equation">¶</a></span>\[\lambda _{dry,\, \min ,i} =\frac{0.135\rho _{d,\, i} +64.7}{2700-0.947\rho _{d,\, i} }\]</div>
<p>and <span class="math notranslate nohighlight">\(\lambda _{dry,om} =0.05\)</span> W m<sup>-1</sup> K<sup>-1</sup> (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#farouki1981"><span class="std std-ref">Farouki 1981</span></a>) is the dry thermal conductivity of organic matter. The Kersten number <span class="math notranslate nohighlight">\(K_{e,\, i}\)</span> is a function of the degree of saturation <span class="math notranslate nohighlight">\(S_{r}\)</span> and phase of water</p>
<div class="math notranslate nohighlight" id="equation-6-85">
<span class="eqno">(2.6.83)<a class="headerlink" href="#equation-6-85" title="Permalink to this equation">¶</a></span>\[\begin{split}K_{e,\, i} = \left\{
\begin{array}{lr}
\log \left(S_{r,\, i} \right)+1\ge 0 &amp;\qquad T_{i} \ge T_{f}  \\
S_{r,\, i} &amp;\qquad T_{i} &lt;T_{f}
\end{array}\right\}\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-6-86">
<span class="eqno">(2.6.84)<a class="headerlink" href="#equation-6-86" title="Permalink to this equation">¶</a></span>\[S_{r,\, i} =\left(\frac{w_{liq,\, i} }{\rho _{liq} \Delta z_{i} } +\frac{w_{ice,\, i} }{\rho _{ice} \Delta z_{i} } \right)\frac{1}{\theta _{sat,\, i} } =\frac{\theta _{liq,\, i} +\theta _{ice,\, i} }{\theta _{sat,\, i} } \le 1.\]</div>
<p>Thermal conductivity <span class="math notranslate nohighlight">\(\lambda _{i}\)</span> (W m<sup>-1</sup> K<sup>-1</sup>) for snow is from <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#jordan1991"><span class="std std-ref">Jordan (1991)</span></a></p>
<div class="math notranslate nohighlight" id="equation-6-87">
<span class="eqno">(2.6.85)<a class="headerlink" href="#equation-6-87" title="Permalink to this equation">¶</a></span>\[\lambda _{i} =\lambda _{air} +\left(7.75\times 10^{-5} \rho _{sno,\, i} +1.105\times 10^{-6} \rho _{sno,\, i}^{2} \right)\left(\lambda _{ice} -\lambda _{air} \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda _{air}\)</span> is the thermal conductivity of air (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.2.7</span></a>) and <span class="math notranslate nohighlight">\(\rho _{sno,\, i}\)</span> is the bulk density of snow (kg m<sup>-3</sup>)</p>
<div class="math notranslate nohighlight" id="equation-6-88">
<span class="eqno">(2.6.86)<a class="headerlink" href="#equation-6-88" title="Permalink to this equation">¶</a></span>\[\rho _{sno,\, i} =\frac{w_{ice,\, i} +w_{liq,\, i} }{\Delta z_{i} } .\]</div>
<p>The volumetric heat capacity <span class="math notranslate nohighlight">\(c_{i}\)</span> (J m<sup>-3</sup> K<sup>-1</sup>) for soil is from <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#devries1963"><span class="std std-ref">de Vries (1963)</span></a> and depends on the heat capacities of the soil solid, liquid water, and ice constituents</p>
<div class="math notranslate nohighlight" id="equation-6-89">
<span class="eqno">(2.6.87)<a class="headerlink" href="#equation-6-89" title="Permalink to this equation">¶</a></span>\[c_{i} =c_{s,\, i} \left(1-\theta _{sat,\, i} \right)+\frac{w_{ice,\, i} }{\Delta z_{i} } C_{ice} +\frac{w_{liq,\, i} }{\Delta z_{i} } C_{liq}\]</div>
<p>where <span class="math notranslate nohighlight">\(C_{liq}\)</span> and <span class="math notranslate nohighlight">\(C_{ice}\)</span> are the specific heat capacities (J kg<sup>-1</sup> K<sup>-1</sup>) of liquid water and ice, respectively (<a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html#table-physical-constants"><span class="std std-numref">Table 2.2.7</span></a>). The heat capacity of soil solids <span class="math notranslate nohighlight">\(c_{s,i}\)</span> (J m<sup>-3</sup> K<sup>-1</sup>) is</p>
<div class="math notranslate nohighlight" id="equation-6-90">
<span class="eqno">(2.6.88)<a class="headerlink" href="#equation-6-90" title="Permalink to this equation">¶</a></span>\[c_{s,i} =(1-f_{om,i} )c_{s,\min ,i} +f_{om,i} c_{s,om}\]</div>
<p>where the heat capacity of mineral soil solids <span class="math notranslate nohighlight">\(c_{s,\min,\, i}\)</span> (J m<sup>-3</sup> K<sup>-1</sup>) is</p>
<div class="math notranslate nohighlight" id="equation-6-91">
<span class="eqno">(2.6.89)<a class="headerlink" href="#equation-6-91" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{lr}
c_{s,\min ,\, i} =\left(\frac{2.128{\rm \; }\left(\% sand\right)_{i} +{\rm 2.385\; }\left(\% clay\right)_{i} }{\left(\% sand\right)_{i} +\left(\% clay\right)_{i} } \right)\times 10^{6} &amp;\qquad i=1,\ldots ,N_{levsoi}  \\
c_{s,\, \min ,i} =c_{s,\, bedrock} &amp;\qquad i=N_{levsoi} +1,\ldots ,N_{levgrnd}
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(c_{s,bedrock} =2\times 10^{6}\)</span> J m<sup>-3</sup> K<sup>-1</sup> is the heat capacity of bedrock and <span class="math notranslate nohighlight">\(c_{s,om} =2.5\times 10^{6}\)</span> J m<sup>-3</sup> K<sup>-1</sup> (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#farouki1981"><span class="std std-ref">Farouki 1981</span></a>) is the heat capacity of organic matter. For glaciers and snow</p>
<div class="math notranslate nohighlight" id="equation-6-92">
<span class="eqno">(2.6.90)<a class="headerlink" href="#equation-6-92" title="Permalink to this equation">¶</a></span>\[c_{i} =\frac{w_{ice,\, i} }{\Delta z_{i} } C_{ice} +\frac{w_{liq,\, i} }{\Delta z_{i} } C_{liq} .\]</div>
<p>For the special case when snow is present (<span class="math notranslate nohighlight">\(W_{sno} &gt;0\)</span>) but there are no explicit snow layers (<span class="math notranslate nohighlight">\(snl=0\)</span>), the heat capacity of the top layer is a blend of ice and soil heat capacity</p>
<div class="math notranslate nohighlight" id="equation-6-93">
<span class="eqno">(2.6.91)<a class="headerlink" href="#equation-6-93" title="Permalink to this equation">¶</a></span>\[c_{1} =c_{1}^{*} +\frac{C_{ice} W_{sno} }{\Delta z_{1} }\]</div>
<p>where <span class="math notranslate nohighlight">\(c_{1}^{*}\)</span>  is calculated from <a class="reference internal" href="#equation-6-89">(2.6.87)</a> or <a class="reference internal" href="#equation-6-92">(2.6.90)</a>.</p>
</div>
<div class="section" id="excess-ground-ice">
<span id="id5"></span><h2><span class="section-number">2.6.4. </span>Excess Ground Ice<a class="headerlink" href="#excess-ground-ice" title="Permalink to this headline">¶</a></h2>
<p>An optional parameterization of excess ground ice melt and respective subsidence based on (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#leeetal2014"><span class="std std-ref">Lee et al., (2014)</span></a>). Initial excess ground ice concentrations for soil columns are derived from (<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#brownetal1997"><span class="std std-ref">Brown et al., (1997)</span></a>). When the excess ground ice is present in the soil column, soil depth for a given layer (<span class="math notranslate nohighlight">\(z_{i}\)</span>) is adjusted by the amount of excess ice in the column:</p>
<div class="math notranslate nohighlight" id="equation-6-94">
<span class="eqno">(2.6.92)<a class="headerlink" href="#equation-6-94" title="Permalink to this equation">¶</a></span>\[z_{i}^{'}=\Sigma_{j=1}^{i} \ z_{j}^{'}+\frac{w_{exice,\, j}}{\rho_{ice} }\]</div>
<p>where <span class="math notranslate nohighlight">\(w_{exice,\,j}\)</span> is excess ground ice amount (kg m <sup>-2</sup>) in layer <span class="math notranslate nohighlight">\(j\)</span> and <span class="math notranslate nohighlight">\(\rho_{ice}\)</span> is the density of ice (kg m <sup>-3</sup>). After adjustment of layer depths have been made, all of the soil temperature equations (from <a class="reference internal" href="#equation-6-80">(2.6.78)</a> to <a class="reference internal" href="#equation-6-89">(2.6.87)</a>) are calculted based on the adjusted depths. Thermal properties are additionally adjusted (<a class="reference internal" href="#equation-6-8">(2.6.5)</a> and <a class="reference internal" href="#equation-6-8">(2.6.5)</a>) in the following way:</p>
<div class="math notranslate nohighlight" id="equation-6-95">
<span class="eqno">(2.6.93)<a class="headerlink" href="#equation-6-95" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{lr}
 \theta_{sat}^{'} =\frac{\theta _{liq} }{\theta _{liq} +\theta _{ice} +\theta_{exice}}{\theta_{sat}} \\
 \lambda _{sat}^{'} =\lambda _{s}^{1-\theta _{sat}^{'} } \lambda _{liq}^{\frac{\theta _{liq} }{\theta _{liq} +\theta _{ice} +\theta_{exice}} \theta _{sat}^{'} } \lambda _{ice}^{\theta _{sat}^{'} \left(1-\frac{\theta _{liq} }{\theta _{liq} +\theta _{ice} +\theta_{exice}} \right)} \\
 c_{i}^{'} =c_{s,\, i} \left(1-\theta _{sat,\, i}^{'} \right)+\frac{w_{ice,\, i} +w_{exice,\,j}}{\Delta z_{i}^{'} } C_{ice} +\frac{w_{liq,\, i} }{\Delta z_{i}^{'} } C_{liq}
\end{array}\end{split}\]</div>
<p>Soil subsidence at the timestep <span class="math notranslate nohighlight">\(n+1\)</span> (<span class="math notranslate nohighlight">\(z_{exice}^{n+1}\)</span>, m) is then calculated as:</p>
<div class="math notranslate nohighlight" id="equation-6-96">
<span class="eqno">(2.6.94)<a class="headerlink" href="#equation-6-96" title="Permalink to this equation">¶</a></span>\[z_{exice}^{n+1}=\Sigma_{i=1}^{N_{levgrnd}} \ z_{j}^{',\ ,n+1}-z_{j}^{',\ ,n }\]</div>
<p>With regards to hydraulic counductivity, excess ground ice is treated the same way normal soil ice is treated in <a class="reference internal" href="../Hydrology/CLM50_Tech_Note_Hydrology.html#frozen-soils-and-perched-water-table"><span class="std std-numref">2.7.4</span></a>. When a soil layer thaws, excess ground ice is only allowed to melt when no normals soil ice is present in the layer. When a soil layer refreezes, liquid soil water can only turn into normal soil ice, thus, no new of excess ice can be created but only melted. The excess liquid soil moisture from excess ice melt is distributed within the soil column according to <a class="reference internal" href="../Hydrology/CLM50_Tech_Note_Hydrology.html#lateral-sub-surface-runoff"><span class="std std-numref">2.7.5</span></a>.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Hydrology/CLM50_Tech_Note_Hydrology.html" class="btn btn-neutral float-right" title="2.7. Hydrology" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../Fluxes/CLM50_Tech_Note_Fluxes.html" class="btn btn-neutral" title="2.5. Momentum, Sensible Heat, and Latent Heat Fluxes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, UCAR.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
     
<script>var version_json_loc = "../../../../versions.json";</script>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="../../_static/pop_ver.js"></script>
    

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>