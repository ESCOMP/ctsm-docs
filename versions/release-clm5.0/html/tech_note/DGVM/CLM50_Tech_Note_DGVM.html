

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2.28. Dynamic Global Vegetation &mdash; ctsm release-clm5.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="ctsm release-clm5.0 documentation" href="../../index.html"/>
        <link rel="up" title="2. CLM Technical Note" href="../index.html"/>
        <link rel="next" title="2.30. Biogenic Volatile Organic Compounds (BVOCs)" href="../BVOCs/CLM50_Tech_Note_BVOCs.html"/>
        <link rel="prev" title="2.27. Transient Land Use and Land Cover Change" href="../Transient_Landcover/CLM50_Tech_Note_Transient_Landcover.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> ctsm
          

          
          </a>

          
            
            
              <div class="version">
                
                  <div class="version-dropdown">
                    <select class="version-list" id="version-list">
                      <option value=''>CLM5.0</option>
                      
                        
                      
                        
                          <option value="">[placeholder]</option>
                        
                      
                    </select>
                  </div>
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../users_guide/index.html">1. CLM5.0 User’s Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">2. CLM Technical Note</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Introduction/CLM50_Tech_Note_Introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ecosystem/CLM50_Tech_Note_Ecosystem.html">2.2. Surface Characterization, Vertical Discretization, and Model Input Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Surface_Albedos/CLM50_Tech_Note_Surface_Albedos.html">2.3. Surface Albedos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Radiative_Fluxes/CLM50_Tech_Note_Radiative_Fluxes.html">2.4. Radiative Fluxes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Fluxes/CLM50_Tech_Note_Fluxes.html">2.5. Momentum, Sensible Heat, and Latent Heat Fluxes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Soil_Snow_Temperatures/CLM50_Tech_Note_Soil_Snow_Temperatures.html">2.6. Soil and Snow Temperatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Hydrology/CLM50_Tech_Note_Hydrology.html">2.7. Hydrology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Snow_Hydrology/CLM50_Tech_Note_Snow_Hydrology.html">2.8. Snow Hydrology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Photosynthesis/CLM50_Tech_Note_Photosynthesis.html">2.9. Stomatal Resistance and Photosynthesis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Photosynthetic_Capacity/CLM50_Tech_Note_Photosynthetic_Capacity.html">2.10. Photosynthetic Capacity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Plant_Hydraulics/CLM50_Tech_Note_Plant_Hydraulics.html">2.11. Plant Hydraulics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lake/CLM50_Tech_Note_Lake.html">2.12. Lake Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Glacier/CLM50_Tech_Note_Glacier.html">2.13. Glaciers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MOSART/CLM50_Tech_Note_MOSART.html">2.14. Model for Scale Adaptive River Transport (MOSART)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Urban/CLM50_Tech_Note_Urban.html">2.15. Urban Model (CLMU)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CN_Pools/CLM50_Tech_Note_CN_Pools.html">2.16. CN Pools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Plant_Respiration/CLM50_Tech_Note_Plant_Respiration.html">2.17. Plant Respiration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../FUN/CLM50_Tech_Note_FUN.html">2.18. Fixation and Uptake of Nitrogen (FUN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CN_Allocation/CLM50_Tech_Note_CN_Allocation.html">2.19. Carbon and Nitrogen Allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Vegetation_Phenology_Turnover/CLM50_Tech_Note_Vegetation_Phenology_Turnover.html">2.20. Vegetation Phenology and Turnover</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Decomposition/CLM50_Tech_Note_Decomposition.html">2.21. Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../External_Nitrogen_Cycle/CLM50_Tech_Note_External_Nitrogen_Cycle.html">2.22. External Nitrogen Cycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Plant_Mortality/CLM50_Tech_Note_Plant_Mortality.html">2.23. Plant Mortality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Fire/CLM50_Tech_Note_Fire.html">2.24. Fire</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Methane/CLM50_Tech_Note_Methane.html">2.25. Methane Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Crop_Irrigation/CLM50_Tech_Note_Crop_Irrigation.html">2.26. Crops and Irrigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Transient_Landcover/CLM50_Tech_Note_Transient_Landcover.html">2.27. Transient Land Use and Land Cover Change</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.28. Dynamic Global Vegetation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-has-changed">2.28.1. What has changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#technical-documentation-for-fates">2.29. Technical Documentation for FATES</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">2.29.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-representation-of-ecosystem-heterogeneity-in-fates">2.29.2. The representation of ecosystem heterogeneity in FATES</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cohortized-representation-of-tree-populations">2.29.2.1. Cohortized representation of tree populations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#discretization-of-cohorts-and-patches">2.29.2.2. Discretization of cohorts and patches</a></li>
<li class="toctree-l4"><a class="reference internal" href="#linked-lists-the-general-code-structure-of-fates">2.29.2.3. Linked Lists: the general code structure of FATES</a></li>
<li class="toctree-l4"><a class="reference internal" href="#indices-used-in-fates">2.29.2.4. Indices used in FATES</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cohort-state-variables">2.29.2.5. Cohort State Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#patch-state-variables">2.29.2.6. Patch State Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-structure">2.29.2.7. Model Structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#initialization-of-vegetation-from-bare-ground">2.29.3. Initialization of vegetation from bare ground</a></li>
<li class="toctree-l3"><a class="reference internal" href="#allocation-of-biomass">2.29.4. Allocation of biomass</a></li>
<li class="toctree-l3"><a class="reference internal" href="#canopy-structure-and-the-perfect-plasticity-approximation">2.29.5. Canopy Structure and the Perfect Plasticity Approximation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#horizontal-canopy-spread">2.29.5.1. Horizontal Canopy Spread</a></li>
<li class="toctree-l4"><a class="reference internal" href="#definition-of-leaf-and-stem-area-profile">2.29.5.2. Definition of Leaf and Stem Area Profile</a></li>
<li class="toctree-l4"><a class="reference internal" href="#burial-of-leaf-area-by-snow">2.29.5.3. Burial of leaf area by snow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#radiation-transfer">2.29.6. Radiation Transfer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fundamental-radiation-transfer-theory">2.29.6.1. Fundamental Radiation Transfer Theory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resolution-of-radiation-transfer-theory-within-the-fates-canopy-structure">2.29.6.2. Resolution of radiation transfer theory within the FATES canopy structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#photosynthesis">2.29.7. Photosynthesis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fundamental-photosynthetic-physiology-theory">2.29.7.1. Fundamental photosynthetic physiology theory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resolution-of-the-photosynthesis-theory-within-the-fates-canopy-structure">2.29.7.2. Resolution of the photosynthesis theory within the FATES canopy structure.</a></li>
<li class="toctree-l4"><a class="reference internal" href="#variation-in-plant-physiology-with-canopy-depth">2.29.7.3. Variation in plant physiology with canopy depth</a></li>
<li class="toctree-l4"><a class="reference internal" href="#water-stress-on-gas-exchange">2.29.7.4. Water Stress on gas exchange</a></li>
<li class="toctree-l4"><a class="reference internal" href="#aggregation-of-assimilated-carbon-into-cohorts">2.29.7.5. Aggregation of assimilated carbon into cohorts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#plant-respiration">2.29.8. Plant respiration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stomatal-conductance">2.29.9. Stomatal Conductance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fundamental-stomatal-conductance-theory">2.29.9.1. Fundamental stomatal conductance theory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resolution-of-stomatal-conductance-theory-in-the-fates-canopy-structure">2.29.9.2. Resolution of stomatal conductance theory in the FATES canopy structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#allocation-and-growth">2.29.10. Allocation and Growth</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tissue-maintenance-demand">2.29.10.1. Tissue maintenance demand</a></li>
<li class="toctree-l4"><a class="reference internal" href="#allocation-to-storage-and-turnover">2.29.10.2. Allocation to storage and turnover</a></li>
<li class="toctree-l4"><a class="reference internal" href="#allocation-to-seeds">2.29.10.3. Allocation to Seeds</a></li>
<li class="toctree-l4"><a class="reference internal" href="#allocation-to-growing-pools">2.29.10.4. Allocation to growing pools</a></li>
<li class="toctree-l4"><a class="reference internal" href="#integration-of-allocated-fluxes">2.29.10.5. Integration of allocated fluxes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#control-of-leaf-area-index">2.29.11. Control of Leaf Area Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="#phenology">2.29.12. Phenology</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cold-deciduous-phenology">2.29.12.1. Cold Deciduous Phenology</a></li>
<li class="toctree-l4"><a class="reference internal" href="#drought-deciduous-phenology-tbd">2.29.12.2. Drought-deciduous Phenology: TBD</a></li>
<li class="toctree-l4"><a class="reference internal" href="#carbon-dynamics-of-deciduous-plants">2.29.12.3. Carbon Dynamics of deciduous plants</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#seed-dynamics-and-recruitment">2.29.13. Seed Dynamics and Recruitment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#litter-production-and-fragmentation">2.29.14. Litter Production and Fragmentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#litter-inputs">2.29.14.1. Litter Inputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#litter-outputs">2.29.14.2. Litter Outputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#flux-into-decompsition-cascade">2.29.14.3. Flux into decompsition cascade</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#plant-mortality">2.29.15. Plant Mortality</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fire-spitfire">2.29.16. Fire (SPITFIRE)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#properties-of-fuel-load">2.29.16.1. Properties of fuel load</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nesterov-index">2.29.16.2. Nesterov Index</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fuel-properties">2.29.16.3. Fuel properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#forward-rate-of-spread">2.29.16.4. Forward rate of spread</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fuel-consumption">2.29.16.5. Fuel Consumption</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fire-intensity">2.29.16.6. Fire Intensity</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fire-duration">2.29.16.7. Fire Duration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fire-danger-index">2.29.16.8. Fire Danger Index</a></li>
<li class="toctree-l4"><a class="reference internal" href="#area-burned">2.29.16.9. Area Burned</a></li>
<li class="toctree-l4"><a class="reference internal" href="#crown-damage">2.29.16.10. Crown Damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cambial-damage-and-kill">2.29.16.11. Cambial Damage and Kill</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../BVOCs/CLM50_Tech_Note_BVOCs.html">2.30. Biogenic Volatile Organic Compounds (BVOCs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Dust/CLM50_Tech_Note_Dust.html">2.31. Dust Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Isotopes/CLM50_Tech_Note_Isotopes.html">2.32. Carbon Isotopes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Land-Only_Mode/CLM50_Tech_Note_Land-Only_Mode.html">2.33. Land-Only Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../References/CLM50_Tech_Note_References.html">2.34. References</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ctsm</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html"><span class="section-number">2. </span>CLM Technical Note</a> &raquo;</li>
        
      <li><span class="section-number">2.28. </span>Dynamic Global Vegetation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tech_note/DGVM/CLM50_Tech_Note_DGVM.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dynamic-global-vegetation">
<span id="rst-dynamic-global-vegetation-model"></span><h1><span class="section-number">2.28. </span>Dynamic Global Vegetation<a class="headerlink" href="#dynamic-global-vegetation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-has-changed">
<h2><span class="section-number">2.28.1. </span>What has changed<a class="headerlink" href="#what-has-changed" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Deprecation of the dynamic global vegetation model (DGVM): The CLM5.0 model contains the legacy ‘CNDV’ code, which runs the CLM biogeochemistry model in combination with the LPJ-derived dynamics vegetation model introduced in CLM3. While this capacity has not technically been removed from the model, the DGVM has not been tested in the development of CLM5 and is no longer scientifically supported.</p></li>
<li><p>Introduction of FATES: The Functionally Assembled Terrestrial Ecosystem Simulator (FATES) is the actively developed DGVM for the CLM5.</p></li>
</ul>
</div>
</div>
<div class="section" id="technical-documentation-for-fates">
<span id="rst-fates"></span><h1><span class="section-number">2.29. </span>Technical Documentation for FATES<a class="headerlink" href="#technical-documentation-for-fates" title="Permalink to this headline">¶</a></h1>
<p>FATES is the “Functionally Assembled Terrestrial Ecosystem Simulator”. It is an external module which can run within a given “Host Land Model” (HLM). Currently (November 2017) implementations are supported in both the Community Land Model(CLM) and in the land model of the E3SM Dept. of Energy Earth System Model.</p>
<p>FATES was derived from the CLM Ecosystem Demography model (CLM(ED)), which was documented in:</p>
<p>Fisher, R. A., Muszala, S., Verteinstein, M., Lawrence, P., Xu, C., McDowell, N. G., Knox, R. G., Koven, C., Holm, J., Rogers, B. M., Spessa, A., Lawrence, D., and Bonan, G.: Taking off the training wheels: the properties of a dynamic vegetation model without climate envelopes, CLM4.5(ED), Geosci. Model Dev., 8, 3593-3619, <a class="reference external" href="https://doi.org/10.5194/gmd-8-3593-2015">https://doi.org/10.5194/gmd-8-3593-2015</a>, 2015.</p>
<p>and this technical note was first published as an appendix to that paper.</p>
<p><a class="reference external" href="https://pdfs.semanticscholar.org/396c/b9f172cb681421ed78325a2237bfb428eece.pdf">https://pdfs.semanticscholar.org/396c/b9f172cb681421ed78325a2237bfb428eece.pdf</a></p>
<div class="section" id="introduction">
<h2><span class="section-number">2.29.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Ecosystem Demography (‘ED’), concept within FATES is derived from the work of <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#mc-2001"><span class="std std-ref">Moorcroft et al. (2001)</span></a></p>
<p>and is a cohort model of vegetation competition and co-existence, allowing a representation of the biosphere which accounts for the division of the land surface into successional stages, and for competition for light between height structured cohorts of representative trees of various plant functional types.</p>
<p>The implementation of the Ecosystem Demography
concept within FATES links the surface flux and canopy physiology concepts in the CLM/E3SM
with numerous additional developments necessary to accommodate the new
model also documented here. These include a version of the SPITFIRE
(Spread and InTensity of Fire) model of <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. (2010)</span></a>, and an adoption of the concept of
<cite>Perfect Plasticity Approximation</cite> approach of
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#purves2008"><span class="std std-ref">Purves et al. 2008</span></a>, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#lichstein2011"><span class="std std-ref">Lichstein et al. 2011</span></a> and <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#weng2014"><span class="std std-ref">Weng et al. 2014</span></a>, in accounting
for the spatial arrangement of crowns. Novel algorithms accounting for
the fragmentation of coarse woody debris into chemical litter streams,
for the physiological optimisation of canopy thickness, for the
accumulation of seeds in the seed bank, for multi-layer multi-PFT
radiation transfer, for drought-deciduous and cold-deciduous phenology,
for carbon storage allocation, and for tree mortality under carbon
stress, are also included and presented here.</p>
<p>Numerous other implementations of the
Ecosystem Demography concept exist (See <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#fisheretal2018"><span class="std std-ref">Fisher et al. (2018)</span></a> for a review of these) Therefore, to avoid confusion between the
concept of ‘Ecosystem Demography’ and the implementation of this concept
in different models, the CLM(ED) implementation described by <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#fisheretal2015"><span class="std std-ref">Fisher et al. (2015)</span></a> will hereafter be called ‘FATES’ (the Functionally Assembled Terrestrial Ecosystem Simulator).</p>
</div>
<div class="section" id="the-representation-of-ecosystem-heterogeneity-in-fates">
<h2><span class="section-number">2.29.2. </span>The representation of ecosystem heterogeneity in FATES<a class="headerlink" href="#the-representation-of-ecosystem-heterogeneity-in-fates" title="Permalink to this headline">¶</a></h2>
<p>The terrestrial surface of the Earth is heterogeneous for many reasons, driven
by variations in climate, edaphic history, ecological variability,
geological forcing and human interventions. Land surface models
represent this variability first by introducing a grid structure to the
land surface, allowing different atmospheric forcings to operate in each
grid cell, and subsequently by representing ‘sub-grid’ variability in
the surface properties. In the CLM, the land surface is divided into
numerous ‘landunits’ corresponding to the underlying condition of the
surface (e.g. soils, ice, lakes, bare ground) and then ‘columns’
referring to elements of the surface that share below ground resources
(water &amp; nutrients). Within the soil landunit, for example, there are
separate columns for crops, and for natural vegetation, as these are
assumed to use separate resource pools. The FATES model at present
only operates on the naturally vegetated column. The soil column is
sub-divided into numerous tiles, that correspond to statistical
fractions of the potentially vegetated land area. In the CLM 4.5 (and
all previous versions of the model), sub-grid tiling operates on the
basis of plant functional types (PFTs). That is, each piece of land is
assumed to be occupied by only one plant functional type, with multiple
PFT-specific tiles sharing a common soil water and nutrient pool. This
PFT-based tiling structure is the standard method used by most land
surface models deployed in climate prediction.</p>
<p>The introduction of the Ecosystem Demography concept introduces
significant alterations to the representation of the land surface in the
CLM. In FATES, the tiling structure represents the disturbance
history of the ecosystem. Thus, some fraction of the land surface is
characterized as ‘recently disturbed’, some fraction has escaped
disturbance for a long time, and other areas will have intermediate
disturbances. Thus the ED concept essentially discretizes the trajectory
of succession from disturbed ground to ‘mature’ ecosystems. Within
FATES, each “disturbance history class” is referred to as a ‘patch’.
The word “patch”  has many possible interpretations, so it is important
to note that: <strong>there is no spatial location associated with the concept
of a ‘patch’ . It refers to a fraction of the potential vegetated area
consisting of all parts of the ecosystem with similar disturbance
history.</strong></p>
<p>The ‘patch’ organizational structure in CLM thus replaces the previous
‘PFT’ structure in the organization heirarchy. The original hierarchical
land surface organizational structure of CLM as described in
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#olesonetal2013"><span class="std std-ref">Oleson et al. 2013</span></a> may be depicted as:</p>
<div class="math">
<p><span class="math">\mathbf{gridcell} \left\{
\begin{array}{cc}
\mathbf{landunit} &amp;   \\
\mathbf{landunit} &amp;\left\{
\begin{array}{ll}
\mathbf{column}&amp;\\
\mathbf{column}&amp;\left\{
\begin{array}{ll}
\mathbf{pft}&amp;\\
\mathbf{pft}&amp;\\
\mathbf{pft}&amp;\\
\end{array}\right.\\
\mathbf{column}&amp;\\
\end{array}\right.\\
\mathbf{landunit} &amp;   \\
\end{array}\right.</span></p>
</div><p>and the new structure is altered to the following:</p>
<div class="math">
<p><span class="math">\mathbf{gridcell} \left\{
\begin{array}{cc}
\mathbf{landunit} &amp;   \\
\mathbf{landunit} &amp;\left\{
\begin{array}{ll}
\mathbf{column}&amp;\\
\mathbf{column}&amp;\left\{
\begin{array}{ll}
\mathbf{patch}&amp;\\
\mathbf{patch}&amp;\\
\mathbf{patch}&amp;\\
\end{array}\right.\\
\mathbf{column}&amp;\\
\end{array}\right.\\
\mathbf{landunit} &amp;   \\
\end{array}\right.</span></p>
</div><p>Thus, each gridcell becomes a matrix of ‘patches’ that are
conceptualized by their ‘age since disturbance’ in years. This is the
equivalent of grouping together all those areas of a gridcell that are
‘canopy gaps’, into a single entity, and all those areas that are
‘mature forest’ into a single entity.</p>
<div class="section" id="cohortized-representation-of-tree-populations">
<h3><span class="section-number">2.29.2.1. </span>Cohortized representation of tree populations<a class="headerlink" href="#cohortized-representation-of-tree-populations" title="Permalink to this headline">¶</a></h3>
<p>Each common-disturbance-history patch is a notional ecosystem that might
in reality contain numerous individual plants which vary in their
physiological attributes, in height and in spatial position. One way of
addressing this heterogeneity is to simulate a forest of specific
individuals, and to monitor their behavior through time. This is the
approach taken by “gap” and individual-based models
(<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#smith2001"><span class="std std-ref">Smith et al. 2001</span></a>, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#sato2007"><span class="std std-ref">Sato et al. 2007</span></a>, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#uriarte2009"><span class="std std-ref">Uriarte et al. 2009</span></a>, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#fyllas2014"><span class="std std-ref">Fyllas et al. 2014</span></a>). The
depiction of individuals typically implies that the outcome of the model
is stochastic. This is because we lack the necessary detailed knowledge
to simulate the individual plant’s fates. Thus gap models imply both
stochastic locations and mortality of plants. Thus, (with a genuinely
random seed) each model outcome is different, and an ensemble of model
runs is required to generate an average representative solution. Because
the random death of large individual trees can cause significant
deviations from the mean trajectory for a small plot (a typical
simulated plot size is 30m x 30 m) the number of runs required to
minimize these deviations is large and computationally expensive. For
this reason, models that resolve individual trees typically use a
physiological timestep of one day or longer (e.g.  <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#smith2001"><span class="std std-ref">Smith et al. 2001</span></a>, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#xiaodong2005"><span class="std std-ref">Xiaidong et al. 2005</span></a>, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#sato2007"><span class="std std-ref">Sato et al. 2007</span></a></p>
<p>The approach introduced by the Ecosystem Demography model
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#mc-2001"><span class="std std-ref">Moorcroft et al. 2001</span></a> is to group the hypothetical population
of plants into “cohorts”. In the notional ecosystem, after the
land-surface is divided into common-disturbance-history patches, the
population in each patch is divided first into plant functional types
(the standard approach to representing plant diversity in large scale
vegetation models), and then each plant type is represented as numerous
height classes. Importantly, <strong>for each PFT/height class bin, we model
*one* representative individual plant, which tracks the average
properties of this `cohort` of individual plants.</strong> Thus, each
common-disturbance-history patch is typically occupied by a set of
cohorts of different plant functional types, and different height
classes within those plant functional types. Each cohort is associated
with a number of identical trees, <span class="math">n_{coh}</span> (where <span class="math">{coh}</span>
denotes the identification or index number for a given cohort)..</p>
<p>The complete hierarchy of elements in FATES is therefore now
described as follows:</p>
<div class="math">
<p><span class="math">\mathbf{gridcell}\left\{
\begin{array}{cc}
\mathbf{landunit} &amp;   \\
\mathbf{landunit} &amp;\left\{
\begin{array}{ll}
\mathbf{column}&amp;\\
\mathbf{column}&amp;\left\{
\begin{array}{ll}
\mathbf{patch}&amp;\\
\mathbf{patch}&amp;\left\{
\begin{array}{ll}
\mathbf{cohort}&amp;\\
\mathbf{cohort}&amp;\\
\mathbf{cohort}&amp;\\
\end{array}\right.\\
\mathbf{patch}&amp;\\
\end{array}\right.\\
\mathbf{column}&amp;\\
\end{array}\right.\\
\mathbf{landunit} &amp;   \\
\end{array}\right.</span></p>
</div></div>
<div class="section" id="discretization-of-cohorts-and-patches">
<h3><span class="section-number">2.29.2.2. </span>Discretization of cohorts and patches<a class="headerlink" href="#discretization-of-cohorts-and-patches" title="Permalink to this headline">¶</a></h3>
<p>Newly disturbed land and newly recruited seedlings can in theory be
generated at each new model timestep as the result of germination and
disturbance processes. If the new patches and cohorts established at
<em>every</em> timestep were tracked by the model structure, the computational
load would of course be extremely high (and thus equivalent to an
individual-based approach). A signature feature of the ED model is the
system by which <cite>functionally equivalent</cite> patches and cohorts are fused
into single model entities to save memory and computational time.</p>
<p>This functionality requires that criteria are established for the
meaning of <cite>functional equivalence</cite>, which are by necessity slightly
subjective, as they represent ways of abstracting reality into a more
tractable mathematical representation. As an example of this, for
height-structured cohorts, we calculate the relativized differences in
height (<span class="math">h_{coh}</span>, m) between two cohorts of the same pft,
<span class="math">p</span> and <span class="math">q</span> as</p>
<div class="math">
<p><span class="math">d_{hite,p,q} = \frac{\mathrm{abs}.(h_{p-}h_{q})}{\frac{1}{2}(h_{p}+h_{q})}</span></p>
</div><p>If <span class="math">d_{hite,p,q}</span> is smaller than some threshold <span class="math">t_{ch}</span>,
and they are of the same plant functional type, the two cohorts are
considered equivalent and merged to form a third cohort <span class="math">r</span>, with
the properties of cohort <span class="math">p</span> and <span class="math">q</span> averaged such that they
conserve mass. The model parameter <span class="math">t_{ch}</span> can be adjusted to
adjust the trade-off between simulation accuracy and computational load.
There is no theoretical optimal value for this threshold but it may be
altered to have finer or coarser model resolutions as needed.</p>
<p>Similarly, for common-disturbance-history patches, we again assign
a threshold criteria, which is then compared to the difference between
patches <span class="math">m</span> and <span class="math">n</span>, and if the difference is less than some
threshold value (<span class="math">t_{p}</span>) then patches are merged together,
otherwise they are kept separate. However, in contrast with
height-structured cohorts, where the meaning of the difference criteria
is relatively clear, how the landscape should be divided into
common-disturbance-history units is less clear. Several alternative
criteria are possible, including Leaf Area Index, total biomass and
total stem basal area.</p>
<p>In this implementation of FATES we assess the amount of
above-ground biomass in each PFT/plant diameter bin. Biomass is first
grouped into fixed diameter bins for each PFT (<span class="math">ft</span>) and a
significant difference in any bin will cause patches to remain
separated. This means that if two patches have similar total biomass,
but differ in the distribution of that biomass between diameter classes
or plant types, they remain as separate entities. Thus</p>
<div class="math">
<p><span class="math">B_{profile,m,dc,ft} = \sum_{d_{c,min}}^{d_{c,max}} (B_{ag,coh}n_{coh})</span></p>
</div><p><span class="math">B_{profile,m,dc,ft}</span> is the binned above-ground biomass profile
for patch <span class="math">m</span>,<span class="math">d_{c}</span> is the diameter class.
<span class="math">d_{c,min}</span> and <span class="math">d_{c,max}</span> are the lower and upper
boundaries for the <span class="math">d_{c}</span> diameter class. <span class="math">B_{ag,coh}</span> and
<span class="math">n_{coh}</span> depict the biomass (KgC m<span class="math">^{-2}</span>) and the number
of individuals of each cohort respectively. A difference matrix between
patches <span class="math">m</span> and <span class="math">n</span> is thus calculated as</p>
<div class="math">
<p><span class="math">d_{biomass,mn,dc,ft} = \frac{\rm{abs}\it(B_{profile,m,hc,ft}-B_{profile,n,hc,ft})}{\frac{1}{2}(B_{profile,m,hc,ft}+B_{profile,n,hc,ft})}</span></p>
</div><p>If all the values of <span class="math">d_{biomass,mn,hc,ft}</span> are smaller than the
threshold, <span class="math">t_{p}</span>, then the patches <span class="math">m</span> and <span class="math">n</span> are
fused together to form a new patch <span class="math">o</span>.</p>
<p>To increase computational efficiency and to simplify the coding
structure of the model, the maximum number of patches is capped at
<span class="math">P_{no,max}</span>. To force the fusion of patches down to this number,
the simulation begins with a relatively sensitive discretization of
patches (<span class="math">t_{p}</span> = 0.2) but if the patch number exceeds the
maximum, the fusion routine is repeated iteratively until the two most
similar patches reach their fusion threshold. This approach maintains an
even discretization along the biomass gradient, in contrast to, for
example, simply fusing the oldest or youngest patches together.</p>
<p>The area of the new patch (<span class="math">A_{patch,o}</span>, m<span class="math">^{2}</span>)
is the sum of the area of the two existing patches,</p>
<div class="math">
<p><span class="math">A_{patch,o}  = A_{patch,n}  + A_{patch,m}</span></p>
</div><p>and the cohorts ‘belonging’ to patches <span class="math">m</span> and <span class="math">n</span> now
co-occupy patch <span class="math">o</span>. The state properties of <span class="math">m</span> and
<span class="math">n</span> (litter, seed pools, etc. ) are also averaged in accordance
with mass conservation .</p>
</div>
<div class="section" id="linked-lists-the-general-code-structure-of-fates">
<h3><span class="section-number">2.29.2.3. </span>Linked Lists: the general code structure of FATES<a class="headerlink" href="#linked-lists-the-general-code-structure-of-fates" title="Permalink to this headline">¶</a></h3>
<p>The number of patches in each natural vegetation column and the
number of cohorts in any given patch are variable through time because
they are re-calculated for each daily timestep of the model. The more
complex an ecosystem, the larger the number of patches and cohorts. For
a slowly growing ecosystem, where maximum cohort size achieved between
disturbance intervals is low, the number of cohorts is also low. For
fast-growing ecosystems where many plant types are viable and maximum
heights are large, more cohorts are required to represent the ecosystem
with adequate complexity.</p>
<p>In terms of variable structure, the creation of an array whose size
could accommodate every possible cohort would mean defining the maximum
potential number of cohorts for every potential patch, which would
result in very large amounts of wasted allocated memory, on account of
the heterogeneity in the number of cohorts between complex and simple
ecosystems (n.b. this does still happen for some variables at restart
timesteps). To resolve this, the cohort structure in FATES model
does not use an array system for internal calculations. Instead it uses
a system of <em>linked lists</em> where each cohort structure is linked to the
cohorts larger than and smaller than itself using a system of pointers.
The shortest cohort in each patch has a ‘shorter’ pointer that points to
the <em>null</em> value, and the tallest cohort has a ‘taller’ pointer that
points to the null value.</p>
<p>Instead of iterating along a vector indexed by <span class="math">coh</span>, the code
structures typically begin at the tallest cohort in a given patch, and
iterate until a null pointer is encountered.</p>
<p>Using this structure, it is therefore possible to have an unbounded upper limit on cohort number, and also to easily alter the ordering of  cohorts if, for example, a cohort of one functional type begins to  grow faster than a competitor of another functional type, and the cohort list can easily be re-ordered by altering the pointer structure. Each cohort has <cite>pointers</cite> indicating to which patch and gridcell it belongs. The patch system is analogous to the cohort system, except that patches are ordered in terms of their relative age, with pointers to older and younger patches where cp<span class="math">_1</span> is the oldest:</p>
</div>
<div class="section" id="indices-used-in-fates">
<h3><span class="section-number">2.29.2.4. </span>Indices used in FATES<a class="headerlink" href="#indices-used-in-fates" title="Permalink to this headline">¶</a></h3>
<p>Some of the indices used in FATES are similar to those used in the
standard CLM4.5 model; column (<span class="math">c</span>), land unit(<span class="math">l</span>), grid
cell(<span class="math">g</span>) and soil layer (<span class="math">j</span>). On account of the
additional complexity of the new representation of plant function,
several additional indices are introduced that describe the
discritization of plant type, fuel type, litter type, plant height,
canopy identity, leaf vertical structure and fuel moisture
characteristics. To provide a reference with which to interpret the
equations that follow, they are listed here.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 44%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter Symbol</p></th>
<th class="head"><p>Parameter Name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>ft</em></p></td>
<td><p>Plant Functional Type</p></td>
</tr>
<tr class="row-odd"><td><p><em>fc</em></p></td>
<td><p>Fuel Class</p></td>
</tr>
<tr class="row-even"><td><p><em>lsc</em></p></td>
<td><p>Litter Size Class</p></td>
</tr>
<tr class="row-odd"><td><p><em>coh</em></p></td>
<td><p>Cohort Index</p></td>
</tr>
<tr class="row-even"><td><p><em>patch</em></p></td>
<td><p>Patch Index</p></td>
</tr>
<tr class="row-odd"><td><p><em>Cl</em></p></td>
<td><p>Canopy Layer</p></td>
</tr>
<tr class="row-even"><td><p><em>z</em></p></td>
<td><p>Leaf Layer</p></td>
</tr>
<tr class="row-odd"><td><p><em>mc</em></p></td>
<td><p>Moisture Class</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cohort-state-variables">
<h3><span class="section-number">2.29.2.5. </span>Cohort State Variables<a class="headerlink" href="#cohort-state-variables" title="Permalink to this headline">¶</a></h3>
<p>The unit of allometry in the ED model is the cohort. Each cohort
represents a group of plants with similar functional types and heights
that occupy portions of column with similar disturbance histories. The
state variables of each cohort therefore consist of several pieces of
information that fully describe the growth status of the plant and its
position in the ecosystem structure, and from which the model can be
restarted. The state variables of a cohort are as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Quantity</p></th>
<th class="head"><p>Variable name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Plant
Functional Type</p></td>
<td><p><span class="math">{\it{ft}
_{coh}}</span></p></td>
<td><p>integer</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Number of
Individuals</p></td>
<td><p><span class="math">n_{coh}</span></p></td>
<td><p>n per
10000m:math:`
^{-2}`</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Height</p></td>
<td><p><span class="math">h_{coh}</span></p></td>
<td><p>m</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Diameter</p></td>
<td><p><span class="math">\it{dbh_
{coh}}</span></p></td>
<td><p>cm</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Structural
Biomass</p></td>
<td><p><span class="math">{b_{stru
c,coh}}</span></p></td>
<td><p>KgC
plant<span class="math">^
{-1}</span></p></td>
<td><p>Stem wood
(above and
below ground)</p></td>
</tr>
<tr class="row-odd"><td><p>Alive Biomass</p></td>
<td><p><span class="math">{b_{aliv
e,coh}}</span></p></td>
<td><p>KgC
plant<span class="math">^
{-1}</span></p></td>
<td><p>Leaf, fine root
and sapwood</p></td>
</tr>
<tr class="row-even"><td><p>Stored Biomass</p></td>
<td><p><span class="math">{b_{stor
e,coh}}</span></p></td>
<td><p>KgC
plant<span class="math">^
{-1}</span></p></td>
<td><p>Labile carbon
reserve</p></td>
</tr>
<tr class="row-odd"><td><p>Leaf memory</p></td>
<td><p><span class="math">{l_{memo
ry,coh}}</span></p></td>
<td><p>KgC
plant<span class="math">^
{-1}</span></p></td>
<td><p>Leaf mass when
leaves are
dropped</p></td>
</tr>
<tr class="row-even"><td><p>Canopy Layer</p></td>
<td><p><span class="math">{C_{l,co
h}}</span></p></td>
<td><p>integer</p></td>
<td><p>1 = top layer</p></td>
</tr>
<tr class="row-odd"><td><p>Phenological
Status</p></td>
<td><p><span class="math">{S_{phen
,coh}}</span></p></td>
<td><p>integer</p></td>
<td><p>1=leaves off.
2=leaves on</p></td>
</tr>
<tr class="row-even"><td><p>Canopy trimming</p></td>
<td><p><span class="math">C_{trim,
coh}</span></p></td>
<td><p>fraction</p></td>
<td><p>1.0=max leaf
area</p></td>
</tr>
<tr class="row-odd"><td><p>Patch Index</p></td>
<td><p><span class="math">{p_{coh}
}</span></p></td>
<td><p>integer</p></td>
<td><p>To which patch
does this
cohort belong?</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="patch-state-variables">
<h3><span class="section-number">2.29.2.6. </span>Patch State Variables<a class="headerlink" href="#patch-state-variables" title="Permalink to this headline">¶</a></h3>
<p>A patch, as discuss earlier, is a fraction of the landscape which
contains ecosystems with similar structure and disturbance history. A
patch has no spatial location. The state variables, which are
‘ecosystem’ rather than ‘tree’ scale properties, from which the model
can be restarted, are as follows</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Quantity</p></th>
<th class="head"><p>Variable
name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Indexed By</p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Area</p></td>
<td><p><span class="math">\it{
A_{patch}}</span></p></td>
<td><p>m<span class="math">^
{2}</span></p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Age</p></td>
<td><p><span class="math">age_
{patch}</span></p></td>
<td><p>years</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td></td>
</tr>
<tr class="row-even"><td><p>Seed</p></td>
<td><p><span class="math">seed_
{patch}</span></p></td>
<td><p>KgC
m<span class="math">^
{-2}</span></p></td>
<td><p><span class="math">ft</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Leaf Litter</p></td>
<td><p><span class="math">l_{l
itter,patch
}</span></p></td>
<td><p>KgC
m<span class="math">^
{-2}</span></p></td>
<td><p><span class="math">ft</span></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Root Litter</p></td>
<td><p><span class="math">r_{l
itter,patch
}</span></p></td>
<td><p>KgC
m<span class="math">^
{-2}</span></p></td>
<td><p><span class="math">ft</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>AG Coarse
Woody
Debris</p></td>
<td><p>:math:`
{CWD}_{A
G,patch}`</p></td>
<td><p>KgC
m<span class="math">^
{-2}</span></p></td>
<td><p>Size Class
(lsc)</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>BG Coarse
Woody
Debris</p></td>
<td><p>:math:`
{CWD}_{B
G,patch}`</p></td>
<td><p>KgC
m<span class="math">^
{-2}</span></p></td>
<td><p>Size Class
(lsc)</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Canopy
Spread</p></td>
<td><p><span class="math">S_{c
,patch}</span></p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Canopy
Layer</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Column
Index</p></td>
<td><p><span class="math">{l_{
patch}}</span></p></td>
<td><p>integer</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="model-structure">
<h3><span class="section-number">2.29.2.7. </span>Model Structure<a class="headerlink" href="#model-structure" title="Permalink to this headline">¶</a></h3>
<p>Code concerned with the Ecosystem Demography model interfaces with the
CLM model in four ways: i) During initialization, ii) During the
calculation of surface processes (albedo, radiation absorption, canopy
fluxes) each model time step (typically half-hourly), iii) During the
main invokation of the ED model code at the end of each day. Daily
cohort-level NPP is used to grow plants and alter the cohort structures,
disturbance processes (fire and mortality) operate to alter the patch
structures, and all fragmenting carbon pool dynamics are calculated. iv)
during restart reading and writing. The net assimilation (NPP) fluxes
attributed to each cohort are accumulated throughout each daily cycle
and passed into the ED code as the major driver of vegetation dynamics.</p>
</div>
</div>
<div class="section" id="initialization-of-vegetation-from-bare-ground">
<h2><span class="section-number">2.29.3. </span>Initialization of vegetation from bare ground<a class="headerlink" href="#initialization-of-vegetation-from-bare-ground" title="Permalink to this headline">¶</a></h2>
<p>If the model is restarted from a bare ground state (as opposed to a
pre-existing vegetation state), the state variables above are
initialized as follows. First, the number of plants per PFT is allocated
according to the initial seeding density (<span class="math">S_{init}</span>, individuals
per m<span class="math">^{2}</span>) and the area of the patch <span class="math">A_{patch}</span>, which
in the first timestep is the same as the area of the notional ecosystem
<span class="math">A_{tot}</span>. The model has no meaningful spatial dimension, but we
assign a notional area such that the values of ‘<span class="math">n_{coh}</span>’ can be
attributed. The default value of <span class="math">A_{tot}</span> is one hectare (10,000
m<span class="math">^{2}</span>), but the model will behave identically irrepective of
the value of this parameter.</p>
<div class="math">
<p><span class="math">n_{coh,0} = S_{init}A_{patch}</span></p>
</div><p>Each cohort is initialized at the minimum canopy height
<span class="math">h_{min,ft}</span>, which is specified as a parameter for each plant
functional type and denotes the smallest size of plant which is tracked
by the model. Smaller plants are not considered, and their emergence
from the recruitment processes is unresolved and therefore implicitly
parameterized in the seedling establishment model.. The diameter of each
cohort is then specified using the log-linear allometry between stem
diameter and canopy height</p>
<div class="math">
<p><span class="math">\mathit{dbh}_{coh} = 10^{\frac{\log_{10}(h_{coh}) - c_{allom}}{m_{allom}}  }</span></p>
</div><p>where the slope of the log-log relationship, <span class="math">m_{allom}</span> is 0.64
and the intercept <span class="math">c_{allom}</span> is 0.37. The structural biomass
associated with a plant of this diameter and height is given (as a
function of wood density, <span class="math">\rho</span>, g cm<span class="math">^{-3}</span>)</p>
<div class="math">
<p><span class="math">b_{struc,coh} =c_{str}h_{coh}^{e_{str,hite}} dbh_{coh}^{e_{str,dbh}} \rho_{ft}^{e_{str,dens}}</span></p>
</div><p>taken from the original ED1.0 allometry
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#mc-2001"><span class="std std-ref">Moorcroft et al. 2001</span></a> (values of the allometric constants in
Table <a class="reference external" href="#table:allom">[table:allom]</a>. The maximum amount of leaf
biomass associated with this diameter of tree is calculated according to
the following allometry</p>
<div class="math">
<p><span class="math">b_{max,leaf,coh} =c_{leaf}\it{dbh}_{coh}^{e_{leaf,dbh}} \rho_{ft}^{e_{leaf,dens}}</span></p>
</div><p>from this quantity, we calculate the active/fine root biomass
<span class="math">b_{root,coh}</span> as</p>
<div class="math">
<p><span class="math">b_{root,coh} =  b_{max,leaf,coh}\cdot f_{frla}</span></p>
</div><p>where <span class="math">f_{frla}</span> is the fraction of fine root biomass to leaf
biomass, assigned per PFT</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter
Symbol</p></th>
<th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Default Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math">h_{min}</span></p></td>
<td><p>Minimum plant
height</p></td>
<td><p>m</p></td>
<td><p>1.5</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">S_{init}</span></p></td>
<td><p>Initial
Planting
density</p></td>
<td><p>Individuals
m<span class="math">^{-2}</span></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math">A_{tot}</span></p></td>
<td><p>Model area</p></td>
<td><p>m<span class="math">^{2}</span></p></td>
<td><p>10,000</p></td>
</tr>
</tbody>
</table>
<p>[table:init]</p>
</div>
<div class="section" id="allocation-of-biomass">
<h2><span class="section-number">2.29.4. </span>Allocation of biomass<a class="headerlink" href="#allocation-of-biomass" title="Permalink to this headline">¶</a></h2>
<p>Total live biomass <span class="math">b_{alive}</span> is the state variable of the model
that describes the sum of the three live biomass pools leaf
<span class="math">b_{leaf}</span>, root <span class="math">b_{root}</span> and sapwood <span class="math">b_{sw}</span> (all
in kGC individual<span class="math">^{-1}</span>). The quantities are constrained by the
following</p>
<div class="math">
<p><span class="math">b_{alive} = b_{leaf} + b_{root} + b_{sw}</span></p>
</div><p>Sapwood volume is a function of tree height and leaf biomass</p>
<div class="math">
<p><span class="math">b_{sw} = b_{leaf}\cdot h_{coh}\cdot f_{swh}</span></p>
</div><p>where <span class="math">f_{swh}</span> is the ratio of sapwood mass (kgC) to leaf mass
per unit tree height (m). Also, root mass is a function of leaf mass</p>
<div class="math">
<p><span class="math">b_{root} = b_{leaf}\cdot f_{swh}</span></p>
</div><p>Thus</p>
<div class="math">
<p><span class="math">b_{alive} = b_{leaf} + b_{leaf}\cdot f_{frla} + b_{leaf}\cdot h_{coh}\cdot f_{swh}</span></p>
</div><p>Rearranging gives the fraction of biomass in the leaf pool
<span class="math">f_{leaf}</span> as</p>
<div class="math">
<p><span class="math">f_{leaf} = \frac{1}{1+h_{coh}\cdot f_{swh}+f_{frla} }</span></p>
</div><p>Thus, we can determine the leaf fraction from the height at the tissue
ratios, and the phenological status of the cohort <span class="math">S_{phen,coh}</span>.</p>
<div class="math">
<p><span class="math">b_{leaf} = b_{alive} \cdot l _{frac}</span></p>
</div><p>To divide the live biomass pool at restart, or whenever it is
recalculated, into its consituent parts, we first</p>
<div class="math">
<p><span class="math">b_{leaf} = \left\{ \begin{array}{ll}
b_{alive} \cdot l _{frac}&amp;\textrm{for } S_{phen,coh} = 1\\
&amp;\\
0&amp;\textrm{for } S_{phen,coh} = 0\\
\end{array} \right.</span></p>
</div><p>Because sometimes the leaves are dropped, using leaf biomass as a
predictor of root and sapwood would produce zero live biomass in the
winter. To account for this, we add the LAI memory variable
<span class="math">l_{memory}</span> to the live biomass pool to account for the need to
maintain root biomass when leaf biomass is zero. Thus, to calculated the
root biomass, we use</p>
<div class="math">
<p><span class="math">b_{root} = (b_{alive}+l_{memory})\cdot l_{frac} \cdot f_{frla}</span></p>
</div><p>To calculated the sapwood biomass, we use</p>
<div class="math">
<p><span class="math">b_{sw} = (b_{alive}+l_{memory})\cdot l_{frac} \cdot f_{swh} \cdot h_{coh}</span></p>
</div><table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter
Symbol</p></th>
<th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Default Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math">c_{allom
}</span></p></td>
<td><p>Allometry
intercept</p></td>
<td></td>
<td><p>0.37</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">m_{allom
}</span></p></td>
<td><p>Allometry slope</p></td>
<td></td>
<td><p>0.64</p></td>
</tr>
<tr class="row-even"><td><p><span class="math">c_{str}</span></p></td>
<td><p>Structural
biomass
multiplier</p></td>
<td></td>
<td><p>0.06896</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">e_{str,d
bh}</span></p></td>
<td><p>Structural
Biomass dbh
exponent</p></td>
<td></td>
<td><p>1.94</p></td>
</tr>
<tr class="row-even"><td><p><span class="math">e_{str,h
ite}</span></p></td>
<td><p>Structural
Biomass height
exponent</p></td>
<td></td>
<td><p>0.572</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">e_{str,d
ens}</span></p></td>
<td><p>Structural
Biomass density
exponent</p></td>
<td></td>
<td><p>0.931</p></td>
</tr>
<tr class="row-even"><td><p><span class="math">c_{leaf}</span></p></td>
<td><p>Leaf biomass
multiplier</p></td>
<td></td>
<td><p>0.0419</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">e_{leaf,
dbh}</span></p></td>
<td><p>Leaf biomass
dbh exponent</p></td>
<td></td>
<td><p>1.56</p></td>
</tr>
<tr class="row-even"><td><p><span class="math">e_{leaf,
dens}</span></p></td>
<td><p>Leaf biomass
density
exponent</p></td>
<td></td>
<td><p>0.55</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">f_{swh}</span></p></td>
<td><p>Ratio of
sapwood mass to
height</p></td>
<td><p>m<span class="math">^{-1}</span></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math">f_{frla}</span></p></td>
<td><p>Ratio of fine
root mass to
leaf mass</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>1.0</p></td>
</tr>
</tbody>
</table>
<p>[table:allom]</p>
</div>
<div class="section" id="canopy-structure-and-the-perfect-plasticity-approximation">
<h2><span class="section-number">2.29.5. </span>Canopy Structure and the Perfect Plasticity Approximation<a class="headerlink" href="#canopy-structure-and-the-perfect-plasticity-approximation" title="Permalink to this headline">¶</a></h2>
<p>During initialization and every subsequent daily ED timestep, the canopy
structure model is called to determine how the leaf area of the
different cohorts is arranged relative to the incoming radiation, which
will then be used to drive the radiation and photosynthesis
calculations. This task requires that some assumptions are made about 1)
the shape and depth of the canopy within which the plant leaves are
arranged and 2) how the leaves of different cohorts are arranged
relative to each other. This set of assumptions are critical to model
performance in ED-like cohort based models, since they determine how
light resources are partitioned between competing plants of varying
heights, which has a very significant impact on how vegetation
distribution emerges from competition
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#fisheretal2010"><span class="std std-ref">Fisher et al. 2010</span></a>.</p>
<p>The standard ED1.0 model makes a simple ‘flat disk’ assumption, that the
leaf area of each cohort is spread in an homogenous layer at one exact
height across entire the ground area represented by each patch. FATES has diverged from this representation due to (at least) two problematic emergent properties that we identified as generating unrealistic behaviours espetially for large-area patches.</p>
<p>1. Over-estimation of light competition . The vertical stacking of
cohorts which have all their leaf area at the same nominal height means
that when one cohort is only very slightly taller than it’s competitor,
it is completely shaded by it. This means that any small advantage in
terms of height growth translates into a large advantage in terms of
light competition, even at the seedling stage. This property of the
model artificially exaggerates the process of light competition. In
reality, trees do not compete for light until their canopies begin to
overlap and canopy closure is approached.</p>
<p>2. Unrealistic over-crowding. The ‘flat-disk’ assumption has no
consideration of the spatial extent of tree crowns. Therefore it has no
control on the packing density of plants in the model. Given a mismatch
between production and mortality, entirely unrealistic tree densities
are thus possible for some combinations of recruitment, growth and
mortality rates.</p>
<p>To account for the filling of space in three dimensions using the
one-dimensional representation of the canopy employed by CLM, we
implement a new scheme derived from that of
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#purves2008"><span class="std std-ref">Purves et al. 2008</span></a>. Their argument follows the development
of an individual-based variant of the SORTIE model, called SHELL, which
allows the location of individual plant crowns to be highly flexible in
space. Ultimately, the solutions of this model possess an emergent
property whereby the crowns of the plants simply fill all of the
available space in the canopy before forming a distinct understorey.</p>
<p>Purves et al. developed a model that uses this feature, called the
‘perfect plasticity approximation’, which assumes the plants are able to
perfectly fill all of the available canopy space. That is, at canopy
closure, all of the available horizontal space is filled, with
negligible gaps, owing to lateral tree growth and the ability of tree
canopies to grow into the available gaps (this is of course, an
over-simplified but potential useful ecosystem property). The ‘perfect
plasticity approximation’ (PPA) implies that the community of trees is
subdivided into discrete canopy layers, and by extension, each cohort
represented by FATES model is assigned a canopy layer status flag,
<span class="math">C_L</span>. In this version, we set the maximum number of canopy layers
at 2 for simplicity, although is possible to have a larger number of
layers in theory. <span class="math">C_{L,coh}</span> = 1 means that all the trees of
cohort <span class="math">coh</span> are in the upper canopy (overstory), and
<span class="math">C_{L,coh}</span> = 2 means that all the trees of cohort <span class="math">coh</span> are
in the understorey.</p>
<p>In this model, all the trees in the canopy experience full light on
their uppermost leaf layer, and all trees in the understorey experience
the same light (full sunlight attenuated by the average LAI of the upper
canopy) on their uppermost leaves, as described in the radiation
transfer section (more nuanced versions of this approach may be
investigated in future model versions). The canopy is assumed to be
cylindrical, the lower layers of which experience self-shading by the
upper layers.</p>
<p>To determine whether a second canopy layer is required, the model needs
to know the spatial extent of tree crowns. Crown area,
<span class="math">A_{crown}</span>, m<span class="math">^{2}</span>, is defined as</p>
<div class="math">
<p><span class="math">A_{crown,coh}  = \pi (dbh_{coh} S_{c,patch,Cl})^{1.56}</span></p>
</div><p>where <span class="math">A_{crown}</span> is the crown area of a single tree canopy
(m:math:<cite>^{-2}</cite>) and <span class="math">S_{c,patch,Cl}</span> is the ‘canopy spread’
parameter (m cm^-1) of this canopy layer, which is assigned as a
function of canopy space filling, discussed below. In contrast to
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#purves2008"><span class="std std-ref">Purves et al. 2008</span></a> , we use an exponent, identical to that
for leaf biomass, of 1.56, not 2.0, such that tree leaf area index does
not change as a function of diameter.</p>
<p>To determine whether the canopy is closed, we calculate the total canopy
area as:</p>
<div class="math">
<p><span class="math">A_{canopy} = \sum_{coh=1}^{nc,patch}{A_{crown,coh}.n_{coh}}</span></p>
</div><p>where <span class="math">nc_{patch}</span> is the number of cohorts in a given patch. If
the area of all crowns <span class="math">A_{canopy}</span> (m:math:<cite>^{-2}</cite>) is larger
than the total ground area of a patch (<span class="math">A_{patch}</span>), then some
fraction of each cohort is demoted to the understorey.</p>
<p>Under these circumstances, the <cite>extra</cite> crown area <span class="math">A_{loss}</span>
(i.e., <span class="math">A_{canopy}</span> - <span class="math">A_p</span>) is moved into the understorey.
For each cohort already in the canopy, we determine a fraction of trees
that are moved from the canopy (<span class="math">L_c</span>) to the understorey.
<span class="math">L_c</span> is calculated as <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#fisheretal2010"><span class="std std-ref">Fisher et al. 2010</span></a></p>
<div class="math">
<p><span class="math">L_{c}= \frac{A_{loss,patch} w_{coh}}{\sum_{coh=1}^{nc,patch}{w_{coh}}} ,</span></p>
</div><p>where <span class="math">w_{coh}</span> is a weighting of each cohort determined by basal
diameter <span class="math">dbh</span> (cm) and the competitive exclusion coefficient
<span class="math">C_{e}</span></p>
<div class="math">
<p><span class="math">w_{coh}=dbh_{coh}C_{e}.</span></p>
</div><p>The higher the value of <span class="math">C_e</span> the greater the impact of tree
diameter on the probability of a given tree obtaining a position in the
canopy layer. That is, for high <span class="math">C_e</span> values, competition is
highly deterministic. The smaller the value of <span class="math">C_e</span>, the greater
the influence of random factors on the competitive exclusion process,
and the higher the probability that slower growing trees will get into
the canopy. Appropriate values of <span class="math">C_e</span> are poorly constrained but
alter the outcome of competitive processes.</p>
<p>The process by which trees are moved between canopy layers is complex
because 1) the crown area predicted for a cohort to lose may be larger
than the total crown area of the cohort, which requires iterative
solutions, and 2) on some occasions (e.g. after fire), the canopy may
open up and require ‘promotion’ of cohorts from the understorey, and 3)
canopy area may change due to the variations of canopy spread values (
<span class="math">S_{c,patch,Cl}</span>, see the section below for details) when
fractions of cohorts are demoted or promoted. Further details can be
found in the code references in the footnote.</p>
<div class="section" id="horizontal-canopy-spread">
<h3><span class="section-number">2.29.5.1. </span>Horizontal Canopy Spread<a class="headerlink" href="#horizontal-canopy-spread" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../References/CLM50_Tech_Note_References.html#purves2008"><span class="std std-ref">Purves et al. 2008</span></a> estimated the ratio between canopy and
stem diameter <span class="math">c_{p}</span> as 0.1 m cm<span class="math">^{-1}</span> for canopy trees
in North American forests, but this estimate was made on trees in closed
canopies, whose shape is subject to space competition from other
individuals. Sapling trees have no constraints in their horizontal
spatial structure, and as such, are more likely to display their leaves
to full sunlight. Also, prior to canopy closure, light interception by
leaves on the sides of the canopy is also higher than it would be in a
closed canopy forest. If the ‘canopy spread’ parameter is constant for
all trees, then we simulate high levels of self-shading for plants in
unclosed canopies, which is arguably unrealistic and can lower the
productivity of trees in areas of unclosed canopy (e.g. low productivity
areas of boreal or semi-arid regions where LAI and canopy cover might
naturally be low). We here interpret the degree of canopy spread,
<span class="math">S_{c}</span> as a function of how much tree crowns interfere with each
other in space, or the total canopy area <span class="math">A_{canopy}</span>. However
<span class="math">A_{canopy}</span> itself is a function of <span class="math">S_{c}</span>, leading to a
circularity. <span class="math">S_{c}</span> is thus solved iteratively through time.</p>
<p>Each daily model step, <span class="math">A_{canopy}</span> and the fraction of the
gridcell occupied by tree canopies in each canopy layer
(<span class="math">A_{f,Cl}</span> = <span class="math">A_{canopy,Cl}</span>/<span class="math">A_{patch}</span>) is
calculated based on <span class="math">S_{c}</span> from the previous timestep. If
<span class="math">A_{f}</span> is greater than a threshold value <span class="math">A_{t}</span>,
<span class="math">S_{c}</span> is increased by a small increment <span class="math">i</span>. The threshold
<span class="math">A_{t}</span> is, hypothetically, the canopy fraction at which light
competition begins to impact on tree growth. This is less than 1.0 owing
to the non-perfect spatial spacing of tree canopies. If <span class="math">A_{f,Cl}</span>
is greater than <span class="math">A_{t}</span>, then <span class="math">S_{c}</span> is reduced by an
increment <span class="math">i</span>, to reduce the spatial extent of the canopy, thus.</p>
<div class="math">
<p><span class="math">S_{c,patch,Cl,t+1} = \left\{ \begin{array}{ll}
S_{c,patch,Cl,t} + i&amp; \textrm{for $A_{f,Cl} &lt; A_{t}$}\\
&amp;\\
S_{c,patch,Cl,t} - i&amp; \textrm{for $A_{f,Cl} &gt; A_{t}$}\\
\end{array} \right.</span></p>
</div><p>The values of <span class="math">S_{c}</span> are bounded to upper and lower limits. The
lower limit corresponds to the observed canopy spread parameter for
canopy trees <span class="math">S_{c,min}</span> and the upper limit corresponds to the
largest canopy extent <span class="math">S_{c,max}</span></p>
<div class="math">
<p><span class="math">S_{c,patch,Cl} = \left\{ \begin{array}{ll}
S_{c,min}&amp; \textrm{for } S_{c,patch,Cl}&lt; S_{c,\rm{min}}\\
&amp;\\
S_{c,max}&amp; \textrm{for } S_{c,patch,Cl} &gt; S_{c,\rm{max}}\\
\end{array} \right.</span></p>
</div><p>This iterative scheme requires two additional parameters (<span class="math">i</span> and
<span class="math">A_{t}</span>). <span class="math">i</span> affects the speed with which canopy spread
(and hence leaf are index) increase as canopy closure is neared.
However, the model is relatively insensitive to the choice of either
<span class="math">i</span> or <span class="math">A_{t}</span>.</p>
</div>
<div class="section" id="definition-of-leaf-and-stem-area-profile">
<h3><span class="section-number">2.29.5.2. </span>Definition of Leaf and Stem Area Profile<a class="headerlink" href="#definition-of-leaf-and-stem-area-profile" title="Permalink to this headline">¶</a></h3>
<p>Within each patch, the model defines and tracks cohorts of multiple
plant functional types that exist either in the canopy or understorey.
Light on the top leaf surface of each cohort in the canopy is the same,
and the rate of decay through the canopy is also the same for each PFT.
Therefore, we accumulate all the cohorts of a given PFT together for the
sake of the radiation and photosynthesis calculations (to avoid separate
calculations for every cohort).</p>
<p>Therefore, the leaf area index for each patch is defined as a
three-dimensional array <span class="math">\mathit{lai}_{Cl,ft,z}</span> where <span class="math">C_l</span>
is the canopy layer, <span class="math">ft</span> is the functional type and <span class="math">z</span> is
the leaf layer within each canopy. This three-dimensional structure is
the basis of the radiation and photosynthetic models. In addition to a
leaf area profile matrix, we also define, for each patch, the area which
is covered by leaves at each layer as <span class="math">\mathit{carea}_{Cl,ft,z}</span>.</p>
<p>Each plant cohort is already defined as a member of a single canopy
layer and functional type. This means that to generate the
<span class="math">x_{Cl,ft,z}</span> matrix, it only remains to divide the leaf area of
each cohort into leaf layers. First, we determine how many leaf layers
are occupied by a single cohort, by calculating the ‘tree LAI’ as the
total leaf area of each cohort divided by its crown area (both in
m<span class="math">^{2}</span>)</p>
<div class="math">
<p><span class="math">\mathit{tree}_{lai,coh} = \frac{b_{leaf,coh}\cdot\mathrm{sla}_{ft}}{A_{crown,coh}}</span></p>
</div><p>where <span class="math">\mathrm{sla}_{ft}</span> is the specific leaf area in
m<span class="math">^{2}</span> KgC<span class="math">^{-1}</span> and <span class="math">b_{leaf}</span> is in kGC per
plant.</p>
<p>Stem area index (SAI) is ratio of the total area of all woody stems on a
plant to the area of ground covered by the plant. During winter in
deciduous areas, the extra absorption by woody stems can have a
significant impact on the surface energy budget. However, in previous
<cite>big leaf</cite> versions of the CLM, computing the circumstances under which
stem area was visible in the absence of leaves was difficult and the
algorithm was largely heuristic as a result. Given the multi-layer
canopy introduced for FATES, we can determine the leaves in the higher
canopy layers will likely shade stem area in the lower layers when
leaves are on, and therefore stem area index can be calculated as a
function of woody biomass directly.</p>
<p>Literature on stem area index is particularly poor, as it’s estimation
is complex and not particularly amenable to the use of, for example,
assumptions of random distribution in space that are typically used to
calculate leaf area from light interception.
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#kucharik1998"><span class="std std-ref">Kucharik et al. 1998</span></a> estimated that SAI visible from an
LAI2000 sensor was around 0.5 m^2 m^-2. Low et al. 2001
estimate that the wood area index for Ponderosa Pine forest is
0.27-0.33. The existing CLM(CN) algorithm sets the minimum SAI at 0.25
to match MODIS observations, but then allows SAI to rise as a function
of the LAI lost, meaning than in some places, predicted SAI can reach
value of 8 or more. Clearly, greater scientific input on this quantity
is badly needed. Here we determine that SAI is a linear function of
woody biomass, to at very least provide a mechanistic link between the
existence of wood and radiation absorbed by it. The non-linearity
between how much woody area exists and how much radiation is absorbed is
provided by the radiation absorption algorithm. Specifically, the SAI of
an individual cohort (<span class="math">\mathrm{tree}_{sai,coh}</span>, m<span class="math">^{2}</span>
m<span class="math">^{-2}</span>) is calculated as follows,</p>
<div class="math">
<p><span class="math">\mathrm{tree}_{sai,coh} = k_{sai}\cdot b_{struc,coh} ,</span></p>
</div><p>where <span class="math">k_{sai}</span> is the coefficient linking structural biomass to
SAI. The number of occupied leaf layers for cohort <span class="math">coh</span>
(<span class="math">n_{z,coh}</span>) is then equal to the rounded up integer value of the
tree SAI (<span class="math">{tree}_{sai,coh}</span>) and LAI (<span class="math">{tree}_{lai,coh}</span>)
divided by the layer thickness (i.e., the resolution of the canopy layer
model, in units of vegetation index (<span class="math">lai</span>+<span class="math">sai</span>) with a
default value of 1.0, <span class="math">\delta _{vai}</span> ),</p>
<div class="math">
<p><span class="math">n_{z,coh} = {\frac{\mathrm{tree}_{lai,coh}+\mathrm{tree}_{sai,coh}}{\delta_{vai}}}.</span></p>
</div><p>The fraction of each layer that is leaf (as opposed to stem) can then be
calculated as</p>
<div class="math">
<p><span class="math">f_{leaf,coh} = \frac{\mathrm{tree}_{lai,coh}}{\mathrm{tree}_{sai,coh}+\mathrm{tree}_{lai,coh}}.</span></p>
</div><p>Finally, the leaf area in each leaf layer pertaining to this cohort is
thus</p>
<div class="math">
<p><span class="math">\mathit{lai}_{z,coh}  = \left\{ \begin{array}{ll}
 \delta_{vai} \cdot f_{leaf,coh} \frac{A_{canopy,coh}}{A_{canopy,patch}}&amp; \textrm{for $i=1,..., i=n_{z,coh}-1$}\\
&amp;\\
 \delta_{vai} \cdot f_{leaf,coh} \frac{A_{canopy,coh}}{A_{canopy,patch}}\cdot r_{vai}&amp; \textrm{for $i=n_{z,coh}$}\\
\end{array} \right.</span></p>
</div><p>and the stem area index is</p>
<div class="math">
<p><span class="math">\mathit{sai}_{z,coh}  = \left\{ \begin{array}{ll}
 \delta_{vai} \cdot (1-f_{leaf,coh})\frac{A_{canopy,coh}}{A_{canopy,patch}}&amp; \textrm{for $i=1,..., i=n_{z,coh}-1$}\\
&amp;\\
 \delta_{vai} \cdot (1-f_{leaf,coh}) \frac{A_{canopy,coh}}{A_{canopy,patch}}\cdot r_{vai}&amp; \textrm{for $i=n_{z,coh}$}\\
\end{array} \right.</span></p>
</div><p>where <span class="math">r_{vai}</span> is the remainder of the canopy that is below the
last full leaf layer</p>
<div class="math">
<p><span class="math">r_{vai} =(\mathrm{tree}_{lai,coh} + \mathrm{tree}_{sai,coh}) - (\delta _{vai} \cdot (n_{z,coh} -1)).</span></p>
</div><p><span class="math">A_{canopy,patch}</span> is the total canopy area occupied by plants in
a given patch (m:math:<cite>^{2}</cite>) and is calculated as follows,</p>
<div class="math">
<p><span class="math">A_{canopy,patch} = \textrm{min}\left( \sum_{coh=1}^{coh = ncoh}A_{canopy,coh}, A_{patch}  \right).</span></p>
</div><p>The canopy is conceived as a cylinder, although this assumption could be
altered given sufficient evidence that canopy shape was an important
determinant of competitive outcomes, and the area of ground covered by
each leaf layer is the same through the cohort canopy. With the
calculated SAI and LAI, we are able to calculate the complete canopy
profile. Specifically, the relative canopy area for the cohort
<span class="math">{coh}</span> is calculated as</p>
<div class="math">
<p><span class="math">\mathit{area}_{1:nz,coh}  =  \frac{A_{crown,coh}}{A_{canopy,patch}}.</span></p>
</div><p>The total occupied canopy area for each canopy layer (<span class="math">Cl</span>), plant
functional type (<span class="math">ft</span>) and leaf layer (<span class="math">z</span>) bin is thus</p>
<div class="math">
<p><span class="math">\mathit{c}_{area,Cl,ft,z} = \sum_{coh=1}^{coh=ncoh} area_{1:nz,coh}</span></p>
</div><p>where <span class="math">ft_{coh}=ft</span>  and  <span class="math">Cl_{coh} = Cl.</span></p>
<p>All of these quantities are summed across cohorts to give the complete
leaf and stem area profiles,</p>
<div class="math">
<p><span class="math">\mathit{lai} _{Cl,ft,z} = \sum_{coh=1}^{coh=ncoh} \mathit{lai}_{z,coh}</span></p>
</div><div class="math">
<p><span class="math">\mathit{sai}_{Cl,ft,z} = \sum_{coh=1}^{coh=ncoh} \mathit{sai}_{z,coh}</span></p>
</div></div>
<div class="section" id="burial-of-leaf-area-by-snow">
<h3><span class="section-number">2.29.5.3. </span>Burial of leaf area by snow<a class="headerlink" href="#burial-of-leaf-area-by-snow" title="Permalink to this headline">¶</a></h3>
<p>The calculations above all pertain to the total leaf and stem area
indices which charecterize the vegetation structure. In addition, the
model must know when the vegetation is covered by snow, and by how much,
so that the albedo and energy balance calculations can be adjusted
accordingly. Therefore, we calculated a ‘total’ and ‘exposed’
<span class="math">lai</span> and <span class="math">sai</span> profile using a representation of the bottom
and top canopy heights, and the depth of the average snow pack. For each
leaf layer <span class="math">z</span> of each cohort, we calculate an ‘exposed fraction
<span class="math">f_{exp,z}</span> via consideration of the top and bottom heights of
that layer <span class="math">h_{top,z}</span> and <span class="math">h_{bot,z}</span> (m),</p>
<div class="math">
<p><span class="math">\begin{array}{ll}
h_{top,z} = h_{coh} - h_{coh}\cdot f_{crown,ft}\cdot\frac{z}{n_{z,coh}}&amp; \\
&amp;\\
h_{bot,z} = h_{coh} - h_{coh}\cdot f_{crown,ft}\cdot\frac{z+1}{n_{z,coh}}&amp;\\
\end{array}</span></p>
</div><p>where <span class="math">f_{crown,ft}</span> is the plant functional type (<span class="math">ft</span>)
specific fraction of the cohort height that is occupied by the crown.
Specifically, the ‘exposed fraction <span class="math">f_{exp,z}</span> is calculated as
follows,</p>
<div class="math">
<p><span class="math">f_{exp,z}\left\{ \begin{array}{ll}
= 1.0 &amp;  h_{bot,z}&gt; d_{snow}\\
&amp;\\
= \frac{d_{snow} -h_{bot,z}}{h_{top,z}-h_{bot,z}}  &amp; h_{top,z}&gt; d_{snow}, h_{bot,z}&lt; d_{snow}\\
&amp;\\
= 0.0 &amp; h_{top,z}&lt; d_{snow}\\
\end{array} \right.</span></p>
</div><p>The resulting exposed (<span class="math">elai, esai</span>) and total
(<span class="math">tlai, tsai</span>) leaf and stem area indicies are calculated as</p>
<div class="math">
<p><span class="math">\begin{array}{ll}
\mathit{elai} _{Cl,ft,z} &amp;= \mathit{lai} _{Cl,ft,z} \cdot f_{exp,z}\\
\mathit{esai} _{Cl,ft,z} &amp;= \mathit{sai} _{Cl,ft,z} \cdot f_{exp,z}\\
\mathit{tlai} _{Cl,ft,z} &amp;= \mathit{lai} _{Cl,ft,z}\\
\mathit{tsai} _{Cl,ft,z} &amp;= \mathit{sai} _{Cl,ft,z} \
\end{array} ,</span></p>
</div><p>and are used in the radiation interception and photosynthesis algorithms
described later.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter
Symbol</p></th>
<th class="head"><p>Parameter
Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Notes</p></th>
<th class="head"><p>Indexed by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>:math:`
delta_
{vai}`</p></td>
<td><p>Thickness
of single
canopy
layer</p></td>
<td><p>m<span class="math">^
{-2}</span>m:
math:<cite>^{-2}</cite></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">C_e</span></p></td>
<td><p>Competitive
Exclusion
Parameter</p></td>
<td><p>none</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math">c_{p
,min}</span></p></td>
<td><p>Minimum
canopy
spread</p></td>
<td><p>m<span class="math">^
{2}</span>
cm:math:`
^{-1}`</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">c_{p
,max}</span></p></td>
<td><p>Competitive
Exclusion
Parameter</p></td>
<td><p>m<span class="math">^
{2}</span>
cm:math:`
^{-1}`</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math">i</span></p></td>
<td><p>Incremental
change in
<span class="math">c_p</span></p></td>
<td><p>m<span class="math">^
{2}</span>
cm:math:`
^{-1}`
y<span class="math">^
{-1}</span></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">A_t</span></p></td>
<td><p>Threshold
canopy
closure</p></td>
<td><p>none</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math">f_{c
rown,ft}</span></p></td>
<td><p>Crown
fraction</p></td>
<td><p>none</p></td>
<td></td>
<td><p><span class="math">ft</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">k_{s
ai}</span></p></td>
<td><p>Stem area
per unit
woody
biomass</p></td>
<td><p>m^2 KgC^-1</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="radiation-transfer">
<h2><span class="section-number">2.29.6. </span>Radiation Transfer<a class="headerlink" href="#radiation-transfer" title="Permalink to this headline">¶</a></h2>
<div class="section" id="fundamental-radiation-transfer-theory">
<h3><span class="section-number">2.29.6.1. </span>Fundamental Radiation Transfer Theory<a class="headerlink" href="#fundamental-radiation-transfer-theory" title="Permalink to this headline">¶</a></h3>
<p>The first interaction of the land surface with the properties of
vegetation concerns the partitioning of energy into that which is
absorbed by vegetation, reflected back into the atmosphere, and absorbed
by the ground surface. Older versions of the CLM have utilized a
“two-stream” approximation
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#sellers1985"><span class="std std-ref">Sellers 1985</span></a>, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#sellers1996"><span class="std std-ref">Sellers et al. 1986</span></a> that provided an
empirical solution for the radiation partitioning of a multi-layer
canopy for two streams, of diffuse and direct light. However,
implementation of the Ecosystem Demography model requires a) the
adoption of an explicit multiple layer canopy b) the implementation of a
multiple plant type canopy and c) the distinction of canopy and
under-storey layers, in-between which the radiation streams are fully
mixed. The radiation mixing between canopy layers is necessary as the
position of different plants in the under-storey is not defined
spatially or relative to the canopy trees above. In this new scheme, we
thus implemented a one-dimensional scheme that traces the absorption,
transmittance and reflectance of each canopy layer and the soil,
iterating the upwards and downwards passes of radiation through the
canopy until a pre-defined accuracy tolerance is reached. This approach
is based on the work of <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#norman1979"><span class="std std-ref">Norman 1979</span></a>.</p>
<p>Here we describe the basic theory of the radiation transfer model for
the case of a single homogenous canopy, and in the next section we
discuss how this is applied to the multi layer multi PFT canopy in the
FATES implementation. The code considers the fractions of a single
unit of incoming direct and a single unit of incoming diffuse light,
that are absorbed at each layer of the canopy for a given solar angle
(<span class="math">\alpha_{s}</span>, radians). Direct radiation is extinguished through
the canopy according to the coefficient <span class="math">k_{dir}</span> that is
calculated from the incoming solar angle and the dimensionless leaf
angle distribution parameter (<span class="math">\chi</span>) as</p>
<div class="math">
<p><span class="math">k_{dir} = g_{dir} / \sin(\alpha_s)\\</span></p>
</div><p>where</p>
<div class="math">
<p><span class="math">g_{dir} = \phi_1 + \phi_2 \cdot \sin(\alpha_s)\\</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">\begin{array} {l}
\phi_1 = 0.5 - 0.633\chi_{l} - 0.33\chi_l ^2\\
\phi_2 =0.877 (1 - 2\phi_1)\\

\end{array}</span></p>
</div><p>The leaf angle distribution is a descriptor of how leaf surfaces are
arranged in space. Values approaching 1.0 indicate that (on average) the
majority of leaves are horizontally arranged with respect to the ground.
Values approaching -1.0 indicate that leaves are mostly vertically
arranged, and a value of 0.0 denotes a canopy where leaf angle is random
(a ‘spherical’ distribution).</p>
<p>According to Beer’s Law, the fraction of light that is transferred
through a single layer of vegetation (leaves or stems) of thickness
<span class="math">\delta_{vai}</span>, without being intercepted by any surface, is</p>
<div class="math">
<p><span class="math">\mathit{tr}_{dir} = e^{-k_{dir}  \delta_{vai}}</span></p>
</div><p>and the incident direct radiation transmitted to each layer of the
canopy (<span class="math">dir_{tr,z}</span>) is thus calculated from the cumulative leaf
area ( <span class="math">L_{above}</span> ) shading each layer (<span class="math">z</span>):</p>
<div class="math">
<p><span class="math">\mathit{dir}_{tr,z} = e^{-k_{dir}  L_{above,z}}</span></p>
</div><p>The fraction of the leaves <span class="math">f_{sun}</span> that are exposed to direct
light is also calculated from the decay coefficient <span class="math">k_{dir}</span>.</p>
<div class="math">
<p><span class="math">\begin{array}{l}
f_{sun,z} = e^{-k_{dir}  L_{above,z}}\\
 \rm{and}
\\ f_{shade,z} = 1-f_{sun,z}
\end{array}</span></p>
</div><p>where <span class="math">f_{shade,z}</span> is the fraction of leaves that are shaded
from direct radiation and only receive diffuse light.</p>
<p>Diffuse radiation, by definition, enters the canopy from a spectrum of
potential incident directions, therefore the un-intercepted transfer
(<span class="math">tr_{dif}</span>) through a leaf layer of thickness <span class="math">\delta_l</span> is
calculated as the mean of the transfer rate from each of 9 different
incident light directions (<span class="math">\alpha_{s}</span>) between 0 and 180 degrees
to the horizontal.</p>
<div class="math">
<p><span class="math">\mathit{tr}_{dif} = \frac{1}{9} \sum\limits_{\alpha_s=5\pi/180}^{\alpha_s=85\pi/180} e^{-k_{dir,l} \delta_{vai}} \\ \\</span></p>
</div><div class="math">
<p><span class="math">tr_{dif}= \frac{1}{9} \pi \sum_{\alpha s=0}^{ \pi / 2}  \frac{e^{-gdir} \alpha_s}{\delta_{vai} \cdot \rm{sin}(\alpha_s) \rm{sin}(\alpha_s) \rm{cos}(\alpha_s)}</span></p>
</div><p>The fraction (1-<span class="math">tr_{dif}</span>) of the diffuse radiation is
intercepted by leaves as it passes through each leaf layer. Of this,
some fraction is reflected by the leaf surfaces and some is transmitted
through. The fractions of diffuse radiation reflected from
(<span class="math">\mathit{refl}_{dif}</span>) and transmitted though
(<span class="math">\mathit{tran}_{dif}</span>) each layer of leaves are thus,
respectively</p>
<div class="math">
<p><span class="math">\begin{array}{l}
\mathit{refl_{dif}} = (1 - tr_{dif})  \rho_{l,ft}\\
\mathit{tran}_{dif} = (1 - tr_{dif})  \tau_{l,ft} + tr_{dif}
\end{array}</span></p>
</div><p>where <span class="math">\rho_{l,ft}</span> and <span class="math">\tau_{l,ft}</span> are the fractions of
incident light reflected and transmitted by individual leaf surfaces.</p>
<p>Once we know the fractions of light that are transmitted and reflected
by each leaf layer, we begin the process of distributing light through
the canopy. Starting with the first leaf layer (<span class="math">z</span>=1), where
the incident downwards diffuse radiation (<span class="math">\mathit{dif}_{down}</span>)
is 1.0, we work downwards for <span class="math">n_z</span> layers, calculating the
radiation in the next layer down (<span class="math">z+1</span>) as:</p>
<div class="math">
<p><span class="math">\mathit{dif}_{down,z+1} = \frac{\mathit{dif}_{down,z} \mathit{tran}_{dif} }    {1 - \mathit{r}_{z+1}  \mathit{refl}_{dif}}</span></p>
</div><p>Here, <span class="math">\mathit{dif}_{down,z} \mathit{tran}_{dif}</span> calculates the
fraction of incoming energy transmitted downwards onto layer
<span class="math">z+1</span>. This flux is then increased by the additional radiation
<span class="math">r_z</span> that is reflected upwards from further down in the canopy to
layer <span class="math">z</span>, and then is reflected back downwards according to the
reflected fraction <span class="math">\mathit{refl_{dif}}</span>. The more radiation in
<span class="math">\mathit{r}_{z+1}  \mathit{refl}_{dif}</span>, the smaller the
denominator and the larger the downwards flux. <span class="math">r</span> is also
calculated sequentially, starting this time at the soil surface layer
(where <span class="math">z = n_z+1</span>)</p>
<div class="math">
<p><span class="math">r_{nz+1} = alb_s</span></p>
</div><p>where <span class="math">alb_s</span> is the soil albedo characteristic. The upwards
reflected fraction <span class="math">r_z</span> for each leaf layer, moving upwards, is
then <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#norman1979"><span class="std std-ref">Norman 1979</span></a></p>
<div class="math">
<p><span class="math">r_z  = \frac{r_{z+1}  \times \mathit{tran}_{dif}  ^{2} }{ (1 - r_{z+1}  \mathit{refl_{dif}}) + \mathit{refl_{dif}}}.</span></p>
</div><p>The corresponding upwards diffuse radiation flux is therefore the
fraction of downwards radiation that is incident on a particular layer,
multiplied by the fraction that is reflected from all the lower layers:</p>
<div class="math">
<p><span class="math">\mathit{dif}_{up,z} = r_z \mathit{dif}_{down,z+1}</span></p>
</div><p>Now we have initial conditions for the upwards and downwards diffuse
fluxes, these must be modified to account for the fact that, on
interception with leaves, direct radiation is transformed into diffuse
radiation. In addition, the initial solutions to the upwards and
downwards radiation only allow a single ‘bounce’ of radiation through
the canopy, so some radiation which might be intercepted by leaves
higher up is potentially lost. Therefore, the solution to this model is
iterative. The iterative solution has upwards and a downwards components
that calculate the upwards and downwards fluxes of total radiation at
each leaf layer (<span class="math">rad_{dn, z}</span> and <span class="math">rad_{up, z}</span>) . The
downwards component begins at the top canopy layer (<span class="math">z=1</span>). Here
we define the incoming solar diffuse and direct radiation
(<span class="math">\it{solar}_{dir}</span> and <span class="math">\it{solar}_{dir}</span> respectively).</p>
<div class="math">
<p><span class="math">\begin{array}{l}
 \mathit{dif}_{dn,1} =  \it{solar}_{dif} \\
\mathit{rad}_{dn, z+1} = \mathit{dif}_{dn,z} \cdot  \mathit{tran}_{dif}  +\mathit{dif}_{up,z+1}   \cdot  \mathit{refl}_{dif}   + \mathit{solar}_{dir}  \cdot  dir_{tr,z}  (1- tr_{dir})  \tau_l.
\end{array}</span></p>
</div><p>The first term of the right-hand side deals with the diffuse radiation
transmitted downwards, the second with the diffuse radiation travelling
upwards, and the third with the direct radiation incoming at each layer
(<span class="math">dir_{tr,z}</span>) that is intercepted by leaves
(<span class="math">1-  tr_{dir}</span>) and then transmitted through through the leaf
matrix as diffuse radiation (<span class="math">\tau_l</span>). At the bottom of the
canopy, the light reflected off the soil surface is calculated as</p>
<div class="math">
<p><span class="math">rad _{up, nz} =  \rm{\it{dif}}_{down,z}  \cdot  salb_{dif} +\it{solar}_{dir} \cdot dir_{tr,z} salb_{dir}.</span></p>
</div><p>The upwards propagation of the reflected radiation is then</p>
<div class="math">
<p><span class="math">rad_{up, z} = \mathit{dif}_{up,z+1} \cdot  \mathit{tran}_{dif}  +\mathit{dif}_{dn,z}   \cdot  \mathit{refl}_{dif}   + \it{solar}_{dir}  \cdot  dir_{tr,z}  (1- tr_{dir})  \rho_l.</span></p>
</div><p>Here the first two terms deal with the diffuse downwards and upwards
fluxes, as before, and the third deals direct beam light that is
intercepted by leaves and reflected upwards. These upwards and downwards
fluxes are computed for multiple iterations, and at each iteration,
<span class="math">rad_{up, z}</span> and <span class="math">rad_{down, z}</span> are compared to their
values in the previous iteration. The iteration scheme stops once the
differences between iterations for all layers is below a predefined
tolerance factor, (set here at <span class="math">10^{-4}</span>). Subsequently, the
fractions of absorbed direct (<span class="math">abs_{dir,z}</span>) and diffuse
(<span class="math">abs_{dif,z}</span>) radiation for each leaf layer then</p>
<div class="math">
<p><span class="math">abs_{dir,z} = \it{solar}_{dir}   \cdot dir_{tr,z} \cdot (1- tr_{dir}) \cdot (1 - \rho_l-\tau_l)</span></p>
</div><div class="math">
<p><span class="math">abs_{dif,z} = (\mathit{dif}_{dn,z} +  \mathit{dif}_{up,z+1} ) \cdot (1 - tr_{dif}) \cdot (1 - \rho_l-\tau_l).</span></p>
</div><p>and, the radiation energy absorbed by the soil for the diffuse and
direct streams is is calculated as</p>
<div class="math">
<p><span class="math">\it{abs}_{soil} = \mathit{dif}_{down,nz+1} \cdot (1 -  salb_{dif}) +\it{solar}_{dir}   \cdot dir_{tr,nz+1} \cdot (1-  salb_{dir}).</span></p>
</div><p>Canopy level albedo is denoted as the upwards flux from the top leaf
layer</p>
<div class="math">
<p><span class="math">\it{alb}_{canopy}=  \frac{\mathit{dif}_{up,z+1}  }{  \it{solar}_{dir} + \it{solar}_{dif}}</span></p>
</div><p>and the division of absorbed energy into sunlit and shaded leaf
fractions, (required by the photosynthesis calculations), is</p>
<div class="math">
<p><span class="math">abs_{sha,z} = abs_{dif,z} \cdot f_{sha}</span></p>
</div><div class="math">
<p><span class="math">abs_{sun,z} =  abs_{dif,z} \cdot f_{sun}+ abs_{dir,z}</span></p>
</div></div>
<div class="section" id="resolution-of-radiation-transfer-theory-within-the-fates-canopy-structure">
<h3><span class="section-number">2.29.6.2. </span>Resolution of radiation transfer theory within the FATES canopy structure<a class="headerlink" href="#resolution-of-radiation-transfer-theory-within-the-fates-canopy-structure" title="Permalink to this headline">¶</a></h3>
<p>The radiation transfer theory above, was described with reference to a
single canopy of one plant functional type, for the sake of clarity of
explanation. The FATES model, however, calculates radiative and
photosynthetic fluxes for a more complex hierarchical structure within
each patch/time-since-disturbance class, as described in the leaf area
profile section. Firstly, we denote two or more canopy layers (denoted
<span class="math">C_l</span>). The concept of a ‘canopy layer’ refers to the idea that
plants are organized into discrete over and under-stories, as predicted
by the Perfect Plasticity Approximation
(<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#purves2008"><span class="std std-ref">Purves et al. 2008</span></a>, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#fisheretal2010"><span class="std std-ref">Fisher et al. 2010</span></a>). Within each canopy layer
there potentially exist multiple cohorts of different plant functional
types and heights. Within each canopy layer, <span class="math">C_l</span>, and functional
type, <span class="math">ft</span>, the model resolves numerous leaf layers <span class="math">z</span>,
and, for some processes, notably photosynthesis, each leaf layer is
split into a fraction of sun and shade leaves, <span class="math">f_{sun}</span> and
<span class="math">f_{sha}</span>, respectively.</p>
<p>The radiation scheme described in Section is solved explicitly for this
structure, for both the visible and near-infrared wavebands, according
to the following assumptions.</p>
<ul class="simple">
<li><p>A <em>canopy layer</em> (<span class="math">C_{L}</span>) refers to either the over or understorey</p></li>
<li><p>A <em>leaf layer</em> (<span class="math">z</span>) refers to the discretization of the LAI
within the canopy of a given plant functional type.</p></li>
<li><p>All PFTs in the same canopy layer have the same solar radiation
incident on the top layer of the canopy</p></li>
<li><p>Light is transmitted through the canopy of each plant functional type independently</p></li>
<li><p>Between canopy layers, the light streams from different plant
functional types are mixed, such that the (undefined) spatial
location of plants in lower canopy layers does not impact the amount
of light received.</p></li>
<li><p>Where understorey layers fill less area than the overstorey layers,
radiation is directly transferred to the soil surface.</p></li>
<li><p>All these calculations pertain to a single patch, so we omit the
<cite>patch</cite> subscript for simplicity in the following discussion.</p></li>
</ul>
<p>Within this framework, the majority of the terms in the radiative
transfer scheme are calculated with indices of <span class="math">C_L</span>,
<span class="math">\it{ft}</span> and <span class="math">z</span>. In the following text, we revisit the
simplified version of the radiation model described above, and explain
how it is modified to account for the more complex canopy structure used
by FATES.</p>
<p>Firstly, the light penetration functions, <span class="math">k_{dir}</span> and
<span class="math">g_{dir}</span> are described as functions of <span class="math">\it{ft}</span>, because
the leaf angle distribution, <span class="math">\chi_l</span>, is a pft-specific
parameter. Thus, the diffuse irradiance transfer rate, <span class="math">tr_{dif}</span>
is also <span class="math">\it{ft}</span> specific because <span class="math">g_{dir}</span>, on which it
depends, is a function of <span class="math">\chi_l</span>.</p>
<p>The amount of direct light reaching each leaf layer is a function of the
leaves existing above the layer in question. If a leaf layer ‘<span class="math">z</span>’
is in the top canopy layer (the over-storey), it is only shaded by
leaves of the same PFT so <span class="math">k_{dir}</span> is unchanged from equation. If
there is more than one canopy layer (<span class="math">C_{l,max}&gt;1</span>), then the
amount of direct light reaching the top leaf surfaces of the
second/lower layer is the weighted average of the light attenuated by
all the parallel tree canopies in the canopy layer above, thus.</p>
<div class="math">
<p><span class="math">dir_{tr,Cl,:,1} =\sum_{ft=1}^{npft}{(dir_{tr,Cl,ft,z_{max}} \cdot c_{area,Cl-1,ft,z_{max}})}</span></p>
</div><p>where <span class="math">\it{pft}_{wt}</span> is the areal fraction of each canopy layer
occupied by each functional type and <span class="math">z_{max}</span> is the index of the
bottom canopy layer of each pft in each canopy layer (the subscripts
<span class="math">C_l</span> and <span class="math">ft</span> are implied but omitted from all
<span class="math">z_{max}</span> references to avoid additional complications)</p>
<p>Similarly, the sunlit fraction for a leaf layer ‘<span class="math">z</span>’ in the
second canopy layer (where <span class="math">C_l &gt; 1</span>) is</p>
<div class="math">
<p><span class="math">f_{sun,Cl,ft,z} = W_{sun,Cl} \cdot e^{k_{dir,ft,laic,z}}</span></p>
</div><p>where <span class="math">W_{sun,Cl}</span> is the weighted average sunlit fraction in the
bottom layer of a given canopy layer.</p>
<div class="math">
<p><span class="math">W_{sun,Cl} = \sum_{ft=1}^{npft}{(f_{sun,Cl-1,ft,zmax} \cdot  c_{area,Cl-1,ft,zmax})}</span></p>
</div><p>Following through the sequence of equations for the simple single pft
and canopy layer approach above, the <span class="math">\mathit{refl}_{dif}</span> and
<span class="math">\mathit{tran}_{dif}</span> fluxes are also indexed by <span class="math">C_l</span>,
<span class="math">\it{ft}</span>, and <span class="math">z</span>. The diffuse radiation reflectance ratio
<span class="math">r_z</span> is also calculated in a manner that homogenizes fluxes
between canopy layers. For the canopy layer nearest the soil
(<span class="math">C_l</span> = <span class="math">C_{l,max}</span>). For the top canopy layer
(<span class="math">C_l</span>=1), a weighted average reflectance from the lower layers
is used as the baseline, in lieu of the soil albedo. Thus:</p>
<div class="math">
<p><span class="math">r_{z,Cl,:,1} =  \sum_{ft=1}^{npft}{(r_{z,Cl-1,ft,1}   \it{pft}_{wt,Cl-1,ft,1})}</span></p>
</div><p>For the iterative flux resolution, the upwards and downwards fluxes are
also averaged between canopy layers, thus where <span class="math">C_l&gt;1</span></p>
<div class="math">
<p><span class="math">rad_{dn, Cl,ft,1} = \sum_{ft=1}^{npft}{(rad_{dn, Cl-1,ft,zmax} \cdot  \it{pft}_{wt,Cl-1,ft,zmax})}</span></p>
</div><p>and where <span class="math">C_l</span> =1, and <span class="math">C_{l,max}&gt;1</span></p>
<div class="math">
<p><span class="math">rad_{up,Cl,ft,zmax} = \sum_{ft=1}^{npft}{(rad_{up, Cl+1,ft,1} \cdot  \it{pft}_{wt,Cl+1,ft,1})}</span></p>
</div><p>The remaining terms in the radiation calculations are all also indexed
by <span class="math">C_l</span>, <span class="math">ft</span> and <span class="math">z</span> so that the fraction of
absorbed radiation outputs are termed <span class="math">abs_{dir,Cl,ft,z}</span> and
<span class="math">abs_{dif,Cl,ft,z}</span>. The sunlit and shaded absorption rates are
therefore</p>
<div class="math">
<p><span class="math">abs_{sha,Cl,ft,z} = abs_{dif,Cl,ft,z}\cdot f_{sha,Cl,ft,z}</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">abs_{sun,Cl,ft,z} =  abs_{dif,Cl,ft,z} \cdot f_{sun,Cl,ft,z}+ abs_{dir,Cl,ft,z}</span></p>
</div><p>The albedo of the mixed pft canopy is calculated as the weighted average
of the upwards radiation from the top leaf layer of each pft where
<span class="math">C_l</span>=1:</p>
<div class="math">
<p><span class="math">\it{alb}_{canopy}=  \sum_{ft=1}^{npft}{\frac{\mathit{dif}_{up,1,ft,1}    \it{pft}_{wt,1,ft,1}} {\it{solar}_{dir} + \it{solar}_{dif}}}</span></p>
</div><p>The radiation absorbed by the soil after passing through through
under-storey vegetation is:</p>
<div class="math">
<p><span class="math">\it{abs}_{soil}=  \sum_{ft=1}^{npft}{ \it{pft}_{wt,1,ft,1}( \mathit{dif}_{down,nz+1} (1 -  salb_{dif}) +\it{solar}_{dir}   dir_{tr,nz+1}  (1-  salb_{dir}))}</span></p>
</div><p>to which is added the diffuse flux coming directly from the upper
canopy and hitting no understorey vegetation.</p>
<div class="math">
<p><span class="math">\it{abs}_{soil}=  \it{abs}_{soil}+dif_{dn,2,1}  (1-  \sum_{ft=1}^{npft}{\it{pft}_{wt,1,ft,1}})  (1 -  salb_{dif})</span></p>
</div><p>and the direct flux coming directly from the upper canopy and hitting
no understorey vegetation.</p>
<div class="math">
<p><span class="math">\it{abs}_{soil}=  \it{abs}_{soil}+\it{solar}_{dir} dir_{tr,2,1}(1-  \sum_{ft=1}^{npft}{\it{pft}_{wt,1,ft,1}})  (1 -  salb_{dir})</span></p>
</div><p>These changes to the radiation code are designed to be structurally
flexible, and the scheme may be collapsed down to only include on canopy
layer, functional type and pft for testing if necessary.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter
Symbol</p></th>
<th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>indexed by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math">\chi</span></p></td>
<td><p>Leaf angle
distribution
parameter</p></td>
<td><p>none</p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">\rho_l</span></p></td>
<td><p>Fraction of
light reflected
by leaf surface</p></td>
<td><p>none</p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-even"><td><p><span class="math">\tau_l</span></p></td>
<td><p>Fraction of
light
transmitted by
leaf surface</p></td>
<td><p>none</p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">alb_s</span></p></td>
<td><p>Fraction of
light reflected
by soil</p></td>
<td><p>none</p></td>
<td><p>direct vs
diffuse</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="photosynthesis">
<h2><span class="section-number">2.29.7. </span>Photosynthesis<a class="headerlink" href="#photosynthesis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="fundamental-photosynthetic-physiology-theory">
<h3><span class="section-number">2.29.7.1. </span>Fundamental photosynthetic physiology theory<a class="headerlink" href="#fundamental-photosynthetic-physiology-theory" title="Permalink to this headline">¶</a></h3>
<p>In this section we describe the physiological basis of the
photosynthesis model before describing its application to the FATES
canopy structure. This description in this section is largely repeated
from the Oleson et al. CLM4.5 technical note but included here for
comparison with its implementation in FATES. Photosynthesis in C3
plants is based on the model of <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#farquharetal1980"><span class="std std-ref">Farquhar 1980</span></a> as
modified by <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#collatzetal1991"><span class="std std-ref">Collatz et al. (1991)</span></a>. Photosynthetic assimilation
in C4 plants is based on the model of <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#collatzetal1991"><span class="std std-ref">Collatz et al. (1991)</span></a>.
In both models, leaf photosynthesis, <span class="math">\textrm{gpp}</span>
(<span class="math">\mu</span>mol CO<span class="math">_2</span> m<span class="math">^{-2}</span> s<span class="math">^{-1}</span>) is
calculated as the minimum of three potentially limiting fluxes,
described below:</p>
<div class="math">
<p><span class="math">\textrm{gpp} = \rm{min}(w_{j}, w_{c},w_{p}).</span></p>
</div><p>The RuBP carboxylase (Rubisco) limited rate of carboxylation
<span class="math">w_{c}</span> (<span class="math">\mu</span>mol CO<span class="math">_{2}</span> m<span class="math">^{-2}</span>
s<span class="math">^{-1}</span>) is determined as</p>
<div class="math">
<p><span class="math">w_{c}=  \left\{ \begin{array}{ll}
\frac{V_{c,max}(c_{i} - \Gamma_*)}{ci+K_{c}(1+o_{i}/K_{o})} &amp; \textrm{for $C_{3}$ plants}\\
&amp;\\
V_{c,max}&amp; \textrm{for $C_{4}$ plants}\\
\end{array} \right.
c_{i}-\Gamma_*\ge 0</span></p>
</div><p>where <span class="math">c_{i}</span> is the internal leaf CO<span class="math">_{2}</span> partial
pressure (Pa) and <span class="math">o_i (0.209P_{atm}</span>) is the O<span class="math">_{2}</span>
partial pressure (Pa). <span class="math">K_{c}</span> and <span class="math">K_{o}</span> are the
Michaelis-Menten constants (Pa) for CO<span class="math">_{2}</span> and
O<span class="math">_{2}</span>. These vary with vegetation temperature <span class="math">T_v</span>
(<span class="math">^{o}</span>C) according to an Arrhenious function described in
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#olesonetal2013"><span class="std std-ref">Oleson et al. 2013</span></a>. <span class="math">V_{c,max}</span> is the leaf layer
photosynthetic capacity (<span class="math">\mu</span> mol CO<span class="math">_2</span> m<span class="math">^{-2}</span>
s<span class="math">^{-1}</span>).</p>
<p>The maximum rate of carboxylation allowed by the capacity to regenerate
RuBP (i.e., the light-limited rate) <span class="math">w_{j}</span> (<span class="math">\mu</span>mol
CO<span class="math">_2</span> m<span class="math">^{-2}</span> s<span class="math">^{-1}</span>) is</p>
<div class="math">
<p><span class="math">w_j=  \left\{ \begin{array}{ll}
\frac{J(c_i - \Gamma_*)}{4ci+8\Gamma_*} &amp; \textrm{for C$_3$ plants}\\
&amp;\\
4.6\phi\alpha &amp; \textrm{for C$_4$ plants}\\
\end{array} \right.
c_i-\Gamma_*\ge 0</span></p>
</div><p>To find <span class="math">J</span>, the electron transport rate (<span class="math">\mu</span> mol
CO<span class="math">_2</span> m<span class="math">^{-2}</span> s<span class="math">^{-1}</span>), we solve the
following quadratic term and take its smaller root,</p>
<div class="math">
<p><span class="math">\Theta_{psII}J^{2}-(I_{psII} +J_{max})J+I_{psII}J_{max} =0</span></p>
</div><p>where <span class="math">J_{max}</span> is the maximum potential rate of electron
transport (<span class="math">\mu</span>mol m<span class="math">_{-2}</span> s<span class="math">^{-1}</span>),
<span class="math">I_{PSII}</span> is the is the light utilized in electron transport by
photosystem II (<span class="math">\mu</span>mol m<span class="math">_{-2}</span> s<span class="math">^{-1}</span>) and
<span class="math">\Theta_{PSII}</span> is is curvature parameter. <span class="math">I_{PSII}</span> is
determined as</p>
<div class="math">
<p><span class="math">I_{PSII} =0.5 \Phi_{PSII}(4.6\phi)</span></p>
</div><p>where <span class="math">\phi</span> is the absorbed photosynthetically active radiation
(Wm:math:<cite>^{-2}</cite>) for either sunlit or shaded leaves (<span class="math">abs_{sun}</span>
and <span class="math">abs_{sha}</span>). <span class="math">\phi</span> is converted to photosynthetic
photon flux assuming 4.6 <span class="math">\mu</span>mol photons per joule. Parameter
values are <span class="math">\Phi_{PSII}</span> = 0.7 for C3 and <span class="math">\Phi_{PSII}</span> =
0.85 for C4 plants.</p>
<p>The export limited rate of carboxylation for C3 plants and the PEP
carboxylase limited rate of carboxylation for C4 plants <span class="math">w_e</span>
(also in <span class="math">\mu</span>mol CO<span class="math">_2</span> m<span class="math">^{-2}</span>
s<span class="math">^{-1}</span>) is</p>
<div class="math">
<p><span class="math">w_e=  \left\{ \begin{array}{ll}
3 T_{p,0} &amp; \textrm{for $C_3$ plants}\\
&amp;\\
k_{p} \frac{c_i}{P_{atm}}&amp; \textrm{for $C_4$ plants}.\\
\end{array} \right.</span></p>
</div><p><span class="math">T_{p}</span> is the triose-phosphate limited rate of photosynthesis,
which is equal to <span class="math">0.167 V_{c,max0}</span>. <span class="math">k_{p}</span> is the initial
slope of C4 CO<span class="math">_{2}</span> response curve. The Michaelis-Menten
constants <span class="math">K_{c}</span> and <span class="math">K_{o}</span> are modeled as follows,</p>
<div class="math">
<p><span class="math">K_{c} = K_{c,25}(a_{kc})^{\frac{T_v-25}{10}},</span></p>
</div><div class="math">
<p><span class="math">K_{o} = K_{o,25}(a_{ko})^{\frac{T_v-25}{10}},</span></p>
</div><p>where <span class="math">K_{c,25}</span> = 30.0 and <span class="math">K_{o,25}</span> = 30000.0 are values
(Pa) at 25 <span class="math">^{o}</span>C, and <span class="math">a_{kc}</span> = 2.1 and <span class="math">a_{ko}</span>
=1.2 are the relative changes in <span class="math">K_{c,25}</span> and <span class="math">K_{o,25}</span>
respectively, for a 10<span class="math">^{o}</span>C change in temperature. The
CO<span class="math">_{2}</span> compensation point <span class="math">\Gamma_{*}</span> (Pa) is</p>
<div class="math">
<p><span class="math">\Gamma_* = \frac{1}{2} \frac{K_c}{K_o}0.21o_i</span></p>
</div><p>where the term 0.21 represents the ratio of maximum rates of oxygenation
to carboxylation, which is virtually constant with temperature
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#farquharetal1980"><span class="std std-ref">Farquhar, 1980</span></a>.</p>
</div>
<div class="section" id="resolution-of-the-photosynthesis-theory-within-the-fates-canopy-structure">
<h3><span class="section-number">2.29.7.2. </span>Resolution of the photosynthesis theory within the FATES canopy structure.<a class="headerlink" href="#resolution-of-the-photosynthesis-theory-within-the-fates-canopy-structure" title="Permalink to this headline">¶</a></h3>
<p>The photosynthesis scheme is modified from the CLM4.5 model to give
estimates of photosynthesis, respiration and stomatal conductance for a
three dimenstional matrix indexed by canopy level (<span class="math">C_l</span>), plant
functional type (<span class="math">ft</span>) and leaf layer (<span class="math">z</span>). We conduct the
photosynthesis calculations at each layer for both sunlit and shaded
leaves. Thus, the model also generates estimates of <span class="math">w_{c},w_{j}</span>
and <span class="math">w_{e}</span> indexed in the same three dimensional matrix. In this
implementation, some properties (stomatal conductance parameters,
top-of-canopy photosynthetic capacity) vary with plant functional type,
and some vary with both functional type and canopy depth (absorbed
photosynthetically active radiation, nitrogen-based variation in
photosynthetic properties). The remaining drivers of photosynthesis
(<span class="math">P_{atm}</span>, <span class="math">K_c</span>, <span class="math">o_i</span>, <span class="math">K_o</span>, temperature,
atmospheric CO<span class="math">_2</span>) remain the same throughout the canopy. The
rate of gross photosynthesis (<span class="math">gpp_{Cl,ft,z}</span>)is the smoothed
minimum of the three potentially limiting processes (carboxylation,
electron transport, export limitation), but calculated independently for
each leaf layer:</p>
<div class="math">
<p><span class="math">\textrm{gpp}_{Cl,ft,z} = \rm{min}(w_{c,Cl,ft,z},w_{j,Cl,ft,z},w_{e,Cl,ft,z}).</span></p>
</div><p>For <span class="math">w_{c,Cl,ft,z},</span>, we use</p>
<div class="math">
<p><span class="math">w_{c,Cl,ft,z}=  \left\{ \begin{array}{ll}
\frac{V_{c,max,Cl,ft,z}(c_{i,Cl,ft,z}- \Gamma_*)}{c_{i,Cl,ft,z}+K_c(1+o_i/K_o)} &amp; \textrm{for $C_3$ plants}\\
&amp;\\
V_{c,max,Cl,ft,z}&amp; \textrm{for $C_4$ plants}\\
\end{array} \right.
c_{i,Cl,ft,z}-\Gamma_*\ge 0</span></p>
</div><p>where <span class="math">V_{c,max}</span> now varies with PFT, canopy depth and layer
(see below). Internal leaf <span class="math">CO_{2}</span> (<span class="math">c_{i,Cl,ft,z})</span> is
tracked seperately for each leaf layer. For the light limited rate
<span class="math">w_j</span>, we use</p>
<div class="math">
<p><span class="math">w_j=  \left\{ \begin{array}{ll}
\frac{J(c_i - \Gamma_*)4.6\phi\alpha}{4ci+8\Gamma_*} &amp; \textrm{for C$_3$ plants}\\
&amp;\\
4.6\phi\alpha &amp; \textrm{for C$_4$ plants}\\
\end{array} \right.</span></p>
</div><p>where <span class="math">J</span> is calculated as above but based on the absorbed
photosynthetically active radiation( <span class="math">\phi_{Cl,ft,z}</span>) for either
sunlit or shaded leaves in Wm<span class="math">^{-2}</span>. Specifically,</p>
<div class="math">
<p><span class="math">\phi_{Cl,ft,z}=  \left\{ \begin{array}{ll}
abs_{sun,Cl,ft,z}&amp; \textrm{for sunlit leaves}\\
&amp;\\
abs_{sha,Cl,ft,z}&amp; \textrm{for shaded leaves}\\
\end{array} \right.</span></p>
</div><p>The export limited rate of carboxylation for C3 plants and the PEP
carboxylase limited rate of carboxylation for C4 plants <span class="math">w_c</span>
(also in <span class="math">\mu</span>mol CO<span class="math">_2</span> m<span class="math">^{-2}</span>
s<span class="math">^{-1}</span>) is calculated in a similar fashion,</p>
<div class="math">
<p><span class="math">w_{e,Cl,ft,z}=  \left\{ \begin{array}{ll}
0.5V_{c,max,Cl,ft,z} &amp; \textrm{for $C_3$ plants}\\
&amp;\\
4000 V_{c,max,Cl,ft,z} \frac{c_{i,Cl,ft,z}}{P_{atm}}&amp; \textrm{for $C_4$ plants}.\\
\end{array} \right.</span></p>
</div></div>
<div class="section" id="variation-in-plant-physiology-with-canopy-depth">
<h3><span class="section-number">2.29.7.3. </span>Variation in plant physiology with canopy depth<a class="headerlink" href="#variation-in-plant-physiology-with-canopy-depth" title="Permalink to this headline">¶</a></h3>
<p>Both <span class="math">V_{c,max}</span> and <span class="math">J_{max}</span> vary with vertical depth in
the canopy on account of the well-documented reduction in canopy
nitrogen through the leaf profile, see <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#bonanetal2012"><span class="std std-ref">Bonan et al. 2012</span></a> for
details). Thus, both <span class="math">V_{c,max}</span> and <span class="math">J_{max}</span> are indexed
by by <span class="math">C_l</span>, <span class="math">ft</span> and <span class="math">z</span> according to the nitrogen
decay coefficient <span class="math">K_n</span> and the amount of vegetation area shading
each leaf layer <span class="math">V_{above}</span>,</p>
<div class="math">
<p><span class="math">\begin{array}{ll}
V_{c,max,Cl,ft,z} &amp; = V_{c,max0,ft} e^{-K_{n,ft}V_{above,Cl,ft,z}},\\
J_{max,Cl,ft,z} &amp; = J_{max0,ft} e^{-K_{n,ft}V_{above,Cl,ft,z}},\\
\end{array}</span></p>
</div><p>where <span class="math">V_{c,max,0}</span> and <span class="math">J_{max,0}</span> are the top-of-canopy
photosynthetic rates. <span class="math">V_{above}</span> is the sum of exposed leaf area
index (<span class="math">\textrm{elai}_{Cl,ft,z}</span>) and the exposed stem area index
(<span class="math">\textrm{esai}_{Cl,ft,z}</span>)( m<span class="math">^{2}</span> m<span class="math">^{-2}</span> ).
Namely,</p>
<div class="math">
<p><span class="math">V_{Cl,ft,z} = \textrm{elai}_{Cl,ft,z} + \textrm{esai}_{Cl,ft,z}.</span></p>
</div><p>The vegetation index shading a particular leaf layer in the top canopy
layer is equal to</p>
<div class="math">
<p><span class="math">\begin{array}{ll}
V_{above,Cl,ft,z}= \sum_{1}^{z} V_{Cl,ft,z} &amp; \textrm{for $Cl= 1$. }
\end{array}</span></p>
</div><p>For lower canopy layers, the weighted average vegetation index of the
canopy layer above (<span class="math">V_{canopy}</span>) is added to this within-canopy
shading. Thus,</p>
<div class="math">
<p><span class="math">\begin{array}{ll}
V_{above,Cl,ft,z}=  \sum_{1}^{z}  V_{Cl,ft,z} + V_{canopy,Cl-1} &amp; \textrm{for $Cl &gt;1$, }\\
\end{array}</span></p>
</div><p>where <span class="math">V_{canopy}</span> is calculated as</p>
<div class="math">
<p><span class="math">V_{canopy,Cl} =  \sum_{ft=1}^{\emph{npft}} {\sum_{z=1}^{nz(ft)} (V_{Cl,ft,z} \cdot  \it{pft}_{wt,Cl,ft,1}).}</span></p>
</div><p><span class="math">K_{n}</span> is the coefficient of nitrogen decay with canopy depth.
The value of this parameter is taken from the work of
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#lloydetal2010"><span class="std std-ref">Lloyd et al. 2010</span></a> who determined, from 204 vertical profiles
of leaf traits, that the decay rate of N through canopies of tropical
rainforests was a function of the <span class="math">V_{cmax}</span> at the top of the
canopy. They obtain the following term to predict <span class="math">K_{n}</span>,</p>
<div class="math">
<p><span class="math">K_{n,ft} = e^{0.00963 V_{c,max0,ft} - 2.43},</span></p>
</div><p>where <span class="math">V_{cmax}</span> is again in <span class="math">\mu</span>mol CO<span class="math">_2</span>
m<span class="math">^{-2}</span> s<span class="math">^{-1}</span>.</p>
</div>
<div class="section" id="water-stress-on-gas-exchange">
<h3><span class="section-number">2.29.7.4. </span>Water Stress on gas exchange<a class="headerlink" href="#water-stress-on-gas-exchange" title="Permalink to this headline">¶</a></h3>
<p>The top of canopy leaf photosynthetic capacity, <span class="math">V_{c,max0}</span>, is
also adjusted for the availability of water to plants as</p>
<div class="math">
<p><span class="math">V_{c,max0,25} = V_{c,max0,25}  \beta_{sw},</span></p>
</div><p>where the adjusting factor <span class="math">\beta_{sw}</span> ranges from one when the
soil is wet to zero when the soil is dry. It depends on the soil water
potential of each soil layer, the root distribution of the plant
functional type, and a plant-dependent response to soil water stress,</p>
<div class="math">
<p><span class="math">\beta_{sw} = \sum_{j=1}^{nj}w_{j}r_{j},</span></p>
</div><p>where <span class="math">w_{j}</span> is a plant wilting factor for layer <span class="math">j</span> and
<span class="math">r_{j}</span> is the fraction of roots in layer <span class="math">j</span>.The plant
wilting factor <span class="math">w_{j}</span> is</p>
<div class="math">
<p><span class="math">w_{j}=  \left\{ \begin{array}{ll}
\frac{\psi_c-\psi_{j}}{\psi_c - \psi_o} (\frac{\theta_{sat,j} - \theta_{ice,j}}{\theta_{sat,j}})&amp; \textrm{for $T_i &gt;$-2C}\\
&amp;\\
0 &amp; \textrm{for $T_{j} \ge$-2C}\\
\end{array} \right.</span></p>
</div><p>where <span class="math">\psi_{i}</span> is the soil water matric potential (mm) and
<span class="math">\psi_{c}</span> and <span class="math">\psi_{o}</span> are the soil water potential (mm)
when stomata are fully closed or fully open, respectively. The term in
brackets scales <span class="math">w_{i}</span> the ratio of the effective porosity (after
accounting for the ice fraction) relative to the total porosity.
<span class="math">w_{i}</span> = 0 when the temperature of the soil layer (<span class="math">T_{i}</span>
) is below some threshold (-2:math:<cite>^{o}</cite>C) or when there is no liquid
water in the soil layer (<span class="math">\theta_{liq,i} \le 0</span>). For more details
on the calculation of soil matric potential, see the CLM4.5 technical
note.</p>
<div class="section" id="variation-of-water-stress-and-water-uptake-within-tiles">
<h4><span class="section-number">2.29.7.4.1. </span>Variation of water stress and water uptake within tiles<a class="headerlink" href="#variation-of-water-stress-and-water-uptake-within-tiles" title="Permalink to this headline">¶</a></h4>
<p>The remaining drivers of the photosynthesis model remain constant
(atmospheric CO<span class="math">_2</span> and O<span class="math">^2</span> and canopy temperature)
throughout the canopy, except for the water stress index
<span class="math">\beta_{sw}</span>. <span class="math">\beta_{sw}</span> must be indexed by <span class="math">ft</span>,
because plants of differing functional types have the capacity to have
varying root depth, and thus access different soil moisture profile and
experience differing stress functions. Thus, the water stress function
applied to gas exchange calculation is now calculated as</p>
<div class="math">
<p><span class="math">\beta_{sw,ft} = \sum_{j=1}^{nj}w_{j,ft} r_{j,ft},</span></p>
</div><p>where <span class="math">w_{j}</span> is the water stress at each soil layer <span class="math">j</span>
and <span class="math">r_{j,ft}</span> is the root fraction of each PFT’s root mass in
layer <span class="math">j</span>. Note that this alteration of the <span class="math">\beta_{sw}</span>
parameter also necessitates recalculation of the vertical water
extraction profiles. In the original model, the fraction of extraction
from each layer (<span class="math">r_{e,j,patch}</span>) is the product of a single root
distribution, because each patch only has one plant functional type. In
FATES, we need to calculate a new weighted patch effective rooting
depth profile <span class="math">r_{e,j,patch}</span> as the weighted average of the
functional-type level stress functions and their relative contributions
to canopy conductance. Thus for each layer <span class="math">j</span>, the extraction
fraction is summed over all PFTs as</p>
<div class="math">
<p><span class="math">r_{e,j,patch} =  \sum_{ft=1}^{ft=npft} \frac{w_{j,ft}}{\sum_{j=1}^{=nj} w_{j,ft} }\frac{G_{s,ft}}{G_{s,canopy}},</span></p>
</div><p>where <span class="math">nj</span> is the number of soil layers, <span class="math">G_{s,canopy}</span>is
the total canopy (see section 9 for details) and <span class="math">G_{s,ft}</span> is the
canopy conductance for plant functional type <span class="math">ft</span>,</p>
<div class="math">
<p><span class="math">G_{s,ft}= \sum_{1}w_{ncoh,ft} {gs_{can,coh} n_{coh} }.</span></p>
</div></div>
</div>
<div class="section" id="aggregation-of-assimilated-carbon-into-cohorts">
<h3><span class="section-number">2.29.7.5. </span>Aggregation of assimilated carbon into cohorts<a class="headerlink" href="#aggregation-of-assimilated-carbon-into-cohorts" title="Permalink to this headline">¶</a></h3>
<p>The derivation of photosynthetic rates per leaf layer, as above, give us
the estimated rate of assimilation for a unit area of leaf at a given
point in the canopy in <span class="math">\mu</span>mol CO<span class="math">_2</span> m<span class="math">^{-2}</span>
s<span class="math">_{-1}</span>. To allow the integration of these rates into fluxes
per individual tree, or cohort of trees (gCO:math:<cite>_2</cite>
tree<span class="math">^{-1}</span> s<span class="math">^{-1}</span>), they must be multiplied by the
amount of leaf area placed in each layer by each cohort. Each cohort is
described by a single functional type, <span class="math">ft</span> and canopy layer
<span class="math">C_l</span> flag, so the problem is constrained to integrating these
fluxes through the vertical profile (<span class="math">z</span>).</p>
<p>We fist make a weighted average of photosynthesis rates from sun
(<span class="math">\textrm{gpp}_{sun}</span>, <span class="math">\mu</span>mol CO<span class="math">_2</span>
m<span class="math">^{-2}</span> s<span class="math">^{-1}</span>) and shade leaves (
<span class="math">\textrm{gpp}_{shade}</span>, <span class="math">\mu</span>mol CO<span class="math">_2</span>
m<span class="math">^{-2}</span> s<span class="math">^{-1}</span>) as</p>
<div class="math">
<p><span class="math">\textrm{gpp}_{Cl,ft,z} =\textrm{gpp}_{sun,Cl,ft,z} f_{sun,Cl,ft,z}+ \textrm{gpp}_{sha,Cl,ft,z}(1-f_{sun,Cl,ft,z}).</span></p>
</div><p>The assimilation per leaf layer is then accumulated across all the leaf
layers in a given cohort (<em>coh</em>) to give the cohort-specific gross
primary productivity (<span class="math">\mathit{GPP}_{coh}</span>),</p>
<div class="math">
<p><span class="math">\textit{GPP}_{coh} = 12\times 10^{-9}\sum_{z=1}^{nz(coh)}gpp_{Cl,ft,z} A_{crown,coh} \textrm{elai}_{Cl,ft,z}</span></p>
</div><p>The <span class="math">\textrm{elai}_{l,Cl,ft,z}</span> is the exposed leaf area which is
present in each leaf layer in m<span class="math">^{2}</span> m<span class="math">^{-2}</span>. (For all
the leaf layers that are completely occupied by a cohort, this is the
same as the leaf fraction of <span class="math">\delta_{vai}</span>). The fluxes are
converted from <span class="math">\mu</span>mol into mol and then multiplied by 12 (the
molecular weight of carbon) to give units for GPP<span class="math">_{coh}</span> of KgC
cohort<span class="math">^{-1}</span> s<span class="math">^{-1}</span>. These are integrated for each
timestep to give KgC cohort<span class="math">^{-1}</span> day<span class="math">^{-1}</span></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter
Symbol</p></th>
<th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>indexed by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math">V_{c,max
0}</span></p></td>
<td><p>Maximum
carboxylation
capacity</p></td>
<td><p><span class="math">\mu</span> mol
CO <span class="math">_2</span>
m <span class="math">^{-2}</span>
s <span class="math">^{-1}</span></p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">r_b</span></p></td>
<td><p>Base Rate of
Respiration</p></td>
<td><p>gC
gN<span class="math">^{-1
} s^{-1}</span>)</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math">q_{10}</span></p></td>
<td><p>Temp. Response
of stem and
root
respiration</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">R_{cn,le
af,ft}</span></p></td>
<td><p>CN ratio of
leaf matter</p></td>
<td><p>gC/gN</p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-even"><td><p><span class="math">R_{cn,ro
ot,ft}</span></p></td>
<td><p>CN ratio of
root matter</p></td>
<td><p>gC/gN</p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">f_{gr}</span></p></td>
<td><p>Growth
Respiration
Fraction</p></td>
<td><p>none</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math">\psi_c</span></p></td>
<td><p>Water content
when stomata
close</p></td>
<td><p>Pa</p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">\psi_o</span></p></td>
<td><p>Water content
above which
stomata are
open</p></td>
<td><p>Pa</p></td>
<td><p><em>ft</em></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="plant-respiration">
<h2><span class="section-number">2.29.8. </span>Plant respiration<a class="headerlink" href="#plant-respiration" title="Permalink to this headline">¶</a></h2>
<p>Plant respiration per individual <span class="math">R_{plant,coh}</span> (KgC individual
<span class="math">^{-1}</span> s<span class="math">^{-1}</span>) is the sum of two terms, growth and
maintenance respiration <span class="math">R_{g,coh}</span> and <span class="math">R_{m,coh}</span></p>
<div class="math">
<p><span class="math">R_{plant} = R_{g,coh}+ R_{m,coh}</span></p>
</div><p>Maintenance respiration is the sum of the respiration terms from four
different plant tissues, leaf, <span class="math">R_{m,leaf,coh}</span>, fine root
<span class="math">R_{m,froot,coh}</span>, coarse root <span class="math">R_{m,croot,coh}</span>and stem
<span class="math">R_{m,stem,coh}</span>, all also in (KgC individual <span class="math">^{-1}</span>
s<span class="math">^{-1}</span>) .</p>
<div class="math">
<p><span class="math">R_{m,coh} = R_{m,leaf,coh}+ R_{m,froot,coh}+R_{m,croot,coh}+R_{m,stem,coh}</span></p>
</div><p>To calculate canopy leaf respiration, which varies through we canopy, we
first determine the top-of-canopy leaf respiration rate
(<span class="math">r_{m,leaf,ft,0}</span>, gC s<span class="math">^{-1}</span> m<span class="math">^{-2}</span>) is
calculated from a base rate of respiration per unit leaf nitrogen
derived from <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#ryan1991"><span class="std std-ref">Ryan et al. 1991</span></a>. The base rate for leaf
respiration (<span class="math">r_{b}</span>) is 2.525 gC/gN s<span class="math">^{-1}</span>,</p>
<div class="math">
<p><span class="math">r_{m,leaf,ft,0} = r_{b} N_{a,ft}(1.5^{(25-20)/10})</span></p>
</div><p>where <span class="math">r_b</span> is the base rate of metabolism (2.525 x
10<span class="math">^6</span> gC/gN s<span class="math">^{-1}</span>. This base rate is adjusted
assuming a Q<span class="math">_{10}</span> of 1.5 to scale from the baseline of 20C to
the CLM default base rate temperature of 25C. For use in the
calculations of net photosynthesis and stomatal conductance, leaf
respiration is converted from gC s<span class="math">^{-1}</span> m<span class="math">^{-2}</span>, into
<span class="math">\mu</span>mol CO<span class="math">_2</span> m<span class="math">^{-2}</span> s<span class="math">^{-1}</span>
(<span class="math">/12\cdot 10^{-6}</span>).</p>
<p>This top-of-canopy flux is scaled to account for variation in
<span class="math">N_a</span> through the vertical canopy, in the same manner as the
<span class="math">V_{c,max}</span> values are scaled using <span class="math">V_{above}</span>.</p>
<div class="math">
<p><span class="math">r_{leaf,Cl,ft,z}  = r_{m,leaf,ft,0} e^{-K_{n,ft}V_{above,Cl,ft,z}}\beta_{ft}f(t)</span></p>
</div><p>Leaf respiration is also adjusted such that it is reduced by drought
stress, <span class="math">\beta_{ft}</span>, and canopy temperature, <span class="math">f(t_{veg})</span>.
For details of the temperature functions affecting leaf respiration see
the CLM4 technical note, Section 8, Equations 8.13 and 8.14. The
adjusted leaf level fluxes are scaled to individual-level (gC individual
<span class="math">^{-1}</span> s<span class="math">^{-1}</span>) in the same fashion as the
<span class="math">\rm{GPP}_{coh}</span> calculations</p>
<div class="math">
<p><span class="math">\rm{R}_{m,leaf,coh} = 12\times 10^{-9}\sum_{z=1}^{nz(coh)}r_{leaf,Cl,ft,z} A_{crown} \textrm{elai}_{Cl,ft,z}</span></p>
</div><p>The stem and the coarse-root respiration terms are derived using the
same base rate of respiration per unit of tissue Nitrogen.</p>
<div class="math">
<p><span class="math">R_{m,croot,coh} =  10^{-3}r_b t_c \beta_{ft} N_{\rm{livecroot,coh}}</span></p>
</div><div class="math">
<p><span class="math">R_{m,stem,coh} =   10^{-3}r_b t_c \beta_{ft} N_{\rm{stem,coh}}</span></p>
</div><p>Here, <span class="math">t_c</span> is a temperature relationship based on a
<span class="math">q_{10}</span> value of 1.5, where <span class="math">t_v</span> is the vegetation
temperature. We use a base rate of 20 here as, again, this is the
baseline temperature used by <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#ryan1991"><span class="std std-ref">Ryan et al. 1991</span></a>. The
10<span class="math">^{-3}</span> converts from gC invididual<span class="math">^{-1}</span>
s<span class="math">^{-1}</span> to KgC invididual<span class="math">^{-1}</span> s<span class="math">^{-1}</span></p>
<div class="math">
<p><span class="math">t_c=q_{10}^{(t_{v} - 20)/10}</span></p>
</div><p>The tissue N contents for live sapwood are derived from the leaf CN
ratios, and for fine roots from the root CN ratio as:</p>
<div class="math">
<p><span class="math">N_{\rm{stem,coh}}  = \frac{B_{\rm{sapwood,coh}}}{ R_{cn,leaf,ft}}</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">N_{\rm{livecroot,coh}}  = \frac{ B_{\rm{root,coh}}w_{frac,ft}}{R_{cn,root,ft}}</span></p>
</div><p>where <span class="math">B_{\rm{sapwood,coh}}</span> and <span class="math">B_{\rm{root,coh}}</span> are
the biomass pools of sapwood and live root biomass respectively (KgC
individual) and <span class="math">w_{frac,ft}</span> is the fraction of coarse root
tissue in the root pool (0.5 for woody plants, 0.0 for grasses and
crops). We assume here that stem CN ratio is the same as the leaf C:N
ratio, for simplicity. The final maintenance respiration term is derived
from the fine root respiration, which accounts for gradients of
temperature in the soil profile and thus calculated for each soil layer
<span class="math">j</span> as follows:</p>
<div class="math">
<p><span class="math">R_{m,froot,j } = \frac{(1 - w_{frac,ft})B_{\rm{root,coh}}b_r\beta_{ft}}{10^3R_{cn,leaf,ft}}   \sum_{j=1}^{nj}t_{c,soi,j} r_{i,ft,j}</span></p>
</div><p><span class="math">t_{c,soi}</span> is a function of soil temperature in layer <span class="math">j</span>
that has the same form as that for stem respiration, but uses vertically
resolved soil temperature instead of canopy temperature. In the CLM4.5,
only coarse and not fine root respriation varies as a function of soil
depth, and we maintain this assumption here, although it may be altered
in later versions. The growth respiration, <span class="math">R_{g,coh}</span> is a fixed
fraction <span class="math">f_{gr}</span> of the carbon remaining after maintenance
respiration has occurred.</p>
<div class="math">
<p><span class="math">R_{g,coh}=\textrm{max}(0,GPP_{g,coh} - \it R\rm_{m,coh})f_{gr}</span></p>
</div><table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter
Symbol</p></th>
<th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>indexed by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math">-K_{n,ft
}</span></p></td>
<td><p>Rate of
reduction of N
through the
canopy</p></td>
<td><p>none</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><span class="math">r_b</span></p></td>
<td><p>Base Rate of
Respiration</p></td>
<td><p>gC
gN<span class="math">^{-1
} s^{-1}</span>)</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math">q_{10}</span></p></td>
<td><p>Temp. Response
of stem and
root
respiration</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">R_{cn,le
af,ft}</span></p></td>
<td><p>CN ratio of
leaf matter</p></td>
<td><p>gC/gN</p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-even"><td><p><span class="math">R_{cn,ro
ot,ft}</span></p></td>
<td><p>CN ratio of
root matter</p></td>
<td><p>gC/gN</p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">f_{gr}</span></p></td>
<td><p>Growth
Respiration
Fraction</p></td>
<td><p>none</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="stomatal-conductance">
<h2><span class="section-number">2.29.9. </span>Stomatal Conductance<a class="headerlink" href="#stomatal-conductance" title="Permalink to this headline">¶</a></h2>
<div class="section" id="fundamental-stomatal-conductance-theory">
<h3><span class="section-number">2.29.9.1. </span>Fundamental stomatal conductance theory<a class="headerlink" href="#fundamental-stomatal-conductance-theory" title="Permalink to this headline">¶</a></h3>
<p>Stomatal conductance is unchanged in concept from the CLM4.5 approach.
Leaf stomatal resistance is calculated from the Ball-Berry conductance
model as described by <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#collatzetal1991"><span class="std std-ref">Collatz et al. (1991)</span></a> and implemented in
a global climate model by <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#sellers1996"><span class="std std-ref">Sellers et al. 1996</span></a>. The model
relates stomatal conductance (i.e., the inverse of resistance) to net
leaf photosynthesis, scaled by the relative humidity at the leaf surface
and the CO<span class="math">_2</span> concentration at the leaf surface. The primary
difference between the CLM implementation and that used by
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#collatzetal1991"><span class="std std-ref">Collatz et al. (1991)</span></a> and <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#sellers1996"><span class="std std-ref">Sellers et al. (1996)</span></a> is
that they used net photosynthesis (i.e., leaf photosynthesis minus leaf
respiration) instead of gross photosynthesis. As implemented here,
stomatal conductance equals the minimum conductance (<span class="math">b</span>) when
gross photosynthesis (<span class="math">A</span>) is zero. Leaf stomatal resistance is</p>
<div class="math">
<p><span class="math">\frac{1}{r_{s}} = m_{ft} \frac{A}{c_s}\frac{e_s}{e_i}P_{atm}+b_{ft} \beta_{sw}</span></p>
</div><p>where <span class="math">r_{s}</span> is leaf stomatal resistance (s m<span class="math">^2</span>
<span class="math">\mu</span>mol<span class="math">^{-1}</span>), <span class="math">b_{ft}</span> is a plant functional
type dependent parameter equivalent to <span class="math">g_{0}</span> in the Ball-Berry
model literature. This parameter is also scaled by the water stress
index <span class="math">\beta_{sw}</span>. Similarly, <span class="math">m_{ft}</span> is the slope of the
relationship between the assimilation, <span class="math">c_s</span> and humidty dependant
term and the stomatal conductance, and so is equivalent to the
<span class="math">g_{1}</span> term in the stomatal literature. <span class="math">A</span> is leaf
photosynthesis (<span class="math">\mu</span>mol CO<span class="math">_2</span> m<span class="math">^{-2}</span>
s<span class="math">^{-1}</span>), <span class="math">c_s</span> is the CO<span class="math">_2</span> partial pressure at
the leaf surface (Pa), <span class="math">e_s</span> is the vapor pressure at the leaf
surface (Pa), <span class="math">e_i</span> is the saturation vapor pressure (Pa) inside
the leaf at the vegetation temperature conductance (<span class="math">\mu</span>mol
m<span class="math">^{-2}</span> s<span class="math">^{-1}</span>) when <span class="math">A</span> = 0 . Typical values
are <span class="math">m_{ft}</span> = 9 for C<span class="math">_3</span> plants and <span class="math">m_{ft}</span> = 4
for C<span class="math">_4</span> plants (
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#collatzetal1991"><span class="std std-ref">Collatz et al. 1991</span></a>, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#collatzetal1992"><span class="std std-ref">Collatz, 1992</span></a>, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#sellersetal1996"><span class="std std-ref">Sellers et al 1996</span></a>).
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#sellers1996"><span class="std std-ref">Sellers et al. 1996</span></a> used <span class="math">b</span> = 10000 for C<span class="math">_3</span>
plants and <span class="math">b</span> = 40000 for C<span class="math">_4</span> plants. Here, <span class="math">b</span>
was chosen to give a maximum stomatal resistance of 20000 s
m<span class="math">^{-1}</span>. These terms are nevertheless plant strategy dependent,
and have been found to vary widely with plant type
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#medlynetal2011"><span class="std std-ref">Medlyn et al. 2011</span></a>.</p>
<p>Resistance is converted from units of s m<span class="math">^2 \mu</span>
mol<span class="math">^{-1}</span> to s m<span class="math">^{-1}</span> as: 1 s m<span class="math">^{-1}</span> =
<span class="math">1\times 10^{-9}</span>R<span class="math">_{\rm{gas}} \theta_{\rm{atm}}P_{\rm{atm}}</span>
(<span class="math">\mu</span>mol<span class="math">^{-1}</span> m<span class="math">^{2}</span> s), where
R<span class="math">_{gas}</span> is the universal gas constant (J K<span class="math">^{-1}</span>
kmol<span class="math">^{-1}</span>) and <span class="math">\theta_{atm}</span> is the atmospheric
potential temperature (K).</p>
</div>
<div class="section" id="resolution-of-stomatal-conductance-theory-in-the-fates-canopy-structure">
<h3><span class="section-number">2.29.9.2. </span>Resolution of stomatal conductance theory in the FATES canopy structure<a class="headerlink" href="#resolution-of-stomatal-conductance-theory-in-the-fates-canopy-structure" title="Permalink to this headline">¶</a></h3>
<p>The stomatal conductance is calculated, as with photosynthesis, for each
canopy, PFT and leaf layer. The CLM code requires a single canopy
conductance estimate to be generated from the multi-layer multi-PFT
array. In previous iterations of the CLM, sun and shade-leaf specific
values have been reported and then averaged by their respective leaf
areas. In this version, the total canopy condutance
<span class="math">G_{s,canopy}</span>, is calculated as the sum of the cohort-level
conductance values.</p>
<div class="math">
<p><span class="math">G_{s,canopy} =  \sum{ \frac{gs_{can,coh} n_{coh} }{A_{patch}}}</span></p>
</div><p>Cohort conductance is the sum of the inverse of the leaf resistances at
each canopy layer (<span class="math">r_{s,z}</span> ) multipled by the area of each
cohort.</p>
<div class="math">
<p><span class="math">gs_{can,coh} =\sum_{z=1}^{z=nv,coh}{\frac{ A_{crown,coh}}{r_{s,cl,ft,z}+r_{b}}}</span></p>
</div><table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 41%" />
<col style="width: 11%" />
<col style="width: 19%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter Symbol</p></th>
<th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>indexed by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math">b_{ft}</span></p></td>
<td><p>Slope of Ball-Berry term</p></td>
<td><p>none</p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">m_{ft}</span></p></td>
<td><p>Slope of Ball-Berry term</p></td>
<td><p>none</p></td>
<td><p><em>ft</em></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="allocation-and-growth">
<h2><span class="section-number">2.29.10. </span>Allocation and Growth<a class="headerlink" href="#allocation-and-growth" title="Permalink to this headline">¶</a></h2>
<p>Total assimilation carbon enters the ED model each day as a
cohort-specific Net Primary Productivity <span class="math">\mathit{NPP}_{coh}</span>,
which is calculated as</p>
<div class="math">
<p><span class="math">\mathit{NPP}_{coh} = \mathit{GPP}_{coh} - R_{plant,coh}</span></p>
</div><p>This flux of carbon is allocated between the demands of tissue turnover,
of carbohydrate storage and of growth (increase in size of one or many
plant organs). Priority is explicitly given to maintenance respiration,
followed by tissue maintenance and storage, then allocation to live
biomass and then to the expansion of structural and live biomass pools.
All fluxes here are first converted into in KgC
individual<span class="math">^{-1}</span> year<span class="math">^{-1}</span> and ultimately integrated
using a timesteps of 1/365 years for each day.</p>
<div class="section" id="tissue-maintenance-demand">
<h3><span class="section-number">2.29.10.1. </span>Tissue maintenance demand<a class="headerlink" href="#tissue-maintenance-demand" title="Permalink to this headline">¶</a></h3>
<p>We calculate a ‘tissue maintenance’ flux. The magnitude of this flux is
such that the quantity of biomass in each pool will remain constant,
given background turnover rates. For roots, this maintenenace demand is
simply</p>
<div class="math">
<p><span class="math">r_{md,coh}  = b_{root}\cdot\alpha_{root,ft}</span></p>
</div><p>Where <span class="math">\alpha_{root,ft}</span> is the root turnover rate in y^-1. Given
that, for deciduous trees, loss of leaves is assumed to happen only one
per growing season, the algorithm is dependent on phenological habit
(whether or not this PFT is evergreen), thus</p>
<div class="math">
<p><span class="math">l_{md,coh} = \left\{ \begin{array}{ll}
 b_{leaf}\cdot\alpha_{leaf,ft}&amp;\textrm{for } P_{evergreen}= 1\\
&amp;\\
0&amp;\textrm{for }  P_{evergreen}= 0\\
\end{array} \right.</span></p>
</div><p>Leaf litter resulting from deciduous senescence is handled in the
phenology section. The total quantity of maintenance demand
(<span class="math">t_{md,coh}</span>. KgC individual y<span class="math">^{-1}</span>) is therefore</p>
<div class="math">
<p><span class="math">t_{md,coh}  = l_{md,coh} + r_{md,coh}</span></p>
</div></div>
<div class="section" id="allocation-to-storage-and-turnover">
<h3><span class="section-number">2.29.10.2. </span>Allocation to storage and turnover<a class="headerlink" href="#allocation-to-storage-and-turnover" title="Permalink to this headline">¶</a></h3>
<p>The model must now determine whether the NPP input is sufficient to meet
the maintenance demand and keep tissue levels constant. To determine
this, we introduce the idea of ‘carbon balance’ <span class="math">C_{bal,coh}</span> (KgC
individual<span class="math">^{-1}</span>) where</p>
<div class="math">
<p><span class="math">C_{bal,coh}= \mathit{NPP}_{coh} - t_{md,coh}\cdot f_{md,min,ft}</span></p>
</div><p>where <span class="math">f_{md,min,ft}</span> is the minimum fraction of the maintenance
demand that the plant must meet each timestep, which is indexed by <em>ft</em>
and represents a life-history-strategy decision concerning whether
leaves should remain on in the case of low carbon uptake (a risky
strategy) or not be replaced (a conservative strategy). Subsequently, we
determine a flux to the storage pool, where the flux into the pool, as a
fraction of <span class="math">C_{bal,coh}</span>, is proportional to the discrepancy
between the target pool size and the actual pool size <span class="math">f_{tstore}</span>
where</p>
<div class="math">
<p><span class="math">f_{tstore} =  \mathrm{max}\left(0,\frac{b_{store}}{b_{leaf}\cdot S_{cushion}}\right)</span></p>
</div><p>The allocation to storage is a fourth power function of
<span class="math">f_{tstore}</span> to mimic the qualitative behaviour found for carbon
allocation in arabidopsis by <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#smith2007"><span class="std std-ref">Smith et al. 2007</span></a>.</p>
<div class="math">
<p><span class="math">\frac{\delta b_{store}}{\delta t} = \left\{ \begin{array}{ll}
C_{bal,coh} \cdot e^{-f_{tstore}^{4}} &amp;\textrm{for }C_{bal,coh}&gt;0\\
&amp;\\
C_{bal,coh} &amp;\textrm{for }C_{bal,coh}\leq0\\
\end{array} \right.</span></p>
</div><p>If the carbon remaining after the storage and minimum turnover fluxes
have been met, the next priority is the remaining flux to leaves
<span class="math">t_{md}\cdot(1-f_{md,min})</span>. If the quantity of carbon left
<span class="math">(C_{bal,coh}-\frac{\delta b_{store}}{\delta t})</span> is insufficient
to supply this amount of carbon, then the store of alive carbon is
depleted (to represent those leaves that have fallen off and not been
replaced)</p>
<div class="math">
<p><span class="math">\frac{\delta b_{alive}}{\delta t} = \left\{ \begin{array}{ll}
0 &amp;\textrm{ for } (C_{bal,coh}-\frac{\delta b_{store}}{\delta t}) &gt; t_{md}\cdot(1-f_{md,min})\\
&amp;\\
t_{md}\cdot(1-f_{md,min}) - \left(C_{bal,coh}-\frac{\delta b_{store}}{\delta t}\right)&amp;\textrm{ for } (C_{bal,coh}-\frac{\delta b_{store}}{\delta t}) \leq t_{md}\cdot(1-f_{md,min})\\
\end{array} \right.</span></p>
</div><p>correspondingly, the carbon left over for growth (<span class="math">C_{growth}</span>:
(KgC individual<span class="math">^{-1}</span> year<span class="math">^{-1}</span>) is therefore</p>
<div class="math">
<p><span class="math">C_{growth} = \left\{ \begin{array}{ll}
C_{bal,coh}-\frac{\delta b_{store}}{\delta t} &amp;\textrm{ for } (C_{bal,coh}-\frac{\delta b_{store}}{\delta t}) &gt; 0\\
&amp;\\
0&amp;\textrm{ for } (C_{bal,coh}-\frac{\delta b_{store}}{\delta t}) \leq 0\\
\end{array} \right.</span></p>
</div><p>to allocate the remaining carbon (if there is any), we first ascertain
whether the live biomass pool is at its target, or whether is has been
depleted by previous low carbon timesteps. Thus</p>
<div class="math">
<p><span class="math">\begin{array}{lll}
b_{alive,target}&amp;= b_{leaf,target}  (1+ f_{frla}+f_{swh}h_{coh}) &amp;\textrm{for } S_{phen,coh} = 2\\
b_{alive,target}&amp;= b_{leaf,target}  ( f_{frla}+f_{swh}h_{coh})&amp;\textrm{for } S_{phen,coh} = 1\\
\end{array}</span></p>
</div><p>where the target leaf biomass <span class="math">b_{leaf.target}</span> ((Kg C
individual<span class="math">^{-1}</span>)) is the allometric relationship between dbh
and leaf biomass, ameliorated by the leaf trimming fraction (see
‘control of leaf area’ below)</p>
<div class="math">
<p><span class="math">b_{leaf.target} = c_{leaf}\cdot dbh_{coh}^{e_{leaf,dbh}} \rho_{ft} ^{e_{leaf,dens}}\cdot C_{trim,coh}</span></p>
</div><p><span class="math">\rho_{ft}</span> is the wood density, in g cm<span class="math">^{3}</span>.</p>
</div>
<div class="section" id="allocation-to-seeds">
<h3><span class="section-number">2.29.10.3. </span>Allocation to Seeds<a class="headerlink" href="#allocation-to-seeds" title="Permalink to this headline">¶</a></h3>
<p>The fraction remaining for growth (expansion of live and structural
tissues) <span class="math">f_{growth}</span> is 1 minus that allocated to seeds.</p>
<div class="math">
<p><span class="math">f_{growth,coh} = 1 - f_{seed,coh}</span></p>
</div><p>Allocation to seeds only occurs if the alive biomass is not below its
target, and then is a predefined fixed fraction of the carbon remaining
for growth. Allocation to clonal reproduction (primarily for grasses)
occurs when <span class="math">\textrm{max}_{dbh}</span> is achieved.</p>
<div class="math">
<p><span class="math">f_{seed,coh} = \left\{ \begin{array}{ll}
R_{frac,ft}&amp;\textrm{ for } \textrm{max}_{dbh} &lt; dbh_{coh} \\
&amp;\\
\left( R_{frac,ft}+C_{frac,ft} \right) &amp;\textrm{ for } \textrm{max}_{dbh} \geq dbh_{coh} \\
\end{array} \right.</span></p>
</div><p>the total amount allocated to seed production (<span class="math">p_{seed,coh}</span> in
KgC individual <span class="math">^{-1}</span> y<span class="math">^{-1}</span>) is thus</p>
<div class="math">
<p><span class="math">p_{seed,coh} = C_{growth}\cdot f_{seed,coh}</span></p>
</div></div>
<div class="section" id="allocation-to-growing-pools">
<h3><span class="section-number">2.29.10.4. </span>Allocation to growing pools<a class="headerlink" href="#allocation-to-growing-pools" title="Permalink to this headline">¶</a></h3>
<p>The carbon is then partitioned into carbon available to grow the
<span class="math">b_{alive}</span> and <span class="math">b_{struc}</span> pools. A fraction <span class="math">v_{a}</span>
is available to live biomass pools, and a fraction <span class="math">v_{s}</span> is
available to structural pools.</p>
<div class="math">
<p><span class="math">\frac{\delta b_{alive}}{\delta t} = C_{growth}\cdot  f_{growth} v_{a}</span></p>
</div><div class="math">
<p><span class="math">\frac{\delta b_{struc}}{\delta t} = C_{growth}\cdot  f_{growth} v_{s}</span></p>
</div><p>If the alive biomass is lower than its ideal target, all of the
available carbon is directed into that pool. Thus:</p>
<div class="math">
<p><span class="math">v_{a}= \left\{ \begin{array}{ll}
\frac{1}{1+u}&amp;\textrm{ for } b_{alive} \geq b_{alive,target} \\
&amp;\\
1.0&amp;\textrm{ for } b_{alive} &lt;  b_{alive,target} \\
\end{array} \right.</span></p>
</div><div class="math">
<p><span class="math">v_{s}= \left\{ \begin{array}{ll}
\frac{u}{1+u}&amp;\textrm{ for } b_{alive} \geq b_{alive,target} \\
&amp;\\
0.0&amp;\textrm{ for } b_{alive} &lt;  b_{alive,target} \\
\end{array} \right.</span></p>
</div><p>In this case, the division of carbon between the live and structural
pools <span class="math">u</span> is derived as the inverse of the sum of the rates of
change in live biomass with respect to structural:</p>
<div class="math">
<p><span class="math">u = \frac{1}{\frac{\delta b_{leaf}}{ \delta b_{struc} } + \frac{\delta b_{root}}{ \delta b_{struc} } +\frac{\delta b_{sw}}{ \delta b_{struc} } }</span></p>
</div><p>To calculate all these differentials, we first start with
<span class="math">\delta b_{leaf}/\delta b_{struc}</span>, where</p>
<div class="math">
<p><span class="math">\frac{\delta b_{leaf}}{ \delta b_{struc}}= \frac{\frac{\delta \mathrm{dbh}}{\delta b_{struc}}}   {\frac{\delta \mathrm{dbh} }{\delta b_{leaf}} }</span></p>
</div><p>The rates of change of dbh with respect to leaf and structural biomass
are the differentials of the allometric equations linking these terms to
each other. Hence,</p>
<div class="math">
<p><span class="math">\frac{\delta \mathrm{dbh} }{\delta b_{leaf}}=\frac{1}{b_{trim,coh}}\cdot (e_{leaf,dbh}-1)\exp  {\big(c_{leaf} \mathrm{dbh}^{(e_{leaf,dbh})-1} \rho_{ft}^{e_{leaf,dens}} \big)}</span></p>
</div><p>and where <span class="math">\mathrm{dbh}_{coh} &gt;   \mathrm{dbh}_{max}</span></p>
<div class="math">
<p><span class="math">\frac{\delta b_{struc}}{\delta \mathrm{dbh}}  = e_{str,dbh} \cdot c_{str}\cdot e_{str,hite} h_{coh}^{e_{str,dbh}-1}   \mathrm{dbh}_{coh}^{e_{str,dbh}} \rho_{ft}^{e_{str,dens}}</span></p>
</div><p>If <span class="math">\mathrm{dbh}_{coh} \leq   \mathrm{dbh}_{max}</span> then we must
also account for allocation for growing taller as:</p>
<div class="math">
<p><span class="math">\frac{\delta b_{struc}}{\delta \mathrm{dbh}} =  \frac{\delta b_{struc}}{\delta \mathrm{dbh}} + \frac{\delta h}{\delta \mathrm{dbh}} \cdot  \frac{\delta b_{struc}}{\delta \mathrm{dbh} }</span></p>
</div><p>where</p>
<div class="math">
<p><span class="math">\frac{\delta h}{\delta \mathrm{dbh}}= 1.4976  \mathrm{dbh}_{coh}^{m_{allom}-1}</span></p>
</div><div class="math">
<p><span class="math">\frac{\delta  \mathrm{dbh} }{\delta b_{struc}} =\frac{1}{ \frac{\delta b_{struc}}{\delta \mathrm{dbh}} }</span></p>
</div><p>Once we have the <span class="math">\delta b_{leaf}/\delta b_{struc}</span>, we calculate
<span class="math">\delta b_{root}/\delta b_{struc}</span> as</p>
<div class="math">
<p><span class="math">\frac{\delta  b_{root}}{\delta b_{struc}} =\frac{\delta b_{leaf}}{\delta b_{struc}}\cdot f_{frla}</span></p>
</div><p>and the sapwood differential as</p>
<div class="math">
<p><span class="math">\frac{\delta  b_{sw}}{\delta b_{struc}} = f_{swh}\left( h_{coh} \frac{\delta b_{leaf}}{ \delta b_{struc}} + b_{leaf,coh}\frac{\delta h}{\delta b_{struc}} \right)</span></p>
</div><p>where</p>
<div class="math">
<p><span class="math">\frac{\delta h}{\delta b_{struc}} =  \frac{1}{c_{str}\times e_{str,hite} h_{coh}^{e_{str,dbh}-1}   \mathrm{dbh}_{coh}^{e_{str,dbh}} \rho_{ft}^{e_{str,dens}}}</span></p>
</div><p>In all of the above terms, height in in m, <span class="math">\mathrm{dbh}</span> is in
cm, and all biomass pools are in KgCm<span class="math">^{-2}</span>. The allometric
terms for the growth trajectory are all taken from the ED1.0 model, but
could in theory be altered to accomodate alternative allometric
relationships. Critically, the non-linear relationships between live and
structural biomass pools are maintained in this algorithm, which
diverges from the methodology currently deployed in the CLM4.5.</p>
</div>
<div class="section" id="integration-of-allocated-fluxes">
<h3><span class="section-number">2.29.10.5. </span>Integration of allocated fluxes<a class="headerlink" href="#integration-of-allocated-fluxes" title="Permalink to this headline">¶</a></h3>
<p>All of the flux calculations generate differential of the biomass state
variables against time (in years). To integrate these differential rates
into changes in the state variables, we use a simple simple forward
Euler integration. Other methods exist (e.g. ODEINT solvers, Runge Kutta
methods etc.), but they are more prone to errors that become difficult
to diagnose, and the typically slow rates of change of carbon pools mean
that these are less important than they might be in strongly non-linear
systems (soil drainage, energy balance, etc.)</p>
<div class="math">
<p><span class="math">b_{alive,t+1} = \textrm{min}\left( 0,b_{alive,t} +  \frac{\delta b_{alive}}{\delta t}  \delta t \right)</span></p>
</div><div class="math">
<p><span class="math">b_{struc,t+1} = \textrm{min}\left(0, b_{struc,t} +  \frac{\delta b_{struc}}{\delta t}  \delta t \right)</span></p>
</div><div class="math">
<p><span class="math">b_{store,t+1} = \textrm{min}\left(0, b_{store,t} +  \frac{\delta b_{store}}{\delta t}  \delta t \right)</span></p>
</div><p>In this case, <span class="math">\delta t</span> is set to be one day
(<span class="math">\frac{1}{365}</span> years).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter
Symbol</p></th>
<th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>indexed by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>S</p></td>
<td><p>Target stored
biomass as
fraction of
<span class="math">b_{leaf}</span></p></td>
<td><p>none</p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-odd"><td><p>f</p></td>
<td><p>Minimum
fraction of
turnover that
must be met</p></td>
<td><p>none</p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-even"><td><p>R</p></td>
<td><p>Fraction
allocated to
seeds</p></td>
<td><p>none</p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-odd"><td><p>C</p></td>
<td><p>Fraction
allocated to
clonal
reproduction</p></td>
<td><p>none</p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-even"><td><p><span class="math">\textrm{
max}_{dbh}</span></p></td>
<td><p>Diameter at
which maximum
height is
achieved</p></td>
<td><p>m</p></td>
<td><p><em>ft</em></p></td>
</tr>
<tr class="row-odd"><td><p>P</p></td>
<td><p>Does this
cohort have an
evergreen
phenological
habit?</p></td>
<td><p>1=yes, 0=no</p></td>
<td><p><em>ft</em></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="control-of-leaf-area-index">
<h2><span class="section-number">2.29.11. </span>Control of Leaf Area Index<a class="headerlink" href="#control-of-leaf-area-index" title="Permalink to this headline">¶</a></h2>
<p>The leaf area <span class="math">A_{leaf}</span> (m:math:<cite>^{-2}</cite>) of each cohort is
calculated from leaf biomass <span class="math">b_{leaf,coh}</span> (kgC
individual<span class="math">^{-1}</span>) and specific leaf area (SLA, m<span class="math">^2</span> kg
C<span class="math">^{-1}</span>)</p>
<div class="math">
<p><span class="math">A_{leaf,coh} = b_{leaf,coh} \cdot SLA_{ft}</span></p>
</div><p>For a given tree allometry, leaf biomass is determined from basal area
using the function used by <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#mc-2001"><span class="std std-ref">Moorcroft et al. 2001</span></a> where <span class="math">d_w</span>
is wood density in g cm<span class="math">^{-3}</span>.</p>
<div class="math">
<p><span class="math">b_{leaf,coh} = c_{leaf} \cdot dbh_{coh}^{e_{leaf,dbh}} \rho_{ft}^{e_{leaf,dens}}</span></p>
</div><p>However, using this model, where leaf area and crown area are both
functions of diameter, the leaf area index of each tree in a closed
canopy forest is always the same (where <span class="math">S_{c,patch}</span> =
<span class="math">S_{c,min}</span> , irrespective of the growth conditions. To allow
greater plasticity in tree canopy structure, and for tree leaf area
index to adapt to prevailing conditions, we implemented a methodology
for removing those leaves in the canopy that exist in negative carbon
balance. That is, their total annual assimilation rate is insufficient
to pay for the turnover and maintenance costs associated with their
supportive root and stem tissue, plus the costs of growing the leaf. The
tissue turnover maintenance cost (KgC m<span class="math">^{-2} y^{-1}</span> of leaf is
the total maintenance demand divided by the leaf area:</p>
<div class="math">
<p><span class="math">L_{cost,coh} = \frac{t_{md,coh}} {b_{leaf,coh} \cdot \textrm{SLA}}</span></p>
</div><p>The net uptake for each leaf layer <span class="math">U_{net,z}</span> in (KgC
m<span class="math">^{-2}</span> year<span class="math">^{-1}</span>) is</p>
<div class="math">
<p><span class="math">U_{net,coh,z} = g_{coh,z}-r_{m,leaf,coh,z}</span></p>
</div><p>where <span class="math">g_{z}</span> is the GPP of each layer of leaves in each tree (KgC
m<span class="math">^{-2}</span> year<span class="math">^{-1}</span>), <span class="math">r_{m,leaf,z}</span> is the rate
of leaf dark respiration (also KgC m<span class="math">^{-2}</span>
year<span class="math">^{-1}</span>). We use an iterative scheme to define the cohort
specific canopy trimming fraction <span class="math">C_{trim,coh}</span>, on an annual
time-step, where</p>
<div class="math">
<p><span class="math">b_{leaf,coh} =   C_{trim} \times 0.0419  dbh_{coh}^{1.56} d_w^{0.55}</span></p>
</div><p>If the annual maintenance cost of the bottom layer of leaves (KgC m-2
year-1) is less than then the canopy is trimmed by an increment <span class="math">\iota_l</span>(0.01), which is applied until the end of  next calander year. Because this is an optimality model, there is an
issue of the timescale over which net assimilation is evaluated, the
timescale of response, and the plasticity of plants to respond to these
pressures. These properties should be investigated further in future
efforts.</p>
<div class="math">
<p><span class="math">C_{trim,y+1}  = \left\{ \begin{array}{ll}
\rm{max}(C_{trim,y}-\iota_l,1.0)&amp;\rm{for} (L_{cost,coh} &gt; U_{net,coh,nz})\\
&amp;\\
\rm{min}(C_{trim,y}+\iota_l,L_{trim,min})&amp;\rm{for} (L_{cost,coh} &lt; U_{net,coh,nz})\\
\end{array} \right.</span></p>
</div><p>We impose an arbitrary minimum value on the scope of canopy trimming of
<span class="math">L_{trim,min}</span> (0.5). If plants are able simply to drop all of
their canopy in times of stress, with no consequences, then tree
mortality from carbon starvation is much less likely to occur because of
the greatly reduced maintenance and turnover requirements.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter
Symbol</p></th>
<th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>indexed by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math">\iota_l</span></p></td>
<td><p>Fraction by
which leaf mass
is reduced next
year</p></td>
<td><p>none</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><span class="math">L_{trim,
min}</span></p></td>
<td><p>Minimum
fraction to
which leaf mass
can be reduced</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="phenology">
<h2><span class="section-number">2.29.12. </span>Phenology<a class="headerlink" href="#phenology" title="Permalink to this headline">¶</a></h2>
<div class="section" id="cold-deciduous-phenology">
<h3><span class="section-number">2.29.12.1. </span>Cold Deciduous Phenology<a class="headerlink" href="#cold-deciduous-phenology" title="Permalink to this headline">¶</a></h3>
<div class="section" id="cold-leaf-out-timing">
<h4><span class="section-number">2.29.12.1.1. </span>Cold Leaf-out timing<a class="headerlink" href="#cold-leaf-out-timing" title="Permalink to this headline">¶</a></h4>
<p>The phenology model of <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#botta2000"><span class="std std-ref">Botta et al. 2000</span></a> is used in
FATES to determine the leaf-on timing. The Botta et al. model was
verified against satellite data and is one of the only globally verified
and published models of leaf-out phenology. This model differs from the
phenology model in the CLM4.5. The model simulates leaf-on date as a
function of the number of growing degree days (GDD), defined by the sum
of mean daily temperatures (<span class="math">T_{day}</span> <span class="math">^{o}</span>C) above a
given threshold <span class="math">T_{g}</span> (0 <span class="math">^{o}</span>C).</p>
<div class="math">
<p><span class="math">GDD=\sum \textrm{max}(T_{day}-T_{g},0)</span></p>
</div><p>Budburst occurs when <span class="math">GDD</span> exceeds a threshold
(<span class="math">GDD_{crit}</span>). The threshold is modulated by the number of
chilling days experienced (NCD) where the mean daily temperature falls
below a threshold determined by <cite>Botta et al. 2000&lt;botta2000&gt;</cite> as
5<span class="math">^{o}</span>C. A greater number of chilling days means that fewer
growing degree days are required before budburst:</p>
<div class="math">
<p><span class="math">GDD_{crit}=a+be^{c.NCD}</span></p>
</div><p>where a = -68, b= 638 and c=-0.01 <cite>Botta et al. 2000&lt;botta2000&gt;</cite>. In the
Northern Hemisphere, counting of degree days begins on 1st January, and
of chilling days on 1st November. The calendar opposite of these dates
is used for points in the Southern Hemisphere.</p>
<p>If the growing degree days exceed the critical threshold, leaf-on is
triggered by a change in the gridcell phenology status flag
<span class="math">S_{phen,grid}</span> where ‘2’ indicates that leaves should come on and
‘1’ indicates that they should fall.</p>
<div class="math">
<p><span class="math">\begin{array}{ll}
S_{phen,grid} = 2
&amp;\textrm{ if } S_{phen,grid} = 1\textrm{ and } GDD_{grid} \ge GDD_{crit} \\
\end{array}</span></p>
</div></div>
<div class="section" id="cold-leaf-off-timing">
<h4><span class="section-number">2.29.12.1.2. </span>Cold Leaf-off timing<a class="headerlink" href="#cold-leaf-off-timing" title="Permalink to this headline">¶</a></h4>
<p>The leaf-off model is taken from the Sheffield Dynamic Vegetation Model
(SDGVM) and is similar to that for LPJ
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#sitch2003"><span class="std std-ref">Sitch et al. 2003</span></a> and IBIS
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#foley1996"><span class="std std-ref">Foley et al. 1996</span></a> models. The average daily
temperatures of the previous 10 day period are stored. Senescence is
triggered when the number of days with an average temperature below
7.5<span class="math">^{o}</span> (<span class="math">n_{colddays}</span>) rises above a threshold values
<span class="math">n_{crit,cold}</span>, set at 5 days.</p>
<div class="math">
<p><span class="math">\begin{array}{ll}
S_{phen,grid} = 1
&amp;\textrm{ if } S_{phen,grid} = 2\textrm{ and } n_{colddays} \ge n_{crit,cold} \\
\end{array}</span></p>
</div></div>
<div class="section" id="global-implementation-modifications">
<h4><span class="section-number">2.29.12.1.3. </span>Global implementation modifications<a class="headerlink" href="#global-implementation-modifications" title="Permalink to this headline">¶</a></h4>
<p>Because of the global implementation of the cold-deciduous phenology
scheme, adjustments must be made to account for the possibility of
cold-deciduous plants experiencing situations where no chilling period
triggering leaf-off ever happens. If left unaccounted for, these leaves
will last indefinitely, resulting in highly unrealistic behaviour.
Therefore, we implement two additional rules. Firstly, if the number of
days since the last senescence event was triggered is larger than 364,
then leaf-off is triggered on that day. Secondly, if no chilling days
have occured during the winter accumulation period, then leaf-on is not
triggered. This means that in effect, where there are no cold periods,
leaves will fall off and not come back on, meaning that cold-deciduous
plants can only grow in places where there is a cold season.</p>
<p>Further to this rule, we introduce a ‘buffer’ time periods after leaf-on
of 30 days, so that cold-snap periods in the spring cannot trigger a
leaf senescence. The 30 day limit is an arbitrary limit. In addition, we
constrain growing degree day accumulation to the second half of the year
(Jult onwards in the Northern hemisphere, or Jan-June in the Southern)
and only allow GDD accumulation while the leaves are off.</p>
</div>
</div>
<div class="section" id="drought-deciduous-phenology-tbd">
<h3><span class="section-number">2.29.12.2. </span>Drought-deciduous Phenology: TBD<a class="headerlink" href="#drought-deciduous-phenology-tbd" title="Permalink to this headline">¶</a></h3>
<p>In the current version of the model, a drought deciduous algorithm
exists, but is not yet operational, due to issue detected in the existing
CN and soil moisture modules, which also affect the behaviour of the
native ED drought deciduous model. This is a priority to address before
the science tag is released.</p>
</div>
<div class="section" id="carbon-dynamics-of-deciduous-plants">
<h3><span class="section-number">2.29.12.3. </span>Carbon Dynamics of deciduous plants<a class="headerlink" href="#carbon-dynamics-of-deciduous-plants" title="Permalink to this headline">¶</a></h3>
<p>In the present version, leaf expansion and senescence happen over the
course of a single day. This is clearly not an empirically robust
representation of leaf behaviour, whereby leaf expansion occurs over a
period of 10-14 days, and senescence over a similar period. This will be
incorporated in later versions. When the cold or drought phenological
status of the gridcell status changes (<span class="math">S_{phen,grid}</span>) from ‘2’
to ‘1’, and the leaves are still on (<span class="math">S_{phen,coh}</span> =2 ), the leaf
biomass at this timestep is ’remembered’ by the model state variable
<span class="math">l_{memory,coh}</span>. This provides a ‘target’ biomass for leaf onset
at the beginning of the next growing season (it is a target, since
depletion of stored carbon in the off season may render achieving the
target impossible).</p>
<div class="math">
<p><span class="math">l_{memory,coh} = b_{leaf,coh}</span></p>
</div><p>Leaf carbon is then added to the leaf litter flux <span class="math">l_{leaf,coh}</span>
(KgC individual<span class="math">^{-1}</span>)</p>
<div class="math">
<p><span class="math">l_{leaf,coh} = b_{leaf,coh}</span></p>
</div><p>The alive biomass is depleted by the quantity of leaf mass lost, and the
leaf biomass is set to zero</p>
<div class="math">
<p><span class="math">b_{alive,coh} = b_{alive,coh} - b_{leaf,coh}</span></p>
</div><div class="math">
<p><span class="math">b_{leaf,coh} = 0</span></p>
</div><p>Finally, the status <span class="math">S_{phen,coh}</span> is set to 1, indicating that
the leaves have fallen off.</p>
<p>For bud burst, or leaf-on, the same occurs in reverse. If the leaves are
off (<span class="math">S_{phen,coh}</span>=1) and the phenological status triggers
budburst (<span class="math">S_{phen,grid}</span>=2) then the leaf mass is set the
maximum of the leaf memory and the available store</p>
<div class="math">
<p><span class="math">b_{leaf,coh} =  \textrm{max}\left(l_{memory,coh}, b_{store,coh}\right.)</span></p>
</div><p>this amount of carbon is removed from the store</p>
<div class="math">
<p><span class="math">b_{store,coh} = b_{store,coh}  - b_{leaf,coh}</span></p>
</div><p>and the new leaf biomass is added to the alive pool</p>
<div class="math">
<p><span class="math">b_{alive,coh} = b_{alive,coh}  + b_{leaf,coh}</span></p>
</div><p>Lastly, the leaf memory variable is set to zero and the phenological
status of the cohort back to ‘2’. No parameters are currently required
for this carbon accounting scheme.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter
Symbol</p></th>
<th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>indexed by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math">n_{crit,
cold}</span></p></td>
<td><p>Threshold of
cold days for
senescence</p></td>
<td><p>none</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><span class="math">T_{g}</span></p></td>
<td><p>Threshold for
counting
growing degree
days</p></td>
<td><p><span class="math">^{o}</span>C</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="seed-dynamics-and-recruitment">
<h2><span class="section-number">2.29.13. </span>Seed Dynamics and Recruitment<a class="headerlink" href="#seed-dynamics-and-recruitment" title="Permalink to this headline">¶</a></h2>
<p>The production of seeds and their subsequent germination is a process
that must be captured explicitly or implicitly in vegetation models. FATES contains a seed bank model designed to allow the dynamics of
seed production and germination to be simulated independently. In the
ED1.0 model, seed recruitment occurs in the same timestep as allocation
to seeds, which prohibits the survival of a viable seed bank through a
period of disturbance or low productivity (winter, drought). In FATES, a plant functional type specific seed bank is tracked in
each patch (<span class="math">Seeds_{patch}</span> KgC m<span class="math">^{-2}</span>), whose rate of
change (KgC m<span class="math">^{-2}</span> y<span class="math">^{-1}</span>) is the balance of inputs,
germination and decay:</p>
<div class="math">
<p><span class="math">\frac{\delta Seeds_{FT}}{\delta t } = Seed_{in,ft} - Seed_{germ,ft} - Seed_{decay,ft}</span></p>
</div><p>where <span class="math">Seed_{in}</span>, <span class="math">Seed_{germ}</span> and <span class="math">Seed_{decay}</span>
are the production, germination and decay (or onset of inviability) of
seeds, all in KgC m<span class="math">^{-2}</span> year<span class="math">^{-1}</span>.</p>
<p>Seeds are assumed to be distributed evenly across the site (in this
version of the model), so the total input to the seed pool is therefore
the sum of all of the reproductive output of all the cohorts in each
patch of the correct PFT type.</p>
<div class="math">
<p><span class="math">Seed_{in,ft} =  \frac{\sum_{p=1}^{n_{patch}}\sum_{i=1}^{n_{coh}}p_{seed,i}.n_{coh}}{area_{site}}</span></p>
</div><p>Seed decay is the sum of all the processes that reduce the number of
seeds, taken from <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#lischke2006"><span class="std std-ref">Lischke et al. 2006</span></a>. Firstly, the rate at
which seeds become inviable is described as a constant rate <span class="math">\phi</span>
(y:math:<cite>^{-1}</cite>) which is set to 0.51, the mean of the parameters used
by <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#lischke2006"><span class="std std-ref">Lischke et al. 2006</span></a>.</p>
<div class="math">
<p><span class="math">Seed_{decay,ft} = Seeds_{FT}.\phi</span></p>
</div><p>The seed germination flux is also prescribed as a fraction of the
existing pool (<span class="math">\alpha_{sgerm}</span>), but with a cap on maximum
germination rate <span class="math">\beta_{sgerm}</span>, to prevent excessive dominance
of one plant functional type over the seed pool.</p>
<div class="math">
<p><span class="math">Seed_{germ,ft} = \textrm{max}(Seeds_{FT}\cdot \alpha_{sgerm},\beta_{sgerm})</span></p>
</div><table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter
Symbol</p></th>
<th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>indexed by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math">K_s</span></p></td>
<td><p>Maximum seed
mass</p></td>
<td><p>kgC m<span class="math">^{-2}</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">\alpha_{
sgerm}</span></p></td>
<td><p>Proportional
germination
rate</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math">\beta_{s
germ}</span></p></td>
<td><p>Maximum
germination
rate</p></td>
<td><p>KgC
m<span class="math">^{-2}</span></p>
<p>y<span class="math">^{-1}</span></p>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">\phi</span></p></td>
<td><p>Decay rate of
viable seeds</p></td>
<td><p>none</p></td>
<td><p>FT</p></td>
</tr>
<tr class="row-even"><td><p><span class="math">R_{frac,
ft}</span></p></td>
<td><p>Fraction of
<span class="math">C_{bal}</span>
devoted to
reproduction</p></td>
<td><p>none</p></td>
<td><p>FT</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="litter-production-and-fragmentation">
<h2><span class="section-number">2.29.14. </span>Litter Production and Fragmentation<a class="headerlink" href="#litter-production-and-fragmentation" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">The original CLM4.5 model contains streams of carbon pertaining to
different chemical properties of litter (lignin, cellulose and labile
streams, specifically). In FATES model, the fire simulation
scheme in the SPITFIRE model requires that the model tracks the pools
of litter pools that differ with respect to their propensity to burn
(surface area-volume ratio, bulk density etc.). Therefore, this model
contains more complexity in the representation of coarse woody debris.
We also introduce the concept of ’fragmenting’ pools, which are pools
that can be burned, but are not available for decomposition or
respiration. In this way, we can both maintain above-ground pools that
affect the rate of burning, and the lag between tree mortality and
availability of woody material for decomposition.</div>
<div class="line">FATES recognizes four classes of litter. Above- and below-ground
coarse woody debris (<span class="math">CWD_{AG}</span>, <span class="math">CWD_{BG}</span>) and leaf
litter (<span class="math">l_{leaf}</span> and fine root litter <span class="math">l_{root}</span>). All
pools are represented per patch, and with units of kGC
m<span class="math">{^-2}</span>. Further to this, <span class="math">CWD_{AG}</span>, <span class="math">CWD_{BG}</span>
are split into four litter size classes (<span class="math">lsc</span>) for the purposes
of proscribing this to the SPITFIRE fire model (seed ’Fuel Load’
section for more detail. 1-hour (twigs), 10-hour (small branches),
100-hour (large branches) and 1000-hour(boles or trunks). 4.5 %, 7.5%,
21 % and 67% of the woody biomass (<span class="math">b_{store,coh} + b_{sw,coh}</span>)
is partitioned into each class, respectively.</div>
</div>
<p><span class="math">l_{leaf}</span> and <span class="math">l_{root}</span> are indexed by plant functional
type (<span class="math">ft</span>). The rational for indexing leaf and fine root by PFT
is that leaf and fine root matter typically vary in their
carbon:nitrogen ratio, whereas woody pools typically do not.</p>
<p>Rates of change of litter, all in kGC m<span class="math">{^-2}</span>
year<span class="math">^{-1}</span>, are calculated as</p>
<div class="math">
<p><span class="math">\frac{\delta CWD_{AG,out,lsc}}{ \delta t }= CWD_{AG,in,lsc} - CWD_{AG,out,lsc}</span></p>
</div><div class="math">
<p><span class="math">\frac{\delta CWD_{BG,out,lsc}}{ \delta t } = CWD_{BG,in,lsc} - CWD_{BG,in,lsc}</span></p>
</div><div class="math">
<p><span class="math">\frac{\delta l_{leaf,out,ft} }{ \delta t } = l_{leaf,in,ft} -  l_{leaf,out,ft}</span></p>
</div><div class="math">
<p><span class="math">\frac{\delta l_{root,out,ft} }{ \delta t } = l_{root,in,ft} - l_{root,out,ft}</span></p>
</div><div class="section" id="litter-inputs">
<h3><span class="section-number">2.29.14.1. </span>Litter Inputs<a class="headerlink" href="#litter-inputs" title="Permalink to this headline">¶</a></h3>
<p>Inputs into the litter pools come from tissue turnover, mortality of
canopy trees, mortality of understorey trees, mortality of seeds, and
leaf senescence of deciduous plants.</p>
<div class="math">
<p><span class="math">l_{leaf,in,ft} =\Big(\sum_{i=1}^{n_{coh,ft}} n_{coh}(l_{md,coh}  + l_{leaf,coh}) + M_{t,coh}.b_{leaf,coh}\Big)/\sum_{p=1}^{n_{pat}}A_{patch}</span></p>
</div><p>where <span class="math">l_{md,coh}</span> is the leaf turnover rate for evergreen trees
and <span class="math">l_{leaf,coh}</span> is the leaf loss from phenology in that
timestep (KgC <span class="math">m^{-2}</span>. <span class="math">M_{t,coh}</span> is the total mortality
flux in that timestep (in individuals). For fine root input.
<span class="math">n_{coh,ft}</span> is the number of cohorts of functional type
‘<span class="math">FT</span>’ in the current patch.</p>
<div class="math">
<p><span class="math">l_{root,in,ft} =\Big(\sum_{i=1}^{n_{coh,ft}} n_{coh}(r_{md,coh} ) + M_{t,coh}.b_{root,coh}\Big)/\sum_{p=1}^{n_{pat}}A_p</span></p>
</div><p>where <span class="math">r_{md,coh}</span> is the root turnover rate. For coarse woody
debris input (<span class="math">\mathit{CWD}_{AG,in,lsc}</span> , we first calculate the
sum of the mortality <span class="math">M_{t,coh}.(b_{struc,coh}+b_{sw,coh})</span> and
turnover <span class="math">n_{coh}(w_{md,coh}</span>) fluxes, then separate these into
size classes and above/below ground fractions using the fixed fractions
assigned to each (<span class="math">f_{lsc}</span> and <span class="math">f_{ag}</span>)</p>
<div class="math">
<p><span class="math">\mathit{CWD}_{AG,in,lsc} =\Big(f_{lsc}.f_{ag}\sum_{i=1}^{n_{coh,ft}}n_{coh}w_{md,coh}  + M_{t,coh}.(b_{struc,coh}+b_{sw,coh})\Big)/\sum_{p=1}^{n_{pat}}A_p</span></p>
</div><div class="math">
<p><span class="math">\mathit{CWD}_{BG,in,lsc} =\Big(f_{lsc}.(1-f_{ag})\sum_{i=1}^{n_{coh,ft}}n_{coh}w_{md,coh}  + M_{t,coh}.(b_{struc,coh}+b_{sw,coh})\Big)/\sum_{p=1}^{n_{pat}}A_p</span></p>
</div></div>
<div class="section" id="litter-outputs">
<h3><span class="section-number">2.29.14.2. </span>Litter Outputs<a class="headerlink" href="#litter-outputs" title="Permalink to this headline">¶</a></h3>
<p>The fragmenting litter pool is available for burning but not for
respiration or decomposition. Fragmentation rates are calculated
according to a maximum fragmentation rate (<span class="math">\alpha_{cwd,lsc}</span> or
<span class="math">\alpha_{litter}</span>) which is ameliorated by a temperature and water
dependent scalar <span class="math">S_{tw}</span>. The form of the temperature scalar is
taken from the existing CLM4.5BGC decomposition cascade calculations).
The water scaler is equal to the water limitation on photosynthesis
(since the CLM4.5BGC water scaler pertains to the water potential of
individual soil layers, which it is difficult to meaningfully average,
given the non-linearities in the impact of soil moisture). The scaler
code is modular, and new functions may be implemented trivially. Rate
constants for the decay of the litter pools are extremely uncertain in
literature, as few studies either separate litter into size classes, nor
examine its decomposition under non-limiting moisture and temperature
conditions. Thus, these parameters should be considered as part of
sensitivity analyses of the model outputs.</p>
<div class="math">
<p><span class="math">\mathit{CWD}_{AG,out,lsc} = CWD_{AG,lsc}. \alpha_{cwd,lsc}.S_{tw}</span></p>
</div><div class="math">
<p><span class="math">\mathit{CWD}_{BG,out,lsc} = CWD_{BG,lsc} .\alpha_{cwd,lsc}.S_{tw}</span></p>
</div><div class="math">
<p><span class="math">l_{leaf,out,ft} = l_{leaf,ft}.\alpha_{litter}.S_{tw}</span></p>
</div><div class="math">
<p><span class="math">l_{root,out,ft} = l_{root,ft}.\alpha_{root,ft}.S_{tw}</span></p>
</div></div>
<div class="section" id="flux-into-decompsition-cascade">
<h3><span class="section-number">2.29.14.3. </span>Flux into decompsition cascade<a class="headerlink" href="#flux-into-decompsition-cascade" title="Permalink to this headline">¶</a></h3>
<p>Upon fragmentation and release from the litter pool, carbon is
transferred into the labile, lignin and cellulose decomposition pools.
These pools are vertically resolved in the biogeochemistry model. The
movement of carbon into each vertical layer is obviously different for
above- and below-ground fragmenting pools. For each layer <span class="math">z</span> and
chemical litter type <span class="math">i</span>, we derive a flux from ED into the
decomposition cascade as <span class="math">ED_{lit,i,z}</span> (kGC m<span class="math">^{-2}</span>
s<span class="math">^{-1}</span>)</p>
<p>where <span class="math">t_c</span> is the time conversion factor from years to seconds,
<span class="math">f_{lab,l}</span>, <span class="math">f_{cel,l}</span> and <span class="math">f_{lig,l}</span> are the
fractions of labile, cellulose and lignin in leaf litter, and
<span class="math">f_{lab,r}</span>, <span class="math">f_{cel,r}</span> and <span class="math">f_{lig,r}</span> are their
counterparts for root matter. Similarly, <span class="math">l_{prof}</span>,
<span class="math">r_{f,prof}</span>and <span class="math">r_{c,prof}</span> are the fractions of leaf,
coarse root and fine root matter that are passed into each vertical soil
layer <span class="math">z</span>, derived from the CLM(BGC) model.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter
Symbol</p></th>
<th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>indexed by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math">\alpha_{
cwd,lsc}</span></p></td>
<td><p>Maximum
fragmentation
rate of CWD</p></td>
<td><p>y<span class="math">^{-1}</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">\alpha_{
litter}</span></p></td>
<td><p>Maximum
fragmentation
rate of leaf
litter</p></td>
<td><p>y<span class="math">^{-1}</span></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math">\alpha_{
root}</span></p></td>
<td><p>Maximum
fragmentation
rate of fine
root litter</p></td>
<td><p>y<span class="math">^{-1}</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">f_{lab,l
}</span></p></td>
<td><p>Fraction of
leaf mass in
labile carbon
pool</p></td>
<td><p>none</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math">f_{cel,l
}</span></p></td>
<td><p>Fraction of
leaf mass in
cellulose
carbon pool</p></td>
<td><p>none</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">f_{lig,l
}</span></p></td>
<td><p>Fraction of
leaf mass in
lignin carbon
pool</p></td>
<td><p>none</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math">f_{lab,r
}</span></p></td>
<td><p>Fraction of
root mass in
labile carbon
pool</p></td>
<td><p>none</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">f_{cel,r
}</span></p></td>
<td><p>Fraction of
root mass in
cellulose
carbon pool</p></td>
<td><p>none</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math">f_{lig,r
}</span></p></td>
<td><p>Fraction of
root mass in
lignin carbon
pool</p></td>
<td><p>none</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">l_{prof,
z}</span></p></td>
<td><p>Fraction of
leaf matter
directed to
soil layer z</p></td>
<td><p>none</p></td>
<td><p>soil layer</p></td>
</tr>
<tr class="row-even"><td><p><span class="math">r_{c,pro
f,z}</span></p></td>
<td><p>Fraction of
coarse root
matter directed
to soil layer z</p></td>
<td><p>none</p></td>
<td><p>soil layer</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">r_{f,pro
f,z}</span></p></td>
<td><p>Fraction of
fine root
matter directed
to soil layer z</p></td>
<td><p>none</p></td>
<td><p>soil layer</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="plant-mortality">
<h2><span class="section-number">2.29.15. </span>Plant Mortality<a class="headerlink" href="#plant-mortality" title="Permalink to this headline">¶</a></h2>
<p>Total plant mortality per cohort <span class="math">M_{t,coh}</span>, (fraction
year<span class="math">^{-1}</span>) is simulated as the sum of four additive terms,</p>
<div class="math">
<p><span class="math">M_{t,coh}= M_{b,coh} + M_{cs,coh} + M_{hf,coh} + M_{f,coh},</span></p>
</div><p>where <span class="math">M_b</span> is the background mortality that is unaccounted by
any of the other mortality rates and is fixed at 0.014. <span class="math">M_{cs}</span>
is the carbon starvation derived mortality, which is a function of the
non-structural carbon storage term <span class="math">b_{store,coh}</span> and the
PFT-specific ‘target’ carbon storage, <span class="math">l_{targ,ft}</span>, as follows:</p>
<div class="math">
<p><span class="math">M_{cs,coh}= \rm{max} \left(0.0, S_{m,ft} \left(0.5 -  \frac{b_{store,coh}}{l_{targ,ft}b_{leaf}}\right)\right)</span></p>
</div><p>where <span class="math">S_{m,ft}</span> is the <cite>stress mortality</cite> parameter, or the
fraction of trees in a landscape that die when the mean condition of a
given cohort triggers mortality. This parameter is needed to scale from
individual-level mortality simulation to grid-cell average conditions.</p>
<p>Mechanistic simulation of hydraulic failure is not undertaken on account
of it’s mechanistic complexity (see <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#mcdowelletal2013"><span class="std std-ref">McDowell et al. 2013</span></a> for
details). Instead, we use a proxy for hydraulic failure induced
mortality (<span class="math">M_{hf,coh}</span>) that uses a water potential threshold
beyond mortality is triggered, such that the tolerance of low water
potentials is a function of plant functional type (as expressed via the
<span class="math">\psi_c</span> parameter). For each day that the aggregate water
potential falls below a threshold value, a set fraction of the trees are
killed. The aggregation of soil moisture potential across the root zone
is expressed using the <span class="math">\beta</span> function. We thus determine plant
mortality caused by extremely low water potentials as</p>
<div class="math">
<p><span class="math">M_{hf,coh} = \left\{ \begin{array}{ll}
S_{m,ft}&amp; \textrm{for } \beta_{ft} &lt; 10^{-6}\\
&amp;\\
0.0&amp; \textrm{for } \beta_{ft}&gt;= 10^{-6}.\\
\end{array} \right.</span></p>
</div><p>The threshold value of 10<span class="math">^{-6}</span> represents a state where the
average soil moisture potential is within 10<span class="math">^{-6}</span> of the
wilting point (a PFT specific parameter <span class="math">\theta_{w,ft}</span>).</p>
<p><span class="math">M_{hf,coh}</span> is the fire-induced mortality, as described in the
fire modelling section.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 44%" />
<col style="width: 10%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter Symbol</p></th>
<th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>indexed by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math">S_{m,ft}</span></p></td>
<td><p>Stress Mortality Scaler</p></td>
<td><p>none</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">l_{targ,ft}</span></p></td>
<td><p>Target carbon storage fraction</p></td>
<td><p>none</p></td>
<td><p>ft</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="fire-spitfire">
<h2><span class="section-number">2.29.16. </span>Fire (SPITFIRE)<a class="headerlink" href="#fire-spitfire" title="Permalink to this headline">¶</a></h2>
<p>The influence of fire on vegetation is estimated using the SPITFIRE
model, which has been modified for use in ED following it’s original
implementation in the LPJ-SPITFIRE model
(<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#pfeiffer2013"><span class="std std-ref">Pfeiffer et al. 2013</span></a>). This model as
described is substantially different from the existing CLM4.5 fire model
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#lietal2012a"><span class="std std-ref">Li et al. 2012</span></a>, however, further developments are
intended to increase the merging of SPITFIRE’s natural vegetation fire
scheme with the fire suppression, forest-clearing and peat fire
estimations in the existing model. The coupling to the ED model allows
fires to interact with vegetation in a size-structured manner, so
small fires can burn only understorey vegetation. Also, the patch
structure and representation of succession in the ED model allows the
model to track the impacts of fire on different forest stands, therefore
removing the problem of area-averaging implicit in area-based DGVMs. The
SPITFIRE approach has also been coupled to the LPJ-GUESS
individual-based model (Forrest et al. in prep) and so this is not the
only implementation of this type of scheme in existence.</p>
<p>The SPITFIRE model operates at a daily timestep and at the patch level,
meaning that different litter pools and vegetation charecteristics of
open and closed forests can be represented effectively (we omit the
<cite>patch</cite> subscript throughout for simplicity).</p>
<div class="section" id="properties-of-fuel-load">
<h3><span class="section-number">2.29.16.1. </span>Properties of fuel load<a class="headerlink" href="#properties-of-fuel-load" title="Permalink to this headline">¶</a></h3>
<p>Many fire processes are impacted by the properties of the litter pool in
the SPITFIRE model. There are one live (live grasses) and five dead fuel
categories (dead leaf litter and four pools of coarse woody debris).
Coarse woody debris is classified into 1h, 10h, 100h, and 1000h fuels,
defined by the order of magnitude of time required for fuel to lose
(or gain) 63% of the difference between its current moisture content and
the equilibrium moisture content under defined atmospheric conditions.
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>. For the purposes of describing
the behaviour of fire, we introduce a new index ‘fuel class’ <em>fc</em>, the
values of which correspond to each of the six possible fuel categories
as follows.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 42%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><em>fc</em> index</p></th>
<th class="head"><p>Fuel type</p></th>
<th class="head"><p>Drying Time</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>dead grass</p></td>
<td><p>n/a</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>twigs</p></td>
<td><p>1h fuels</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>small branches</p></td>
<td><p>10h fuel</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>large branches</p></td>
<td><p>100h fuel</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>stems and trunks</p></td>
<td><p>1000h fuel</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>live grasses</p></td>
<td><p>n/a</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="nesterov-index">
<h3><span class="section-number">2.29.16.2. </span>Nesterov Index<a class="headerlink" href="#nesterov-index" title="Permalink to this headline">¶</a></h3>
<p>Dead fuel moisture (<span class="math">\emph{moist}_{df,fc}</span>), and several other
properties of fire behaviour, are a function of the ‘Nesterov Index’
(<span class="math">N_{I}</span>) which is an accumulation over time of a function of
temperature and humidity (Eqn 5, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>),</p>
<div class="math">
<p><span class="math">N_{I}=\sum{\textrm{max}(T_{d}(T_{d}-D),0)}</span></p>
</div><p>where <span class="math">T_{d}</span> is the daily mean temperature in <span class="math">^{o}</span>C and
<span class="math">D</span> is the dew point calculated as .</p>
<div class="math">
<p><span class="math">\begin{aligned}
\upsilon&amp;=&amp;\frac{17.27T_{d}}{237.70+T_{d}}+\log(RH/100)\\
D&amp;=&amp;\frac{237.70\upsilon}{17.27-\upsilon}\end{aligned}</span></p>
</div><p>where <span class="math">RH</span> is the relative humidity (%).</p>
<p>On days when the total precipitation exceeds 3.0mm, the Nesterov index accumulator is reset back to zero.</p>
</div>
<div class="section" id="fuel-properties">
<h3><span class="section-number">2.29.16.3. </span>Fuel properties<a class="headerlink" href="#fuel-properties" title="Permalink to this headline">¶</a></h3>
<p>Total fuel load <span class="math">F_{tot,patch}</span> for a given patch is the sum of
the above ground coarse woody debris and the leaf litter, plus the alive
grass leaf biomass <span class="math">b_{l,grass}</span> multiplied by the non-mineral
fraction (1-<span class="math">M_{f}</span>).</p>
<div class="math">
<p><span class="math">F_{tot,patch}=\left(\sum_{fc=1}^{fc=5}  CWD_{AG,fc}+l_{litter}+b_{l,grass}\right)(1-M_{f})</span></p>
</div><p>Many of the model behaviours are affected by the patch-level weighted
average properties of the fuel load. Typically, these are calculated in
the absence of 1000-h fuels because these do not contribute greatly to
fire spread properties.</p>
<div class="section" id="dead-fuel-moisture-content">
<h4><span class="section-number">2.29.16.3.1. </span>Dead Fuel Moisture Content<a class="headerlink" href="#dead-fuel-moisture-content" title="Permalink to this headline">¶</a></h4>
<p>Dead fuel moisture is calculated as</p>
<div class="math">
<p><span class="math">\emph{moist}_{df,fc}=e^{-\alpha_{fmc,fc}N_{I}}</span></p>
</div><p>where <span class="math">\alpha_{fmc,fc}</span> is a parameter defining how fuel moisture
content varies between the first four dead fuel classes.</p>
</div>
<div class="section" id="live-grass-moisture-content">
<h4><span class="section-number">2.29.16.3.2. </span>Live grass moisture Content<a class="headerlink" href="#live-grass-moisture-content" title="Permalink to this headline">¶</a></h4>
<p>The live grass fractional moisture content(<span class="math">\emph{moist}_{lg}</span>)
is a function of the soil moisture content. (Equation B2 in
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>)</p>
<div class="math">
<p><span class="math">\emph{moist}_{lg}=\textrm{max}(0.0,\frac{10}{9}\theta_{30}-\frac{1}{9})</span></p>
</div><p>where <span class="math">\theta_{30}</span> is the fractional moisture content of the top
30cm of soil.</p>
</div>
<div class="section" id="patch-fuel-moisture">
<h4><span class="section-number">2.29.16.3.3. </span>Patch Fuel Moisture<a class="headerlink" href="#patch-fuel-moisture" title="Permalink to this headline">¶</a></h4>
<p>The total patch fuel moisture is based on the weighted average of the
different moisture contents associated with each of the different live
grass and dead fuel types available (except 1000-h fuels).</p>
<div class="math">
<p><span class="math">F_{m,patch}=\sum_{fc=1}^{fc=4}  \frac{F_{fc}}{F_{tot}}\emph{moist}_{df,fc}+\frac{b_{l,grass}}{F_{tot}}\emph{moist}_{lg}</span></p>
</div></div>
<div class="section" id="effective-fuel-moisture-content">
<h4><span class="section-number">2.29.16.3.4. </span>Effective Fuel Moisture Content<a class="headerlink" href="#effective-fuel-moisture-content" title="Permalink to this headline">¶</a></h4>
<p>Effective Fuel Moisture Content is used for calculations of fuel
consumed, and is a function of the ratio of dead fuel moisture content
<span class="math">M_{df,fc}</span> and the moisture of extinction factor,
<span class="math">m_{ef,fc}</span></p>
<div class="math">
<p><span class="math">E_{moist,fc}=\frac{\emph{moist}_{fc}}{m_{ef,fc}}</span></p>
</div><p>where the <span class="math">m_{ef}</span> is a function of surface-area to volume ratio.</p>
<div class="math">
<p><span class="math">m_{ef,fc}=0.524-0.066\log_{10}{\sigma_{fc}}</span></p>
</div></div>
<div class="section" id="patch-fuel-moisture-of-extinction">
<h4><span class="section-number">2.29.16.3.5. </span>Patch Fuel Moisture of Extinction<a class="headerlink" href="#patch-fuel-moisture-of-extinction" title="Permalink to this headline">¶</a></h4>
<p>The patch ‘moisture of extinction’ factor (<span class="math">F_{mef}</span>) is the
weighted average of the <span class="math">m_{ef}</span> of the different fuel classes</p>
<div class="math">
<p><span class="math">F_{mef,patch}=\sum_{fc=1}^{fc=5}  \frac{F_{fc}}{F_{tot}}m_{ef,fc}+\frac{b_{l,grass}}{F_{tot}}m_{ef,grass}</span></p>
</div></div>
<div class="section" id="patch-fuel-bulk-density">
<h4><span class="section-number">2.29.16.3.6. </span>Patch Fuel Bulk Density<a class="headerlink" href="#patch-fuel-bulk-density" title="Permalink to this headline">¶</a></h4>
<p>The patch fuel bulk density is the weighted average of the bulk density
of the different fuel classes (except 1000-h fuels).</p>
<div class="math">
<p><span class="math">F_{bd,patch}=\sum_{fc=1}^{fc=4} \frac{F_{fc}}{F_{tot}}\beta_{fuel,fc}+\frac{b_{l,grass}}{F_{tot}}\beta_{fuel,lgrass}</span></p>
</div><p>where <span class="math">\beta_{fuel,fc}</span> is the bulk density of each fuel size
class (kG m<span class="math">^{-3}</span>)</p>
</div>
<div class="section" id="patch-fuel-surface-area-to-volume">
<h4><span class="section-number">2.29.16.3.7. </span>Patch Fuel Surface Area to Volume<a class="headerlink" href="#patch-fuel-surface-area-to-volume" title="Permalink to this headline">¶</a></h4>
<p>The patch surface area to volume ratio (<span class="math">F_{\sigma}</span>) is the
weighted average of the surface area to volume ratios
(<span class="math">\sigma_{fuel}</span>) of the different fuel classes (except 1000-h
fuels).</p>
<div class="math">
<p><span class="math">F_{\sigma}=\sum_{fc=1}^{fc=4}  \frac{F_{fc}}{F_{tot}}\sigma_{fuel,fc}+\frac{b_{l,grass}}{F_{tot}}\sigma_{fuel,grass}</span></p>
</div></div>
</div>
<div class="section" id="forward-rate-of-spread">
<h3><span class="section-number">2.29.16.4. </span>Forward rate of spread<a class="headerlink" href="#forward-rate-of-spread" title="Permalink to this headline">¶</a></h3>
<p>For each patch and each day, we calculate the rate of forward spread of
the fire <em>ros</em><span class="math">_{f}</span> (nominally in the direction of the wind).</p>
<div class="math">
<p><span class="math">\emph{ros}_{f}=\frac{i_{r}x_{i}(1+\phi_{w})}{F_{bd,patch}e_{ps}q_{ig}}</span></p>
</div><p><span class="math">e_{ps}</span> is the effective heating number
(<span class="math">e^{\frac{-4.528}{F_{\sigma,patch}}}</span>). <span class="math">q_{ig}</span> is the
heat of pre-ignition (<span class="math">581+2594F_{m}</span>). <span class="math">x_{i}</span> is the
propagating flux calculated as (see <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>
Appendix A).</p>
<div class="math">
<p><span class="math">x_{i}= \frac{e^{0.792+3.7597F_{\sigma,patch}^{0.5}(\frac{F_{bd,patch}}{p_{d}}+0.1)}}{192+7.9095F_{\sigma,patch}}</span></p>
</div><p><span class="math">\phi_{w}</span> is the influence of windspeed on rate of spread.</p>
<div class="math">
<p><span class="math">\phi_{w}=cb_{w}^{b}.\beta^{-e}</span></p>
</div><p>Where <span class="math">b</span>, <span class="math">c</span> and <span class="math">e</span> are all functions of
surface-area-volume ratio <span class="math">F_{\sigma,patch}</span>:
<span class="math">b=0.15988F_{\sigma,patch}^{0.54}</span>,
<span class="math">c=7.47e^{-0.8711F_{\sigma,patch}^{0.55}}</span>,
<span class="math">e=0.715e^{-0.01094F_{\sigma,patch}}</span>. <span class="math">b_{w}=196.86W</span> where
<span class="math">W</span> is the the windspeed in ms<span class="math">^{-1}</span>, and
<span class="math">\beta=\frac{F_{bd}/p_{d}}{0.200395F_{\sigma,patch}^{-0.8189}}</span>
where <span class="math">p_{d}</span> is the particle density (513).</p>
<p><span class="math">i_{r}</span> is the reaction intensity, calculated using the following
set of expressions (from <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a> Appendix A).:</p>
<div class="math">
<p><span class="math">\begin{aligned}
i_{r}&amp;=&amp;\Gamma_{opt}F_{tot}Hd_{moist}d_{miner}\\
d_{moist}&amp;=&amp;\textrm{max}\Big(0.0,(1-2.59m_{w}+5.11m_{w}^{2}-3.52m_{w}^{3})\Big)\\
m_{w}&amp;=&amp;\frac{F_{m,patch}}{F_{mef,patch}}\\
\Gamma _{opt}&amp;=&amp;\Gamma_{max}\beta^{a}\lambda\\
\Gamma _{max}&amp;=&amp;\frac{1}{0.0591+2.926F_{\sigma,patch}^{-1.5}}\\
\lambda&amp;=&amp;e^{a(1-\beta)}\\
a&amp;=&amp;8.9033F_{\sigma,patch}^{-0.7913}\end{aligned}</span></p>
</div><p><span class="math">\Gamma_{opt}</span> is the residence time of the fire, and
<span class="math">d_{miner}</span> is the mineral damping coefficient
(=0.174:math:<cite>S_e^{-0.19}</cite> , where <span class="math">S_e</span> is 0.01 and so =
<span class="math">d_{miner}</span> 0.41739).</p>
</div>
<div class="section" id="fuel-consumption">
<h3><span class="section-number">2.29.16.5. </span>Fuel Consumption<a class="headerlink" href="#fuel-consumption" title="Permalink to this headline">¶</a></h3>
<p>The fuel consumption (fraction of biomass pools) of each dead biomass
pool in the area affected by fire on a given day (<span class="math">f_{c,dead,fc}</span>)
is a function of effective fuel moisture <span class="math">E_{moist,fc}</span> and size
class <em>fc</em> (Eqn B1, B4 and B5, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>). The
fraction of each fuel class that is consumed decreases as its moisture
content relative to its moisture of extinction (<span class="math">E_{moist,fc}</span>)
increases.</p>
<div class="math">
<p><span class="math">f_{cdead,fc}=\textrm{max}\left(0,\textrm{min}(1,m_{int,mc,fc}-m_{slope,mc,fc}E_{moist,fc})\Big)\right.</span></p>
</div><p><span class="math">m_{int}</span> and <span class="math">m_{slope}</span> are parameters, the value of which
is modulated by both size class <span class="math">fc</span> and by the effective fuel
moisture class <span class="math">mc</span>, defined by <span class="math">E_{moist,fc}</span>.
<span class="math">m_{int}</span> and <span class="math">m_{slope}</span> are defined for low-, mid-, and
high-moisture conditions, the boundaries of which are also functions of
the litter size class following <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#peterson1986"><span class="std std-ref">Peterson and Ryan 1986</span></a> (page
802). The fuel burned, <span class="math">f_{cground,fc}</span> (Kg m<span class="math">^{-2}</span>
day<span class="math">^{-1}</span>) iscalculated from <span class="math">f_{cdead,fc}</span> for each fuel
class:</p>
<div class="math">
<p><span class="math">f_{cground,fc}=f_{c,dead,fc}(1-M_{f})\frac{F_{fc}}{0.45}</span></p>
</div><p>Where 0.45 converts from carbon to biomass. The total fuel consumption,
<span class="math">f_{ctot,patch}</span>(Kg m<span class="math">^{-2}</span>), used to calculate fire
intensity, is then given by</p>
<div class="math">
<p><span class="math">f_{ctot,patch}=\sum_{fc=1}^{fc=4} f_{c,ground,fc} +  f_{c,ground,lgrass}</span></p>
</div><p>There is no contribution from the 1000 hour fuels to the patch-level
<span class="math">f_{ctot,patch}</span> used in the fire intensity calculation.</p>
</div>
<div class="section" id="fire-intensity">
<h3><span class="section-number">2.29.16.6. </span>Fire Intensity<a class="headerlink" href="#fire-intensity" title="Permalink to this headline">¶</a></h3>
<p>Fire intensity at the front of the burning area (<span class="math">I_{surface}</span>, kW
m<span class="math">^{-2}</span>) is a function of the total fuel consumed
(<span class="math">f_{ctot,patch}</span>) and the rate of spread at the front of the
fire, <span class="math">\mathit{ros}_{f}</span> (m min<span class="math">^{-1}</span>) (Eqn 15
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>)</p>
<div class="math">
<p><span class="math">I_{surface}=\frac{0.001}{60}f_{energy} f_{ctot,patch}\mathit{ros}_{f}</span></p>
</div><p>where <span class="math">f_{energy}</span> is the energy content of fuel (Kj/Kg - the
same, 18000 Kj/Kg for all fuel classes). Fire intensity is used to define whether an
ignition is successful. If the fire intensity is greater than 50Kw/m
then the ignition is successful.</p>
</div>
<div class="section" id="fire-duration">
<h3><span class="section-number">2.29.16.7. </span>Fire Duration<a class="headerlink" href="#fire-duration" title="Permalink to this headline">¶</a></h3>
<p>Fire duration is a function of the fire danger index with a maximum
length of <span class="math">F_{dur,max}</span> (240 minutes in
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a> Eqn 14, derived from Canadian Forest
Fire Behaviour Predictions Systems)</p>
<div class="math">
<p><span class="math">D_{f}=\textrm{min}\Big(F_{dur,max},\frac{F_{dur,max}}{1+F_{dur,max}e^{-11.06fdi}}\Big)</span></p>
</div></div>
<div class="section" id="fire-danger-index">
<h3><span class="section-number">2.29.16.8. </span>Fire Danger Index<a class="headerlink" href="#fire-danger-index" title="Permalink to this headline">¶</a></h3>
<p>Fire danger index (<em>fdi</em>) is a representation of the effect of
meteorological conditions on the likelihood of a fire. It is calculated
for each gridcell as a function of the Nesterov Index .
<span class="math">\emph{fdi}</span> is calculated from <span class="math">NI</span> as</p>
<div class="math">
<p><span class="math">\emph{fdi}=1-e^{\alpha N_{I}}</span></p>
</div><p>where <span class="math">\alpha</span> = 0.00037 following
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#venevsky2002"><span class="std std-ref">Venevsky et al. 2002</span></a>.</p>
</div>
<div class="section" id="area-burned">
<h3><span class="section-number">2.29.16.9. </span>Area Burned<a class="headerlink" href="#area-burned" title="Permalink to this headline">¶</a></h3>
<p>Total area burnt is assumed to be in the shape of an ellipse, whose
major axis <span class="math">f_{length}</span> (m) is determined by the forward and
backward rates of spread (<span class="math">ros_{f}</span> and <span class="math">ros_{b}</span>
respectively).</p>
<div class="math">
<p><span class="math">f_{length}=F_{d}(ros_{b}+ros_{f})</span></p>
</div><p><span class="math">ros_{b}</span> is a function of <span class="math">ros_{f}</span> and windspeed (Eqn 10
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>)</p>
<div class="math">
<p><span class="math">ros_{b}=ros_{f}e^{-0.012W}</span></p>
</div><p>The minor axis to major axis ratio <span class="math">l_{b}</span> of the ellipse is
determined by the windspeed. If the windspeed (<span class="math">W</span>) is less than
16.67 ms<span class="math">^{-1}</span> then <span class="math">l_{b}=1</span>. Otherwise (Eqn 12 and 13,
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>)</p>
<div class="math">
<p><span class="math">l_{b}=\textrm{min}\Big(8,f_{tree}(1.0+8.729(1.0-e^{-0.108W})^{2.155})+(f_{grass}(1.1+3.6W^{0.0464}))\Big)</span></p>
</div><p><span class="math">f_{grass}</span> and <span class="math">f_{tree}</span> are the fractions of the patch
surface covered by grass and trees respectively.</p>
<p>The total area burned (<span class="math">A_{burn}</span> in m<span class="math">^{2}</span>) is therefore
(Eqn 11, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>)</p>
<div class="math">
<p><span class="math">A_{burn}=\frac{n_{f}\frac{3.1416}{4l_{b}}(f_{length}^{2}))}{10000}</span></p>
</div><p>where <span class="math">n_{f}</span> is the number of fires.</p>
</div>
<div class="section" id="crown-damage">
<h3><span class="section-number">2.29.16.10. </span>Crown Damage<a class="headerlink" href="#crown-damage" title="Permalink to this headline">¶</a></h3>
<p><span class="math">c_{k}</span> is the fraction of the crown which is consumed by the
fire. This is calculated from scorch height <span class="math">H_{s}</span>, tree height
<span class="math">h</span> and the crown fraction parameter <span class="math">F_{crown}</span> (Eqn 17
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>):</p>
<div class="math">
<p><span class="math">c_{k} = \left\{ \begin{array}{ll}
0 &amp; \textrm{for $H_{s}&lt;(h-hF_{crown})$}\\
1-\frac{h-H_{s}}{h-F_{crown}}&amp; \textrm{for $h&gt;H_{s}&gt;(h-hF_{crown})$}\\
1 &amp; \textrm{for $H_{s}&gt;h$ }
\end{array} \right.</span></p>
</div><p>The scorch height <span class="math">H_{s}</span> (m) is a function of the fire intensity,
following <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#byram1959"><span class="std std-ref">Byram, 1959</span></a>, and is proportional to a plant
functional type specific parameter <span class="math">\alpha_{s,ft}</span> (Eqn 16
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>):</p>
<div class="math">
<p><span class="math">H_{s}=\sum_{FT=1}^{NPFT}{\alpha_{s,p}\cdot f_{biomass,ft}} I_{surface}^{0.667}</span></p>
</div><p>where <span class="math">f_{biomass,ft}</span> is the fraction of the above-ground
biomass in each plant functional type.</p>
</div>
<div class="section" id="cambial-damage-and-kill">
<h3><span class="section-number">2.29.16.11. </span>Cambial Damage and Kill<a class="headerlink" href="#cambial-damage-and-kill" title="Permalink to this headline">¶</a></h3>
<p>The cambial kill is a function of the fuel consumed <span class="math">f_{c,tot}</span>,
the bark thickness <span class="math">t_{b}</span>, and <span class="math">\tau_{l}</span>, the duration of
cambial heating (minutes) (Eqn 8, <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#peterson1986"><span class="std std-ref">Peterson and Ryan 1986</span></a>):</p>
<div class="math">
<p><span class="math">\tau_{l}=\sum_{fc=1}^{fc=5}39.4F_{p,c}\frac{10000}{0.45}(1-(1-f_{c,dead,fc})^{0.5})</span></p>
</div><p>Bark thickness is a linear function of tree diameter <span class="math">dbh_{coh}</span>,
defined by PFT-specific parameters <span class="math">\beta_{1,bt}</span> and
<span class="math">\beta_{2,bt}</span> (Eqn 21 <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>):</p>
<div class="math">
<p><span class="math">t_{b,coh}=\beta_{1,bt,ft}+\beta_{2,bt,ft}dbh_{coh}</span></p>
</div><p>The critical time for cambial kill, <span class="math">\tau_{c}</span> (minutes) is given
as (Eqn 20 <a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>):</p>
<div class="math">
<p><span class="math">\tau_{c}=2.9t_{b}^{2}</span></p>
</div><p>The mortality rate caused by cambial heating <span class="math">\tau_{pm}</span> of trees
within the area affected by fire is a function of the ratio between
<span class="math">\tau_{l}</span> and <span class="math">\tau_{c}</span> (Eqn 19,
<a class="reference internal" href="../References/CLM50_Tech_Note_References.html#thonickeetal2010"><span class="std std-ref">Thonicke et al. 2010</span></a>):</p>
<div class="math">
<p><span class="math">\tau_{pm} = \left\{ \begin{array}{ll}
1.0 &amp; \textrm{for } \tau_{1}/\tau_{c}\geq \textrm{2.0}\\
0.563(\tau_{l}/\tau_{c}))-0.125 &amp; \textrm{for } \textrm{2.0} &gt; \tau_{1}/\tau_{c}\ge \textrm{0.22}\\
0.0 &amp; \textrm{for } \tau_{1}/\tau_{c}&lt; \textrm{0.22}\\
\end{array} \right.</span></p>
</div><table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter
Symbol</p></th>
<th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>indexed by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math">\beta_{1
,bt}</span></p></td>
<td><p>Intercept of
bark thickness
function</p></td>
<td><p>mm</p></td>
<td><p><em>FT</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">\beta_{2
,bt}</span></p></td>
<td><p>Slope of bark
thickness
function</p></td>
<td><p>mm
cm<span class="math">^{-1
}</span></p></td>
<td><p><em>FT</em></p></td>
</tr>
<tr class="row-even"><td><p><span class="math">F_{crown
}</span></p></td>
<td><p>Ratio of crown
height to total
height</p></td>
<td><p>none</p></td>
<td><p><em>FT</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">\alpha_{
fmc}</span></p></td>
<td><p>Fuel moisture
parameter</p></td>
<td><p><span class="math">{^o}</span>C
<span class="math">^{-2}</span></p></td>
<td><p><em>fc</em></p></td>
</tr>
<tr class="row-even"><td><p><span class="math">\beta_{f
uel}</span></p></td>
<td><p>Fuel Bulk
Density</p></td>
<td><p>kG
m<span class="math">^{-3}</span></p></td>
<td><p><em>fc</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">\sigma_{
fuel,fc}</span></p></td>
<td><p>Surface area to
volume ratio</p></td>
<td><p>cm
<span class="math">^{-1}</span></p></td>
<td><p><em>fc</em></p></td>
</tr>
<tr class="row-even"><td><p><span class="math">m_{int}</span></p></td>
<td><p>Intercept of
fuel burned</p></td>
<td><p>none</p></td>
<td><p><span class="math">fc</span>,
moisture class</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math">m_{slope
}</span></p></td>
<td><p>Slope of fuel
burned</p></td>
<td><p>none</p></td>
<td><p><span class="math">fc</span>,
moisture class</p></td>
</tr>
<tr class="row-even"><td><p><span class="math">M_f</span></p></td>
<td><p>Fuel Mineral
Fraction</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">F_{dur,m
ax}</span></p></td>
<td><p>Maximum
Duration of
Fire</p></td>
<td><p>Minutes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math">f_{energ
y}</span></p></td>
<td><p>Energy content
of fuel</p></td>
<td><p>kJ/kG</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math">\alpha_{
s}</span></p></td>
<td><p>Flame height
parameter</p></td>
<td></td>
<td><p><em>FT</em></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../BVOCs/CLM50_Tech_Note_BVOCs.html" class="btn btn-neutral float-right" title="2.30. Biogenic Volatile Organic Compounds (BVOCs)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../Transient_Landcover/CLM50_Tech_Note_Transient_Landcover.html" class="btn btn-neutral" title="2.27. Transient Land Use and Land Cover Change" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, UCAR.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
     
<script>var version_json_loc = "../../../../versions.json";</script>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/pop_ver.js"></script>
    

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>