

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.5.5. Spinup of CLM5.0-BGC-Crop &mdash; ctsm release-clm5.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="ctsm release-clm5.0 documentation" href="../../index.html"/>
        <link rel="up" title="1.5. Running Special Cases" href="index.html"/>
        <link rel="next" title="1.5.6. Running with MOAR data" href="Running-with-MOAR-data-as-atmospheric-forcing-to-spinup-the-model.html"/>
        <link rel="prev" title="1.5.4. Spinning up the Satellite Phenology Model" href="Spinning-up-the-Satellite-Phenology-Model-CLMSP-spinup.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> ctsm
          

          
          </a>

          
            
            
              <div class="version">
                
                  <div class="version-dropdown">
                    <select class="version-list" id="version-list">
                      <option value=''>CLM5.0</option>
                      
                        
                      
                        
                          <option value="">[placeholder]</option>
                        
                      
                    </select>
                  </div>
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">1. CLM5.0 User’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview/index.html">1.1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setting-up-and-running-a-case/index.html">1.2. Setting Up and Running a Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using-clm-tools/index.html">1.3. Using CLM tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adding-new-resolutions/index.html">1.4. Adding New Resolutions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">1.5. Running Special Cases</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="what-is-a-special-case.html">1.5.1. What is a special case?</a></li>
<li class="toctree-l3"><a class="reference internal" href="running-the-prognostic-crop-model.html">1.5.2. Running the prognostic crop model</a></li>
<li class="toctree-l3"><a class="reference internal" href="running-with-irrigation.html">1.5.3. Running with irrigation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Spinning-up-the-Satellite-Phenology-Model-CLMSP-spinup.html">1.5.4. Spinning up the Satellite Phenology Model</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">1.5.5. Spinup of CLM5.0-BGC-Crop</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-ad-spinup-simulation-for-version-bgc">1.5.5.1. Example:: AD_SPINUP Simulation for CLM5.0-BGC</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-final-clmbgc-spinup-simulation-for-version-bgc">1.5.5.2. Example: Final CLMBGC Spinup Simulation for CLM5.0-BGC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Running-with-MOAR-data-as-atmospheric-forcing-to-spinup-the-model.html">1.5.6. Running with MOAR data</a></li>
<li class="toctree-l3"><a class="reference internal" href="Running-with-your-own-previous-simulation-as-atmospheric-forcing-to-spinup-the-model.html">1.5.7. Running with atmospheric forcing from a previous simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Running-stand-alone-CLM-with-transient-historical-CO2-concentration.html">1.5.8. Running with historical CO2 forcing</a></li>
<li class="toctree-l3"><a class="reference internal" href="Running-with-anomaly-forcing.html">1.5.9. Running with anomaly forcing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../running-single-points/index.html">1.6. Running Single Point Regional Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../running-PTCLM/index.html">1.7. Running PTCLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trouble-shooting/index.html">1.8. Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/index.html">1.9. Testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tech_note/index.html">2. CLM Technical Note</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ctsm</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html"><span class="section-number">1. </span>CLM5.0 User’s Guide</a> &raquo;</li>
        
          <li><a href="index.html"><span class="section-number">1.5. </span>Running Special Cases</a> &raquo;</li>
        
      <li><span class="section-number">1.5.5. </span>Spinup of CLM5.0-BGC-Crop</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/users_guide/running-special-cases/Spinning-up-the-biogeochemistry-BGC-spinup.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="spinup-of-clm5-0-bgc-crop">
<span id="spinning-up-clm50-bgc"></span><h1><span class="section-number">1.5.5. </span>Spinup of CLM5.0-BGC-Crop<a class="headerlink" href="#spinup-of-clm5-0-bgc-crop" title="Permalink to this headline">¶</a></h1>
<p>To get the CLM5.0-BGC model to a steady state, you first run it from arbitrary initial conditions using the “accelerated decomposition spinup” (-bgc_spinup on in CLM <strong>configure</strong>, see example below) mode for about 200 simulation years. <a class="reference internal" href="#figure-bgc-ad-spinup-plot-for-1850-gswp3"><span class="std std-numref">Figure 1.5.3</span></a> shows spinup behavior for an 1850
BGC accelerated decomposition (AD) case using GSWP3 atmospheric forcing. Generally, the criteria that less than 3% of the land surface be in
total ecosystem carbon disequilibrium takes the longest to satisfy due to slow soil carbon (TOTSOMC) turnover times in the Arctic.</p>
<div class="figure align-default" id="id1">
<span id="figure-bgc-ad-spinup-plot-for-1850-gswp3"></span><img alt="../../_images/image32.png" src="../../_images/image32.png" />
<p class="caption"><span class="caption-number">Figure 1.5.3 </span><span class="caption-text">BGC AD spinup plot for a year 1850 case with GSWP3 atmospheric forcing. Variables examined are TOTECOSYSC (total ecosystem carbon), TOTSOMC (total soil organic matter carbon), TOTVEGC (total vegetation carbon), TLAI (total leaf area index), GPP (gross primary production) and TWS (total water storage). Generated using …/tools/contrib/SpinupStability.ncl.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>After this you branch from this mode in the “final spinup” (-bgc_spinup off in CLM <strong>configure</strong>, see example below), and run for several hundred simulation years.
<a class="reference internal" href="#figure-bgc-pad-spinup-plot-for-1850-gswp3"><span class="std std-numref">Figure 1.5.4</span></a> shows spinup behavior for an 1850
BGC post accelerated decomposition (pAD) case using GSWP3 atmospheric forcing. As before, the criteria that less than 3% of the land surface be in
total ecosystem carbon disequilibrium takes the longest to satisfy. It can be difficult to meet this strict criteria in less than 1000 years and users may want to relax this
criteria depending on their application.</p>
<div class="figure align-default" id="id2">
<span id="figure-bgc-pad-spinup-plot-for-1850-gswp3"></span><img alt="../../_images/image4.png" src="../../_images/image4.png" />
<p class="caption"><span class="caption-number">Figure 1.5.4 </span><span class="caption-text">BGC pAD spinup plot for a year 1850 case with GSWP3 atmospheric forcing and initialization from the end of the BGC AD spinup case. Variables examined are TOTECOSYSC (total ecosystem carbon), TOTSOMC (total soil organic matter carbon), TOTVEGC (total vegetation carbon), TLAI (total leaf area index), GPP (gross primary production) and TWS (total water storage). Generated using …/tools/contrib/SpinupStability.ncl.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>You can also start from a default initial file that is setup as part of the selected compset.  <a class="reference internal" href="#figure-bgc-initialized-spinup-plot-for-1850"><span class="std std-numref">Figure 1.5.5</span></a> shows
spinup behavior for an 1850 pAD BGC case that loops over one year of coupler history output for atmospheric forcing (generated from the fully coupled model),
initialized with a BGC initial file generated from a GSWP3 atmospheric forcing case. Note that it takes about 10 years for variables
such as TLAI (total leaf area index), GPP (gross primary production), and TWS (total water storage) to reach a specified equilibrium state (denoted by the dotted lines) due to the different atmospheric forcing.</p>
<div class="figure align-default" id="id3">
<span id="figure-bgc-initialized-spinup-plot-for-1850"></span><img alt="../../_images/image5.png" src="../../_images/image5.png" />
<p class="caption"><span class="caption-number">Figure 1.5.5 </span><span class="caption-text">BGC initialized spinup plot for year 1850. Variables examined are TOTECOSYSC (total ecosystem carbon), TOTSOMC (total soil organic matter carbon), TOTVEGC (total vegetation carbon), TLAI (total leaf area index), GPP (gross primary production) and TWS (total water storage). Generated using …/tools/contrib/SpinupStability.ncl.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p><a class="reference internal" href="#figure-bgc-initialized-spinup-plot-for-2000-co2"><span class="std std-numref">Figure 1.5.6</span></a> shows spinup behavior for the same case but also changes CO2 to present-day conditions (379ppmv).
Again, it takes about 10 years to reach equilibrium for TLAI, GPP, and TWS.</p>
<div class="figure align-default" id="id4">
<span id="figure-bgc-initialized-spinup-plot-for-2000-co2"></span><img alt="../../_images/image6.png" src="../../_images/image6.png" />
<p class="caption"><span class="caption-number">Figure 1.5.6 </span><span class="caption-text">BGC initialized spinup plot for year 2000 CO2.  Variables examined are TOTECOSYSC (total ecosystem carbon), TOTSOMC (total soil organic matter carbon), TOTVEGC (total vegetation carbon), TLAI (total leaf area index), GPP (gross primary production) and TWS (total water storage). Generated using …/tools/contrib/SpinupStability.ncl.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p>If you use the default initial file and you signficantly change model behavior or atmospheric forcing, and you are concerned about the carbon
equilibrium (e.g., TOTECOSYSC, TOTSOMC, TOTVEGC), particularly at high latitudes, then we recommend you put the model back into AD mode to
reach a new equilibrium. In this configuration, this will also automatically reseed “dead” plant functional types in the initial file with a
bit of leaf carbon to give those plant functional types another chance to grow under the new atmospheric forcing or model conditions.</p>
<dl class="simple">
<dt><strong>1. 50_AD_SPINUP</strong></dt><dd><p>For the first step of running 200+ years in “-bgc_spinup on” mode, you will setup a case, and then edit the values in env_build.xml and env_run.xml so that the right configuration is turned on and the simulation is setup to run for the required length of simulation time. So do the following:</p>
</dd>
</dl>
<div class="section" id="example-ad-spinup-simulation-for-version-bgc">
<h2><span class="section-number">1.5.5.1. </span>Example:: AD_SPINUP Simulation for CLM5.0-BGC<a class="headerlink" href="#example-ad-spinup-simulation-for-version-bgc" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">cd</span> <span class="n">scripts</span>
<span class="o">&gt;</span> <span class="o">./</span><span class="n">create_newcase</span> <span class="o">-</span><span class="n">case</span> <span class="n">BGC_spinup</span> <span class="o">-</span><span class="n">res</span> <span class="n">f19_g17_gl4</span> <span class="o">-</span><span class="n">compset</span> <span class="n">I1850Clm50BgcCropCru</span>
<span class="o">&gt;</span> <span class="n">cd</span> <span class="n">BGC_spinup</span>
<span class="c1"># Change accelerated spinup mode</span>
<span class="o">&gt;</span> <span class="o">./</span><span class="n">xmlchange</span> <span class="n">CLM_ACCELERATED_SPINUP</span><span class="o">=</span><span class="s2">&quot;on&quot;</span>
<span class="c1"># Now setup</span>
<span class="o">&gt;</span> <span class="o">./</span><span class="n">case</span><span class="o">.</span><span class="n">setup</span> <span class="o">-</span><span class="n">case</span>
<span class="c1"># Now build</span>
<span class="o">&gt;</span> <span class="o">./</span><span class="n">case</span><span class="o">.</span><span class="n">build</span>
<span class="c1"># The following sets RESUBMIT to 3 times in env_run.xml (you could also use an editor)</span>
<span class="c1"># The following sets STOP_DATE,STOP_N and STOP_OPTION to Jan/1/0201, 20, &quot;nyears&quot; in env_run.xml (you could also use an       editor)</span>
<span class="o">&gt;</span> <span class="o">./</span><span class="n">xmlchange</span> <span class="n">RESUBMIT</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">STOP_N</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">STOP_OPTION</span><span class="o">=</span><span class="n">nyears</span><span class="p">,</span><span class="n">STOP_DATE</span><span class="o">=</span><span class="mi">02010101</span>
<span class="c1"># Now run normally</span>
<span class="o">&gt;</span> <span class="o">./</span><span class="n">case</span><span class="o">.</span><span class="n">submit</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This same procedure works for CLM5.0-CN as well.</p>
</div>
<p>Afterwards save the last restart file from this simulation to use in the next step.</p>
<dl class="simple">
<dt><strong>2. Final spinup for |version|-BGC</strong></dt><dd><p>Next save the last restart file from this step and use it as the “finidat” file to use for one more spinup for at least 400+ years in normal mode. So do the following:</p>
</dd>
</dl>
</div>
<div class="section" id="example-final-clmbgc-spinup-simulation-for-version-bgc">
<h2><span class="section-number">1.5.5.2. </span>Example: Final CLMBGC Spinup Simulation for CLM5.0-BGC<a class="headerlink" href="#example-final-clmbgc-spinup-simulation-for-version-bgc" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; cd scripts
&gt; ./create_newcase -case BGC_finalspinup -res f19_g17_gl4 -compset I1850Clm50BgcCropCru
&gt; cd BGC_finalspinup
# Now, Copy the last CLM restart file from the earlier case into your run directory
&gt; cp /ptmp/$LOGIN/archive/BGC_spinup/rest/BGC_spinup.clm*.r*.0201-01-01-00000.nc \
/glade/scratch/$LOGIN/CN_finalspinup
# Set the runtype to startup
&gt; ./xmlchange RUN_TYPE=startup
# And copy the rpointer files for datm and drv from the earlier case
&gt; cp /glade/scratch/$LOGIN/archive/BGC_spinup/rest/rpointer.atm /ptmp/$LOGIN/CN_finalspinup
&gt; cp /glade/scratch/$LOGIN/archive/BGC_spinup/rest/rpointer.drv /ptmp/$LOGIN/CN_finalspinup
# Set the finidat file to the last restart file saved in previous step
&gt; echo &#39; finidat = &quot;BGC_spinup.clm2.r.0201-01-01-00000.nc&quot;&#39; &gt; user_nl_clm
# Now setup
&gt; ./case.setup
&gt; Now build
&gt; ./case.build
# The following sets RESUBMIT to 7 times in env_run.xml (you could also use an editor)
# The following sets STOP_N and STOP_OPTION to 50 and &quot;nyears&quot; in env_run.xml (you could also use an editor)
&gt; ./xmlchange RESUBMIT=7,STOP_OPTION=nyears,STOP_N=50
&gt; Now run as normal
&gt; ./case.submit
</pre></div>
</div>
<p>To assess if the model is spunup, plot trends for CLMBGC variables of interest using …/tools/contrib/SpinupStability.ncl. If you don’t meet the equilibrium criteria, you may need to run the simulation longer. Finally save the restart file from the end of this simulation to use as an “finidat” file for future simulations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This same final spinup procedure works for CLM5.0-CN as well.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Running-with-MOAR-data-as-atmospheric-forcing-to-spinup-the-model.html" class="btn btn-neutral float-right" title="1.5.6. Running with MOAR data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Spinning-up-the-Satellite-Phenology-Model-CLMSP-spinup.html" class="btn btn-neutral" title="1.5.4. Spinning up the Satellite Phenology Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, UCAR.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
     
<script>var version_json_loc = "../../../../versions.json";</script>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/pop_ver.js"></script>
    

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>